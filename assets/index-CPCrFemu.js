import{S as Fs}from"./index-BOvYCoiN.js";import{I as sa,M as gi,P as Ws,N as la,U as ca,h as Js,g as Us,a as hn,e as Bn,b as Ot,d as Lt,s as Hs}from"./main-BEehq-qM.js";import{c as Bs}from"./canonicalize-Bd8h0v92.js";var da={};/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */const Vi=sa,Vs=gi,Gs=Ws,Gi=la;var ua=class{constructor({createMessageDigest:t=()=>new Vs("sha256"),canonicalIdMap:n=new Map,maxDeepIterations:r=1/0}={}){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new Vi("_:c14n",n),this.createMessageDigest=t,this.maxDeepIterations=r,this.quads=null,this.deepIterations=null}async main(t){this.deepIterations=new Map,this.quads=t;for(const f of t)this._addBlankNodeQuadInfo({quad:f,component:f.subject}),this._addBlankNodeQuadInfo({quad:f,component:f.object}),this._addBlankNodeQuadInfo({quad:f,component:f.graph});const n=new Map,r=[...this.blankNodeInfo.keys()];let o=0;for(const f of r)++o%100===0&&await this._yield(),await this._hashAndTrackBlankNode({id:f,hashToBlankNodes:n});const a=[...n.keys()].sort(),i=[];for(const f of a){const c=n.get(f);if(c.length>1){i.push(c);continue}const p=c[0];this.canonicalIssuer.getId(p)}for(const f of i){const c=[];for(const p of f){if(this.canonicalIssuer.hasId(p))continue;const g=new Vi("_:b");g.getId(p);const d=await this.hashNDegreeQuads(p,g);c.push(d)}c.sort(qs);for(const p of c){const g=p.issuer.getOldIds();for(const d of g)this.canonicalIssuer.getId(d)}}const l=[];for(const f of this.quads){const c=Gi.serializeQuadComponents(this._componentWithCanonicalId(f.subject),f.predicate,this._componentWithCanonicalId(f.object),this._componentWithCanonicalId(f.graph));l.push(c)}return l.sort(),l.join("")}async hashFirstDegreeQuads(t){const n=[],r=this.blankNodeInfo.get(t),o=r.quads;for(const i of o){const l={subject:null,predicate:i.predicate,object:null,graph:null};l.subject=this.modifyFirstDegreeComponent(t,i.subject,"subject"),l.object=this.modifyFirstDegreeComponent(t,i.object,"object"),l.graph=this.modifyFirstDegreeComponent(t,i.graph,"graph"),n.push(Gi.serializeQuad(l))}n.sort();const a=this.createMessageDigest();for(const i of n)a.update(i);return r.hash=await a.digest(),r.hash}async hashRelatedBlankNode(t,n,r,o){let a;this.canonicalIssuer.hasId(t)?a=this.canonicalIssuer.getId(t):r.hasId(t)?a=r.getId(t):a=this.blankNodeInfo.get(t).hash;const i=this.createMessageDigest();return i.update(o),o!=="g"&&i.update(this.getRelatedPredicate(n)),i.update(a),i.digest()}async hashNDegreeQuads(t,n){const r=this.deepIterations.get(t)||0;if(r>this.maxDeepIterations)throw new Error(`Maximum deep iterations (${this.maxDeepIterations}) exceeded.`);this.deepIterations.set(t,r+1);const o=this.createMessageDigest(),a=await this.createHashToRelated(t,n),i=[...a.keys()].sort();for(const l of i){o.update(l);let f="",c;const p=new Gs(a.get(l));let g=0;for(;p.hasNext();){const d=p.next();++g%3===0&&await this._yield();let s=n.clone(),u="";const y=[];let w=!1;for(const v of d)if(this.canonicalIssuer.hasId(v)?u+=this.canonicalIssuer.getId(v):(s.hasId(v)||y.push(v),u+=s.getId(v)),f.length!==0&&u>f){w=!0;break}if(!w){for(const v of y){const E=await this.hashNDegreeQuads(v,s);if(u+=s.getId(v),u+=`<${E.hash}>`,s=E.issuer,f.length!==0&&u>f){w=!0;break}}w||(f.length===0||u<f)&&(f=u,c=s)}}o.update(f),n=c}return{hash:await o.digest(),issuer:n}}modifyFirstDegreeComponent(t,n){return n.termType!=="BlankNode"?n:{termType:"BlankNode",value:n.value===t?"_:a":"_:z"}}getRelatedPredicate(t){return`<${t.predicate.value}>`}async createHashToRelated(t,n){const r=new Map,o=this.blankNodeInfo.get(t).quads;let a=0;for(const i of o)++a%100===0&&await this._yield(),await Promise.all([this._addRelatedBlankNodeHash({quad:i,component:i.subject,position:"s",id:t,issuer:n,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:i,component:i.object,position:"o",id:t,issuer:n,hashToRelated:r}),this._addRelatedBlankNodeHash({quad:i,component:i.graph,position:"g",id:t,issuer:n,hashToRelated:r})]);return r}async _hashAndTrackBlankNode({id:t,hashToBlankNodes:n}){const r=await this.hashFirstDegreeQuads(t),o=n.get(r);o?o.push(t):n.set(r,[t])}_addBlankNodeQuadInfo({quad:t,component:n}){if(n.termType!=="BlankNode")return;const r=n.value,o=this.blankNodeInfo.get(r);o?o.quads.add(t):this.blankNodeInfo.set(r,{quads:new Set([t]),hash:null})}async _addRelatedBlankNodeHash({quad:t,component:n,position:r,id:o,issuer:a,hashToRelated:i}){if(!(n.termType==="BlankNode"&&n.value!==o))return;const l=n.value,f=await this.hashRelatedBlankNode(l,t,a,r),c=i.get(f);c?c.push(l):i.set(f,[l])}_componentWithCanonicalId(t){return t.termType==="BlankNode"&&!t.value.startsWith(this.canonicalIssuer.prefix)?{termType:"BlankNode",value:this.canonicalIssuer.getId(t.value)}:t}async _yield(){return new Promise(t=>setImmediate(t))}};function qs(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}/*!
 * Copyright (c) 2016-2022 Digital Bazaar, Inc. All rights reserved.
 */const Cs=gi,Xs=ua;var zs=class extends Xs{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new Cs("sha1")}modifyFirstDegreeComponent(t,n,r){return n.termType!=="BlankNode"?n:r==="graph"?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:n.value===t?"_:a":"_:z"}}getRelatedPredicate(t){return t.predicate.value}async createHashToRelated(t,n){const r=new Map,o=this.blankNodeInfo.get(t).quads;let a=0;for(const i of o){let l,f;if(i.subject.termType==="BlankNode"&&i.subject.value!==t)f=i.subject.value,l="p";else if(i.object.termType==="BlankNode"&&i.object.value!==t)f=i.object.value,l="r";else continue;++a%100===0&&await this._yield();const c=await this.hashRelatedBlankNode(f,i,n,l),p=r.get(c);p?p.push(f):r.set(c,[f])}return r}};/*!
 * Copyright (c) 2016-2021 Digital Bazaar, Inc. All rights reserved.
 */const Ks=gi,Ys=ca;var Qs=class extends Ys{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new Ks("sha1")}modifyFirstDegreeComponent(t,n,r){return n.termType!=="BlankNode"?n:r==="graph"?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:n.value===t?"_:a":"_:z"}}getRelatedPredicate(t){return t.predicate.value}createHashToRelated(t,n){const r=new Map,o=this.blankNodeInfo.get(t).quads;for(const a of o){let i,l;if(a.subject.termType==="BlankNode"&&a.subject.value!==t)l=a.subject.value,i="p";else if(a.object.termType==="BlankNode"&&a.object.value!==t)l=a.object.value,i="r";else continue;const f=this.hashRelatedBlankNode(l,a,n,i),c=r.get(f);c?c.push(l):r.set(f,[l])}return r}};(function(e){const t=ua,n=zs,r=ca,o=Qs;let a;try{a=Js}catch{}function i(l){return Array.isArray(l)?l:e.NQuads.legacyDatasetToQuads(l)}e.NQuads=la,e.IdentifierIssuer=sa,e._rdfCanonizeNative=function(l){return l&&(a=l),a},e.canonize=async function(l,f){const c=i(l);if(f.useNative){if(!a)throw new Error("rdf-canonize-native not available");if(f.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "useNative".');return new Promise((p,g)=>a.canonize(c,f,(d,s)=>d?g(d):p(s)))}if(f.algorithm==="URDNA2015")return new t(f).main(c);if(f.algorithm==="URGNA2012"){if(f.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "URGNA2012".');return new n(f).main(c)}throw"algorithm"in f?new Error("Invalid RDF Dataset Canonicalization algorithm: "+f.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")},e._canonizeSync=function(l,f){const c=i(l);if(f.useNative){if(!a)throw new Error("rdf-canonize-native not available");if(f.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "useNative".');return a.canonizeSync(c,f)}if(f.algorithm==="URDNA2015")return new r(f).main(c);if(f.algorithm==="URGNA2012"){if(f.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "URGNA2012".');return new o(f).main(c)}throw"algorithm"in f?new Error("Invalid RDF Dataset Canonicalization algorithm: "+f.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")}})(da);var yi=da;const je={};var Ae=je;je.isArray=Array.isArray;je.isBoolean=e=>typeof e=="boolean"||Object.prototype.toString.call(e)==="[object Boolean]";je.isDouble=e=>je.isNumber(e)&&(String(e).indexOf(".")!==-1||Math.abs(e)>=1e21);je.isEmptyObject=e=>je.isObject(e)&&Object.keys(e).length===0;je.isNumber=e=>typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]";je.isNumeric=e=>!isNaN(parseFloat(e))&&isFinite(e);je.isObject=e=>Object.prototype.toString.call(e)==="[object Object]";je.isString=e=>typeof e=="string"||Object.prototype.toString.call(e)==="[object String]";je.isUndefined=e=>typeof e>"u";const xt=Ae,tt={};var it=tt;tt.isSubject=e=>xt.isObject(e)&&!("@value"in e||"@set"in e||"@list"in e)?Object.keys(e).length>1||!("@id"in e):!1;tt.isSubjectReference=e=>xt.isObject(e)&&Object.keys(e).length===1&&"@id"in e;tt.isValue=e=>xt.isObject(e)&&"@value"in e;tt.isList=e=>xt.isObject(e)&&"@list"in e;tt.isGraph=e=>xt.isObject(e)&&"@graph"in e&&Object.keys(e).filter(t=>t!=="@id"&&t!=="@index").length===1;tt.isSimpleGraph=e=>tt.isGraph(e)&&!("@id"in e);tt.isBlankNode=e=>{if(xt.isObject(e)){if("@id"in e){const t=e["@id"];return!xt.isString(t)||t.indexOf("_:")===0}return Object.keys(e).length===0||!("@value"in e||"@set"in e||"@list"in e)}return!1};var ke=class extends Error{constructor(t="An unspecified JSON-LD error occurred.",n="jsonld.Error",r={}){super(t),this.name=n,this.message=t,this.details=r}};const pn=it,pe=Ae,fa=yi.IdentifierIssuer,Zs=ke,el=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,tl=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,nl=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,rl=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,il=/^@[a-zA-Z]+$/,qi={headers:{accept:"application/ld+json, application/json"}},G={};var $e=G;G.IdentifierIssuer=fa;G.REGEX_BCP47=el;G.REGEX_KEYWORD=il;G.clone=function(e){if(e&&typeof e=="object"){let t;if(pe.isArray(e)){t=[];for(let n=0;n<e.length;++n)t[n]=G.clone(e[n])}else if(e instanceof Map){t=new Map;for(const[n,r]of e)t.set(n,G.clone(r))}else if(e instanceof Set){t=new Set;for(const n of e)t.add(G.clone(n))}else if(pe.isObject(e)){t={};for(const n in e)t[n]=G.clone(e[n])}else t=e.toString();return t}return e};G.asArray=function(e){return Array.isArray(e)?e:[e]};G.buildHeaders=(e={})=>{if(Object.keys(e).some(n=>n.toLowerCase()==="accept"))throw new RangeError('Accept header may not be specified; only "'+qi.headers.accept+'" is supported.');return Object.assign({Accept:qi.headers.accept},e)};G.parseLinkHeader=e=>{const t={},n=e.match(tl);for(let r=0;r<n.length;++r){let o=n[r].match(nl);if(!o)continue;const a={target:o[1]},i=o[2];for(;o=rl.exec(i);)a[o[1]]=o[2]===void 0?o[3]:o[2];const l=a.rel||"";Array.isArray(t[l])?t[l].push(a):t.hasOwnProperty(l)?t[l]=[t[l],a]:t[l]=a}return t};G.validateTypeValue=(e,t)=>{if(!pe.isString(e)&&!(pe.isArray(e)&&e.every(n=>pe.isString(n)))){if(t&&pe.isObject(e))switch(Object.keys(e).length){case 0:return;case 1:if("@default"in e&&G.asArray(e["@default"]).every(n=>pe.isString(n)))return}throw new Zs('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}};G.hasProperty=(e,t)=>{if(e.hasOwnProperty(t)){const n=e[t];return!pe.isArray(n)||n.length>0}return!1};G.hasValue=(e,t,n)=>{if(G.hasProperty(e,t)){let r=e[t];const o=pn.isList(r);if(pe.isArray(r)||o){o&&(r=r["@list"]);for(let a=0;a<r.length;++a)if(G.compareValues(n,r[a]))return!0}else if(!pe.isArray(n))return G.compareValues(n,r)}return!1};G.addValue=(e,t,n,r)=>{if(r=r||{},"propertyIsArray"in r||(r.propertyIsArray=!1),"valueIsArray"in r||(r.valueIsArray=!1),"allowDuplicate"in r||(r.allowDuplicate=!0),"prependValue"in r||(r.prependValue=!1),r.valueIsArray)e[t]=n;else if(pe.isArray(n)){n.length===0&&r.propertyIsArray&&!e.hasOwnProperty(t)&&(e[t]=[]),r.prependValue&&(n=n.concat(e[t]),e[t]=[]);for(let o=0;o<n.length;++o)G.addValue(e,t,n[o],r)}else if(e.hasOwnProperty(t)){const o=!r.allowDuplicate&&G.hasValue(e,t,n);!pe.isArray(e[t])&&(!o||r.propertyIsArray)&&(e[t]=[e[t]]),o||(r.prependValue?e[t].unshift(n):e[t].push(n))}else e[t]=r.propertyIsArray?[n]:n};G.getValues=(e,t)=>[].concat(e[t]||[]);G.removeProperty=(e,t)=>{delete e[t]};G.removeValue=(e,t,n,r)=>{r=r||{},"propertyIsArray"in r||(r.propertyIsArray=!1);const o=G.getValues(e,t).filter(a=>!G.compareValues(a,n));o.length===0?G.removeProperty(e,t):o.length===1&&!r.propertyIsArray?e[t]=o[0]:e[t]=o};G.relabelBlankNodes=(e,t)=>{t=t||{};const n=t.issuer||new fa("_:b");return On(n,e)};G.compareValues=(e,t)=>e===t||pn.isValue(e)&&pn.isValue(t)&&e["@value"]===t["@value"]&&e["@type"]===t["@type"]&&e["@language"]===t["@language"]&&e["@index"]===t["@index"]?!0:pe.isObject(e)&&"@id"in e&&pe.isObject(t)&&"@id"in t?e["@id"]===t["@id"]:!1;G.compareShortestLeast=(e,t)=>e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1;function On(e,t){if(pe.isArray(t))for(let n=0;n<t.length;++n)t[n]=On(e,t[n]);else if(pn.isList(t))t["@list"]=On(e,t["@list"]);else if(pe.isObject(t)){pn.isBlankNode(t)&&(t["@id"]=e.getId(t["@id"]));const n=Object.keys(t).sort();for(let r=0;r<n.length;++r){const o=n[r];o!=="@id"&&(t[o]=On(e,t[o]))}}return t}const Pe="http://www.w3.org/1999/02/22-rdf-syntax-ns#",Zt="http://www.w3.org/2001/XMLSchema#";var bi={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:Pe,RDF_LIST:Pe+"List",RDF_FIRST:Pe+"first",RDF_REST:Pe+"rest",RDF_NIL:Pe+"nil",RDF_TYPE:Pe+"type",RDF_PLAIN_LITERAL:Pe+"PlainLiteral",RDF_XML_LITERAL:Pe+"XMLLiteral",RDF_JSON_LITERAL:Pe+"JSON",RDF_OBJECT:Pe+"object",RDF_LANGSTRING:Pe+"langString",XSD:Zt,XSD_BOOLEAN:Zt+"boolean",XSD_DOUBLE:Zt+"double",XSD_INTEGER:Zt+"integer",XSD_STRING:Zt+"string"},dr,Ci;function ha(){return Ci||(Ci=1,dr=class{constructor(){this._requests={}}wrapLoader(t){const n=this;return n._loader=t,function(){return n.add.apply(n,arguments)}}async add(t){let n=this._requests[t];if(n)return Promise.resolve(n);n=this._requests[t]=this._loader(t);try{return await n}finally{delete this._requests[t]}}}),dr}const Vn=Ae,ge={};var ht=ge;ge.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([a-zA-Z][a-zA-Z0-9+-.]*):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}};ge.parse=(e,t)=>{const n={},r=ge.parsers[t||"full"],o=r.regex.exec(e);let a=r.keys.length;for(;a--;)n[r.keys[a]]=o[a]===void 0?null:o[a];return(n.scheme==="https"&&n.port==="443"||n.scheme==="http"&&n.port==="80")&&(n.href=n.href.replace(":"+n.port,""),n.authority=n.authority.replace(":"+n.port,""),n.port=null),n.normalizedPath=ge.removeDotSegments(n.path),n};ge.prependBase=(e,t)=>{if(e===null||ge.isAbsolute(t))return t;(!e||Vn.isString(e))&&(e=ge.parse(e||""));const n=ge.parse(t),r={protocol:e.protocol||""};if(n.authority!==null)r.authority=n.authority,r.path=n.path,r.query=n.query;else if(r.authority=e.authority,n.path==="")r.path=e.path,n.query!==null?r.query=n.query:r.query=e.query;else{if(n.path.indexOf("/")===0)r.path=n.path;else{let a=e.path;a=a.substr(0,a.lastIndexOf("/")+1),(a.length>0||e.authority)&&a.substr(-1)!=="/"&&(a+="/"),a+=n.path,r.path=a}r.query=n.query}n.path!==""&&(r.path=ge.removeDotSegments(r.path));let o=r.protocol;return r.authority!==null&&(o+="//"+r.authority),o+=r.path,r.query!==null&&(o+="?"+r.query),n.fragment!==null&&(o+="#"+n.fragment),o===""&&(o="./"),o};ge.removeBase=(e,t)=>{if(e===null)return t;(!e||Vn.isString(e))&&(e=ge.parse(e||""));let n="";if(e.href!==""?n+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(n+="//"),t.indexOf(n)!==0)return t;const r=ge.parse(t.substr(n.length)),o=e.normalizedPath.split("/"),a=r.normalizedPath.split("/"),i=r.fragment||r.query?0:1;for(;o.length>0&&a.length>i&&o[0]===a[0];)o.shift(),a.shift();let l="";if(o.length>0){o.pop();for(let f=0;f<o.length;++f)l+="../"}return l+=a.join("/"),r.query!==null&&(l+="?"+r.query),r.fragment!==null&&(l+="#"+r.fragment),l===""&&(l="./"),l};ge.removeDotSegments=e=>{if(e.length===0)return"";const t=e.split("/"),n=[];for(;t.length>0;){const r=t.shift(),o=t.length===0;if(r==="."){o&&n.push("");continue}if(r===".."){n.pop(),o&&n.push("");continue}n.push(r)}return e[0]==="/"&&n.length>0&&n[0]!==""&&n.unshift(""),n.length===1&&n[0]===""?"/":n.join("/")};const ol=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;ge.isAbsolute=e=>Vn.isString(e)&&ol.test(e);ge.isRelative=e=>Vn.isString(e);const{parseLinkHeader:al,buildHeaders:sl}=$e,{LINK_HEADER_CONTEXT:ll}=bi,en=ke,cl=ha(),{prependBase:dl}=ht,ul=/(^|(\r\n))link:/i;var fl=({secure:e,headers:t={},xhr:n}={headers:{}})=>{return t=sl(t),new cl().wrapLoader(o);async function o(a){if(a.indexOf("http:")!==0&&a.indexOf("https:")!==0)throw new en('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:a});if(e&&a.indexOf("https")!==0)throw new en(`URL could not be dereferenced; secure mode is enabled and the URL's scheme is not "https".`,"jsonld.InvalidUrl",{code:"loading document failed",url:a});let i;try{i=await hl(n,a,t)}catch(g){throw new en("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:a,cause:g})}if(i.status>=400)throw new en("URL could not be dereferenced: "+i.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:a,httpStatusCode:i.status});let l={contextUrl:null,documentUrl:a,document:i.response},f=null;const c=i.getResponseHeader("Content-Type");let p;if(ul.test(i.getAllResponseHeaders())&&(p=i.getResponseHeader("Link")),p&&c!=="application/ld+json"){const g=al(p),d=g[ll];if(Array.isArray(d))throw new en("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:a});d&&(l.contextUrl=d.target),f=g.alternate,f&&f.type=="application/ld+json"&&!(c||"").match(/^application\/(\w*\+)?json$/)&&(l=await o(dl(a,f.target)))}return l}};function hl(e,t,n){e=e||XMLHttpRequest;const r=new e;return new Promise((o,a)=>{r.onload=()=>o(r),r.onerror=i=>a(i),r.open("GET",t,!0);for(const i in n)r.setRequestHeader(i,n[i]);r.send()})}const pl=fl,wi={};var gl=wi;wi.setupDocumentLoaders=function(e){typeof XMLHttpRequest<"u"&&(e.documentLoaders.xhr=pl,e.useDocumentLoader("xhr"))};wi.setupGlobals=function(e){typeof globalThis.JsonLdProcessor>"u"&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e.JsonLdProcessor})};var ur,Xi;function yl(){return Xi||(Xi=1,ur=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),ur}var bl=B;B.Node=Nt;B.create=B;function B(e){var t=this;if(t instanceof B||(t=new B),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(o){t.push(o)});else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}B.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t};B.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};B.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};B.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)vl(this,arguments[e]);return this.length};B.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)_l(this,arguments[e]);return this.length};B.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};B.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};B.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;n!==null;r++)e.call(t,n.value,r,this),n=n.next};B.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;n!==null;r--)e.call(t,n.value,r,this),n=n.prev};B.prototype.get=function(e){for(var t=0,n=this.head;n!==null&&t<e;t++)n=n.next;if(t===e&&n!==null)return n.value};B.prototype.getReverse=function(e){for(var t=0,n=this.tail;n!==null&&t<e;t++)n=n.prev;if(t===e&&n!==null)return n.value};B.prototype.map=function(e,t){t=t||this;for(var n=new B,r=this.head;r!==null;)n.push(e.call(t,r.value,this)),r=r.next;return n};B.prototype.mapReverse=function(e,t){t=t||this;for(var n=new B,r=this.tail;r!==null;)n.push(e.call(t,r.value,this)),r=r.prev;return n};B.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else if(this.head)r=this.head.next,n=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var o=0;r!==null;o++)n=e(n,r.value,o),r=r.next;return n};B.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else if(this.tail)r=this.tail.prev,n=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var o=this.length-1;r!==null;o--)n=e(n,r.value,o),r=r.prev;return n};B.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;n!==null;t++)e[t]=n.value,n=n.next;return e};B.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;n!==null;t++)e[t]=n.value,n=n.prev;return e};B.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new B;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,o=this.head;o!==null&&r<e;r++)o=o.next;for(;o!==null&&r<t;r++,o=o.next)n.push(o.value);return n};B.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var n=new B;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,o=this.tail;o!==null&&r>t;r--)o=o.prev;for(;o!==null&&r>e;r--,o=o.prev)n.push(o.value);return n};B.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,o=this.head;o!==null&&r<e;r++)o=o.next;for(var a=[],r=0;o&&r<t;r++)a.push(o.value),o=this.removeNode(o);o===null&&(o=this.tail),o!==this.head&&o!==this.tail&&(o=o.prev);for(var r=0;r<n.length;r++)o=wl(this,o,n[r]);return a};B.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;n!==null;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};function wl(e,t,n){var r=t===e.head?new Nt(n,null,t,e):new Nt(n,t,t.next,e);return r.next===null&&(e.tail=r),r.prev===null&&(e.head=r),e.length++,r}function vl(e,t){e.tail=new Nt(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function _l(e,t){e.head=new Nt(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Nt(e,t,n,r){if(!(this instanceof Nt))return new Nt(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}try{yl()(B)}catch{}const ml=bl,mt=Symbol("max"),Ze=Symbol("length"),Jt=Symbol("lengthCalculator"),sn=Symbol("allowStale"),Et=Symbol("maxAge"),Qe=Symbol("dispose"),zi=Symbol("noDisposeOnSet"),ce=Symbol("lruList"),We=Symbol("cache"),pa=Symbol("updateAgeOnGet"),fr=()=>1;class Sl{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[mt]=t.max||1/0;const n=t.length||fr;if(this[Jt]=typeof n!="function"?fr:n,this[sn]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[Et]=t.maxAge||0,this[Qe]=t.dispose,this[zi]=t.noDisposeOnSet||!1,this[pa]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[mt]=t||1/0,tn(this)}get max(){return this[mt]}set allowStale(t){this[sn]=!!t}get allowStale(){return this[sn]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[Et]=t,tn(this)}get maxAge(){return this[Et]}set lengthCalculator(t){typeof t!="function"&&(t=fr),t!==this[Jt]&&(this[Jt]=t,this[Ze]=0,this[ce].forEach(n=>{n.length=this[Jt](n.value,n.key),this[Ze]+=n.length})),tn(this)}get lengthCalculator(){return this[Jt]}get length(){return this[Ze]}get itemCount(){return this[ce].length}rforEach(t,n){n=n||this;for(let r=this[ce].tail;r!==null;){const o=r.prev;Ki(this,t,r,n),r=o}}forEach(t,n){n=n||this;for(let r=this[ce].head;r!==null;){const o=r.next;Ki(this,t,r,n),r=o}}keys(){return this[ce].toArray().map(t=>t.key)}values(){return this[ce].toArray().map(t=>t.value)}reset(){this[Qe]&&this[ce]&&this[ce].length&&this[ce].forEach(t=>this[Qe](t.key,t.value)),this[We]=new Map,this[ce]=new ml,this[Ze]=0}dump(){return this[ce].map(t=>Mn(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[ce]}set(t,n,r){if(r=r||this[Et],r&&typeof r!="number")throw new TypeError("maxAge must be a number");const o=r?Date.now():0,a=this[Jt](n,t);if(this[We].has(t)){if(a>this[mt])return Vt(this,this[We].get(t)),!1;const f=this[We].get(t).value;return this[Qe]&&(this[zi]||this[Qe](t,f.value)),f.now=o,f.maxAge=r,f.value=n,this[Ze]+=a-f.length,f.length=a,this.get(t),tn(this),!0}const i=new El(t,n,a,o,r);return i.length>this[mt]?(this[Qe]&&this[Qe](t,n),!1):(this[Ze]+=i.length,this[ce].unshift(i),this[We].set(t,this[ce].head),tn(this),!0)}has(t){if(!this[We].has(t))return!1;const n=this[We].get(t).value;return!Mn(this,n)}get(t){return hr(this,t,!0)}peek(t){return hr(this,t,!1)}pop(){const t=this[ce].tail;return t?(Vt(this,t),t.value):null}del(t){Vt(this,this[We].get(t))}load(t){this.reset();const n=Date.now();for(let r=t.length-1;r>=0;r--){const o=t[r],a=o.e||0;if(a===0)this.set(o.k,o.v);else{const i=a-n;i>0&&this.set(o.k,o.v,i)}}}prune(){this[We].forEach((t,n)=>hr(this,n,!1))}}const hr=(e,t,n)=>{const r=e[We].get(t);if(r){const o=r.value;if(Mn(e,o)){if(Vt(e,r),!e[sn])return}else n&&(e[pa]&&(r.value.now=Date.now()),e[ce].unshiftNode(r));return o.value}},Mn=(e,t)=>{if(!t||!t.maxAge&&!e[Et])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[Et]&&n>e[Et]},tn=e=>{if(e[Ze]>e[mt])for(let t=e[ce].tail;e[Ze]>e[mt]&&t!==null;){const n=t.prev;Vt(e,t),t=n}},Vt=(e,t)=>{if(t){const n=t.value;e[Qe]&&e[Qe](n.key,n.value),e[Ze]-=n.length,e[We].delete(n.key),e[ce].removeNode(t)}};class El{constructor(t,n,r,o,a){this.key=t,this.value=n,this.length=r,this.now=o,this.maxAge=a||0}}const Ki=(e,t,n,r)=>{let o=n.value;Mn(e,o)&&(Vt(e,n),e[sn]||(o=void 0)),o&&t.call(r,o.value,o.key,e)};var ga=Sl;const Rl=ga,Il=10;var Al=class{constructor({document:t}){this.document=t,this.cache=new Rl({max:Il})}getProcessed(t){return this.cache.get(t)}setProcessed(t,n){this.cache.set(t,n)}};const{isArray:qr,isObject:ln,isString:Pn}=Ae,{asArray:xl}=$e,{prependBase:Cr}=ht,rn=ke,Yi=Al,Qi=10;var Nl=class{constructor({sharedCache:t}){this.perOpCache=new Map,this.sharedCache=t}async resolve({activeCtx:t,context:n,documentLoader:r,base:o,cycles:a=new Set}){n&&ln(n)&&n["@context"]&&(n=n["@context"]),n=xl(n);const i=[];for(const l of n){if(Pn(l)){let p=this._get(l);p||(p=await this._resolveRemoteContext({activeCtx:t,url:l,documentLoader:r,base:o,cycles:a})),qr(p)?i.push(...p):i.push(p);continue}if(l===null){i.push(new Yi({document:null}));continue}ln(l)||Dl(n);const f=JSON.stringify(l);let c=this._get(f);c||(c=new Yi({document:l}),this._cacheResolvedContext({key:f,resolved:c,tag:"static"})),i.push(c)}return i}_get(t){let n=this.perOpCache.get(t);if(!n){const r=this.sharedCache.get(t);r&&(n=r.get("static"),n&&this.perOpCache.set(t,n))}return n}_cacheResolvedContext({key:t,resolved:n,tag:r}){if(this.perOpCache.set(t,n),r!==void 0){let o=this.sharedCache.get(t);o||(o=new Map,this.sharedCache.set(t,o)),o.set(r,n)}return n}async _resolveRemoteContext({activeCtx:t,url:n,documentLoader:r,base:o,cycles:a}){n=Cr(o,n);const{context:i,remoteDoc:l}=await this._fetchContext({activeCtx:t,url:n,documentLoader:r,cycles:a});o=l.documentUrl||n,Xr({context:i,base:o});const f=await this.resolve({activeCtx:t,context:i,documentLoader:r,base:o,cycles:a});return this._cacheResolvedContext({key:n,resolved:f,tag:l.tag}),f}async _fetchContext({activeCtx:t,url:n,documentLoader:r,cycles:o}){if(o.size>Qi)throw new rn("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:t.processingMode==="json-ld-1.0"?"loading remote context failed":"context overflow",max:Qi});if(o.has(n))throw new rn("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:t.processingMode==="json-ld-1.0"?"recursive context inclusion":"context overflow",url:n});o.add(n);let a,i;try{i=await r(n),a=i.document||null,Pn(a)&&(a=JSON.parse(a))}catch(l){throw new rn("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:n,cause:l})}if(!ln(a))throw new rn("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:n});return"@context"in a?a={"@context":a["@context"]}:a={"@context":{}},i.contextUrl&&(qr(a["@context"])||(a["@context"]=[a["@context"]]),a["@context"].push(i.contextUrl)),{context:a,remoteDoc:i}}};function Dl(e){throw new rn("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:e})}function Xr({context:e,base:t}){if(!e)return;const n=e["@context"];if(Pn(n)){e["@context"]=Cr(t,n);return}if(qr(n)){for(let r=0;r<n.length;++r){const o=n[r];if(Pn(o)){n[r]=Cr(t,o);continue}ln(o)&&Xr({context:{"@context":o},base:t})}return}if(ln(n))for(const r in n)Xr({context:n[r],base:t})}var Ol=yi.NQuads;const vi=ke,{isArray:Ll}=Ae,{asArray:ya}=$e,Ie={};var gn=Ie;Ie.defaultEventHandler=null;Ie.setupEventHandler=({options:e={}})=>{const t=[].concat(e.safe?Ie.safeEventHandler:[],e.eventHandler?ya(e.eventHandler):[],Ie.defaultEventHandler?Ie.defaultEventHandler:[]);return t.length===0?null:t};Ie.handleEvent=({event:e,options:t})=>{ba({event:e,handlers:t.eventHandler})};function ba({event:e,handlers:t}){let n=!0;for(let r=0;n&&r<t.length;++r){n=!1;const o=t[r];if(Ll(o))n=ba({event:e,handlers:o});else if(typeof o=="function")o({event:e,next:()=>{n=!0}});else if(typeof o=="object")e.code in o?o[e.code]({event:e,next:()=>{n=!0}}):n=!0;else throw new vi("Invalid event handler.","jsonld.InvalidEventHandler",{event:e})}return n}const Tl=new Set(["empty object","free-floating scalar","invalid @language value","invalid property","null @id value","null @value value","object with only @id","object with only @language","object with only @list","object with only @value","relative @id reference","relative @type reference","relative @vocab reference","reserved @id value","reserved @reverse value","reserved term","blank node predicate","relative graph reference","relative object reference","relative predicate reference","relative subject reference","rdfDirection not set"]);Ie.safeEventHandler=function({event:t,next:n}){if(t.level==="warning"&&Tl.has(t.code))throw new vi("Safe mode validation error.","jsonld.ValidationError",{event:t});n()};Ie.logEventHandler=function({event:t,next:n}){console.log(`EVENT: ${t.message}`,{event:t}),n()};Ie.logWarningEventHandler=function({event:t,next:n}){t.level==="warning"&&console.warn(`WARNING: ${t.message}`,{event:t}),n()};Ie.unhandledEventHandler=function({event:t}){throw new vi("No handler for event.","jsonld.UnhandledEvent",{event:t})};Ie.setDefaultEventHandler=function({eventHandler:e}={}){Ie.defaultEventHandler=e?ya(e):null};const Zi=$e,$=ke,{isArray:wa,isObject:dt,isString:_e,isUndefined:jl}=Ae,{isAbsolute:Rt,isRelative:kl,prependBase:cn}=ht,{handleEvent:Gt}=gn,{REGEX_BCP47:$l,REGEX_KEYWORD:Ln,asArray:va,compareShortestLeast:Ml}=$e,_n=new Map,Pl=1e4,Y={};var Tt=Y;Y.process=async({activeCtx:e,localCtx:t,options:n,propagate:r=!0,overrideProtected:o=!1,cycles:a=new Set})=>{if(dt(t)&&"@context"in t&&wa(t["@context"])&&(t=t["@context"]),va(t).length===0)return e;const l=[],f=[({event:d,next:s})=>{l.push(d),s()}];n.eventHandler&&f.push(n.eventHandler);const c=n;n={...n,eventHandler:f};const p=await n.contextResolver.resolve({activeCtx:e,context:t,documentLoader:n.documentLoader,base:n.base});dt(p[0].document)&&typeof p[0].document["@propagate"]=="boolean"&&(r=p[0].document["@propagate"]);let g=e;!r&&!g.previousContext&&(g=g.clone(),g.previousContext=e);for(const d of p){let{document:s}=d;if(e=g,s===null){if(!o&&Object.keys(e.protected).length!==0)throw new $("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});g=e=Y.getInitialContext(n).clone();continue}const u=d.getProcessed(e);if(u){if(c.eventHandler)for(const w of u.events)Gt({event:w,options:c});g=e=u.context;continue}if(dt(s)&&"@context"in s&&(s=s["@context"]),!dt(s))throw new $("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:s});g=g.clone();const y=new Map;if("@version"in s){if(s["@version"]!==1.1)throw new $("Unsupported JSON-LD version: "+s["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:s});if(e.processingMode&&e.processingMode==="json-ld-1.0")throw new $("@version: "+s["@version"]+" not compatible with "+e.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:s});g.processingMode="json-ld-1.1",g["@version"]=s["@version"],y.set("@version",!0)}if(g.processingMode=g.processingMode||e.processingMode,"@base"in s){let w=s["@base"];if(!(w===null||Rt(w)))if(kl(w))w=cn(g["@base"],w);else throw new $('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:s});g["@base"]=w,y.set("@base",!0)}if("@vocab"in s){const w=s["@vocab"];if(w===null)delete g["@vocab"];else if(_e(w)){if(!Rt(w)&&Y.processingMode(g,1))throw new $('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:s});{const v=Bt(g,w,{vocab:!0,base:!0},void 0,void 0,n);Rt(v)||n.eventHandler&&Gt({event:{type:["JsonLdEvent"],code:"relative @vocab reference",level:"warning",message:"Relative @vocab reference found.",details:{vocab:v}},options:n}),g["@vocab"]=v}}else throw new $('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:s});y.set("@vocab",!0)}if("@language"in s){const w=s["@language"];if(w===null)delete g["@language"];else if(_e(w))w.match($l)||n.eventHandler&&Gt({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:w}},options:n}),g["@language"]=w.toLowerCase();else throw new $('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:s});y.set("@language",!0)}if("@direction"in s){const w=s["@direction"];if(e.processingMode==="json-ld-1.0")throw new $("Invalid JSON-LD syntax; @direction not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:s});if(w===null)delete g["@direction"];else{if(w!=="ltr"&&w!=="rtl")throw new $('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:s});g["@direction"]=w}y.set("@direction",!0)}if("@propagate"in s){const w=s["@propagate"];if(e.processingMode==="json-ld-1.0")throw new $("Invalid JSON-LD syntax; @propagate not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:s});if(typeof w!="boolean")throw new $("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:t});y.set("@propagate",!0)}if("@import"in s){const w=s["@import"];if(e.processingMode==="json-ld-1.0")throw new $("Invalid JSON-LD syntax; @import not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:s});if(!_e(w))throw new $("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:t});const v=await n.contextResolver.resolve({activeCtx:e,context:w,documentLoader:n.documentLoader,base:n.base});if(v.length!==1)throw new $("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:t});const E=v[0].getProcessed(e);if(E)s=E;else{const S=v[0].document;if("@import"in S)throw new $("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:t});for(const I in S)s.hasOwnProperty(I)||(s[I]=S[I]);v[0].setProcessed(e,s)}y.set("@import",!0)}y.set("@protected",s["@protected"]||!1);for(const w in s)if(Y.createTermDefinition({activeCtx:g,localCtx:s,term:w,defined:y,options:n,overrideProtected:o}),dt(s[w])&&"@context"in s[w]){const v=s[w]["@context"];let E=!0;if(_e(v)){const S=cn(n.base,v);a.has(S)?E=!1:a.add(S)}if(E)try{await Y.process({activeCtx:g.clone(),localCtx:s[w]["@context"],overrideProtected:!0,options:n,cycles:a})}catch{throw new $("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:s[w]["@context"],term:w})}}d.setProcessed(e,{context:g,events:l})}return g};Y.createTermDefinition=({activeCtx:e,localCtx:t,term:n,defined:r,options:o,overrideProtected:a=!1})=>{if(r.has(n)){if(r.get(n))return;throw new $("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:n})}r.set(n,!1);let i;if(t.hasOwnProperty(n)&&(i=t[n]),n==="@type"&&dt(i)&&(i["@container"]||"@set")==="@set"&&Y.processingMode(e,1.1)){const s=["@container","@id","@protected"],u=Object.keys(i);if(u.length===0||u.some(y=>!s.includes(y)))throw new $("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:n})}else{if(Y.isKeyword(n))throw new $("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:n});if(n.match(Ln)){o.eventHandler&&Gt({event:{type:["JsonLdEvent"],code:"reserved term",level:"warning",message:'Terms beginning with "@" are reserved for future use and dropped.',details:{term:n}},options:o});return}else if(n==="")throw new $("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t})}const l=e.mappings.get(n);e.mappings.has(n)&&e.mappings.delete(n);let f=!1;if((_e(i)||i===null)&&(f=!0,i={"@id":i}),!dt(i))throw new $("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});const c={};e.mappings.set(n,c),c.reverse=!1;const p=["@container","@id","@language","@reverse","@type"];Y.processingMode(e,1.1)&&p.push("@context","@direction","@index","@nest","@prefix","@protected");for(const s in i)if(!p.includes(s))throw new $("Invalid JSON-LD syntax; a term definition must not contain "+s,"jsonld.SyntaxError",{code:"invalid term definition",context:t});const g=n.indexOf(":");if(c._termHasColon=g>0,"@reverse"in i){if("@id"in i)throw new $("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});if("@nest"in i)throw new $("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});const s=i["@reverse"];if(!_e(s))throw new $("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(s.match(Ln)){o.eventHandler&&Gt({event:{type:["JsonLdEvent"],code:"reserved @reverse value",level:"warning",message:'@reverse values beginning with "@" are reserved for future use and dropped.',details:{reverse:s}},options:o}),l?e.mappings.set(n,l):e.mappings.delete(n);return}const u=Bt(e,s,{vocab:!0,base:!1},t,r,o);if(!Rt(u))throw new $("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});c["@id"]=u,c.reverse=!0}else if("@id"in i){let s=i["@id"];if(s&&!_e(s))throw new $("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(s===null)c["@id"]=null;else if(!Y.isKeyword(s)&&s.match(Ln)){o.eventHandler&&Gt({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:'@id values beginning with "@" are reserved for future use and dropped.',details:{id:s}},options:o}),l?e.mappings.set(n,l):e.mappings.delete(n);return}else if(s!==n){if(s=Bt(e,s,{vocab:!0,base:!1},t,r,o),!Rt(s)&&!Y.isKeyword(s))throw new $("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(n.match(/(?::[^:])|\//)){const u=new Map(r).set(n,!0);if(Bt(e,n,{vocab:!0,base:!1},t,u,o)!==s)throw new $("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t})}c["@id"]=s,c._prefix=f&&!c._termHasColon&&s.match(/[:\/\?#\[\]@]$/)!==null}}if(!("@id"in c))if(c._termHasColon){const s=n.substr(0,g);if(t.hasOwnProperty(s)&&Y.createTermDefinition({activeCtx:e,localCtx:t,term:s,defined:r,options:o}),e.mappings.has(s)){const u=n.substr(g+1);c["@id"]=e.mappings.get(s)["@id"]+u}else c["@id"]=n}else if(n==="@type")c["@id"]=n;else{if(!("@vocab"in e))throw new $("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:n});c["@id"]=e["@vocab"]+n}if((i["@protected"]===!0||r.get("@protected")===!0&&i["@protected"]!==!1)&&(e.protected[n]=!0,c.protected=!0),r.set(n,!0),"@type"in i){let s=i["@type"];if(!_e(s))throw new $("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(s==="@json"||s==="@none"){if(Y.processingMode(e,1))throw new $(`Invalid JSON-LD syntax; an @context @type value must not be "${s}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else if(s!=="@id"&&s!=="@vocab"){if(s=Bt(e,s,{vocab:!0,base:!1},t,r,o),!Rt(s))throw new $("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(s.indexOf("_:")===0)throw new $("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}c["@type"]=s}if("@container"in i){const s=_e(i["@container"])?[i["@container"]]:i["@container"]||[],u=["@list","@set","@index","@language"];let y=!0;const w=s.includes("@set");if(Y.processingMode(e,1.1)){if(u.push("@graph","@id","@type"),s.includes("@list")){if(s.length!==1)throw new $("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else if(s.includes("@graph")){if(s.some(v=>v!=="@graph"&&v!=="@id"&&v!=="@index"&&v!=="@set"))throw new $("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else y&=s.length<=(w?2:1);if(s.includes("@type")&&(c["@type"]=c["@type"]||"@id",!["@id","@vocab"].includes(c["@type"])))throw new $("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}else y&=!wa(i["@container"]),y&=s.length<=1;if(y&=s.every(v=>u.includes(v)),y&=!(w&&s.includes("@list")),!y)throw new $("Invalid JSON-LD syntax; @context @container value must be one of the following: "+u.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(c.reverse&&!s.every(v=>["@index","@set"].includes(v)))throw new $("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});c["@container"]=s}if("@index"in i){if(!("@container"in i)||!c["@container"].includes("@index"))throw new $(`Invalid JSON-LD syntax; @index without @index in @container: "${i["@index"]}" on term "${n}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});if(!_e(i["@index"])||i["@index"].indexOf("@")===0)throw new $(`Invalid JSON-LD syntax; @index must expand to an IRI: "${i["@index"]}" on term "${n}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:t});c["@index"]=i["@index"]}if("@context"in i&&(c["@context"]=i["@context"]),"@language"in i&&!("@type"in i)){let s=i["@language"];if(s!==null&&!_e(s))throw new $("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});s!==null&&(s=s.toLowerCase()),c["@language"]=s}if("@prefix"in i){if(n.match(/:|\//))throw new $("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:t});if(Y.isKeyword(c["@id"]))throw new $("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:t});if(typeof i["@prefix"]=="boolean")c._prefix=i["@prefix"]===!0;else throw new $("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:t})}if("@direction"in i){const s=i["@direction"];if(s!==null&&s!=="ltr"&&s!=="rtl")throw new $('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:t});c["@direction"]=s}if("@nest"in i){const s=i["@nest"];if(!_e(s)||s!=="@nest"&&s.indexOf("@")===0)throw new $("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:t});c["@nest"]=s}// disallow aliasing @context and @preserve
const d=c["@id"];if(d==="@context"||d==="@preserve")throw new $("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t});if(l&&l.protected&&!a&&(e.protected[n]=!0,c.protected=!0,!zr(l,c)))throw new $("Invalid JSON-LD syntax; tried to redefine a protected term.","jsonld.SyntaxError",{code:"protected term redefinition",context:t,term:n})};Y.expandIri=(e,t,n,r)=>Bt(e,t,n,void 0,void 0,r);function Bt(e,t,n,r,o,a){if(t===null||!_e(t)||Y.isKeyword(t))return t;if(t.match(Ln))return null;if(r&&r.hasOwnProperty(t)&&o.get(t)!==!0&&Y.createTermDefinition({activeCtx:e,localCtx:r,term:t,defined:o,options:a}),n=n||{},n.vocab){const l=e.mappings.get(t);if(l===null)return null;if(dt(l)&&"@id"in l)return l["@id"]}const i=t.indexOf(":");if(i>0){const l=t.substr(0,i),f=t.substr(i+1);if(l==="_"||f.indexOf("//")===0)return t;r&&r.hasOwnProperty(l)&&Y.createTermDefinition({activeCtx:e,localCtx:r,term:l,defined:o,options:a});const c=e.mappings.get(l);if(c&&c._prefix)return c["@id"]+f;if(Rt(t))return t}if(n.vocab&&"@vocab"in e)t=e["@vocab"]+t;else if(n.base){let l,f;"@base"in e?e["@base"]?(f=cn(a.base,e["@base"]),l=cn(f,t)):(f=e["@base"],l=t):(f=a.base,l=cn(a.base,t)),t=l}return t}Y.getInitialContext=e=>{const t=JSON.stringify({processingMode:e.processingMode}),n=_n.get(t);if(n)return n;const r={processingMode:e.processingMode,mappings:new Map,inverse:null,getInverse:o,clone:l,revertToPreviousContext:f,protected:{}};return _n.size===Pl&&_n.clear(),_n.set(t,r),r;function o(){const c=this;if(c.inverse)return c.inverse;const p=c.inverse={},g=c.fastCurieMap={},d={},s=(c["@language"]||"@none").toLowerCase(),u=c["@direction"],y=c.mappings,w=[...y.keys()].sort(Ml);for(const v of w){const E=y.get(v);if(E===null)continue;let S=E["@container"]||"@none";if(S=[].concat(S).sort().join(""),E["@id"]===null)continue;const I=va(E["@id"]);for(const x of I){let R=p[x];const V=Y.isKeyword(x);if(R)!V&&!E._termHasColon&&d[x].push(v);else if(p[x]=R={},!V&&!E._termHasColon){d[x]=[v];const k={iri:x,terms:d[x]};x[0]in g?g[x[0]].push(k):g[x[0]]=[k]}if(R[S]||(R[S]={"@language":{},"@type":{},"@any":{}}),R=R[S],i(v,R["@any"],"@none"),E.reverse)i(v,R["@type"],"@reverse");else if(E["@type"]==="@none")i(v,R["@any"],"@none"),i(v,R["@language"],"@none"),i(v,R["@type"],"@none");else if("@type"in E)i(v,R["@type"],E["@type"]);else if("@language"in E&&"@direction"in E){const k=E["@language"],F=E["@direction"];k&&F?i(v,R["@language"],`${k}_${F}`.toLowerCase()):k?i(v,R["@language"],k.toLowerCase()):F?i(v,R["@language"],`_${F}`):i(v,R["@language"],"@null")}else"@language"in E?i(v,R["@language"],(E["@language"]||"@null").toLowerCase()):"@direction"in E?E["@direction"]?i(v,R["@language"],`_${E["@direction"]}`):i(v,R["@language"],"@none"):u?(i(v,R["@language"],`_${u}`),i(v,R["@language"],"@none"),i(v,R["@type"],"@none")):(i(v,R["@language"],s),i(v,R["@language"],"@none"),i(v,R["@type"],"@none"))}}for(const v in g)a(g,v,1);return p}function a(c,p,g){const d=c[p],s=c[p]={};let u,y;for(const w of d)u=w.iri,g>=u.length?y="":y=u[g],y in s?s[y].push(w):s[y]=[w];for(const w in s)w!==""&&a(s,w,g+1)}function i(c,p,g){p.hasOwnProperty(g)||(p[g]=c)}function l(){const c={};return c.mappings=Zi.clone(this.mappings),c.clone=this.clone,c.inverse=null,c.getInverse=this.getInverse,c.protected=Zi.clone(this.protected),this.previousContext&&(c.previousContext=this.previousContext.clone()),c.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(c["@base"]=this["@base"]),"@language"in this&&(c["@language"]=this["@language"]),"@vocab"in this&&(c["@vocab"]=this["@vocab"]),c}function f(){return this.previousContext?this.previousContext.clone():this}};Y.getContextValue=(e,t,n)=>{if(t===null)return n==="@context"?void 0:null;if(e.mappings.has(t)){const r=e.mappings.get(t);if(jl(n))return r;if(r.hasOwnProperty(n))return r[n]}if(n==="@language"&&n in e||n==="@direction"&&n in e)return e[n];if(n!=="@context")return null};Y.processingMode=(e,t)=>t.toString()>="1.1"?!e.processingMode||e.processingMode>="json-ld-"+t.toString():e.processingMode==="json-ld-1.0";Y.isKeyword=e=>{if(!_e(e)||e[0]!=="@")return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1};function zr(e,t){if(!(e&&typeof e=="object")||!(t&&typeof t=="object"))return e===t;const n=Array.isArray(e);if(n!==Array.isArray(t))return!1;if(n){if(e.length!==t.length)return!1;for(let a=0;a<e.length;++a)if(!zr(e[a],t[a]))return!1;return!0}const r=Object.keys(e),o=Object.keys(t);if(r.length!==o.length)return!1;for(const a in e){let i=e[a],l=t[a];if(a==="@container"&&Array.isArray(i)&&Array.isArray(l)&&(i=i.slice().sort(),l=l.slice().sort()),!zr(i,l))return!1}return!0}const Q=ke,{isArray:Te,isObject:Ne,isEmptyObject:Kr,isString:he,isUndefined:Fn}=Ae,{isList:pr,isValue:Yr,isGraph:Fl,isSubject:Wl}=it,{expandIri:ae,getContextValue:Re,isKeyword:Qr,process:dn,processingMode:Tn}=Tt,{isAbsolute:jn}=ht,{REGEX_BCP47:_a,REGEX_KEYWORD:Jl,addValue:Ee,asArray:Fe,getValues:Ul,validateTypeValue:Hl}=$e,{handleEvent:Oe}=gn,ut={};var Bl=ut;ut.expand=async({activeCtx:e,activeProperty:t=null,element:n,options:r={},insideList:o=!1,insideIndex:a=!1,typeScopedContext:i=null})=>{if(n==null)return null;if(t==="@default"&&(r=Object.assign({},r,{isFrame:!1})),!Te(n)&&!Ne(n))return!o&&(t===null||ae(e,t,{vocab:!0},r)==="@graph")?(r.eventHandler&&Oe({event:{type:["JsonLdEvent"],code:"free-floating scalar",level:"warning",message:"Dropping free-floating scalar not in a list.",details:{value:n}},options:r}),null):Ea({activeCtx:e,activeProperty:t,value:n,options:r});if(Te(n)){let u=[];const y=Re(e,t,"@container")||[];o=o||y.includes("@list");for(let w=0;w<n.length;++w){let v=await ut.expand({activeCtx:e,activeProperty:t,element:n[w],options:r,insideIndex:a,typeScopedContext:i});o&&Te(v)&&(v={"@list":v}),v!==null&&(Te(v)?u=u.concat(v):u.push(v))}return u}const l=ae(e,t,{vocab:!0},r),f=Re(e,t,"@context");i=i||(e.previousContext?e:null);let c=Object.keys(n).sort(),p=!a;if(p&&i&&c.length<=2&&!c.includes("@context"))for(const u of c){const y=ae(i,u,{vocab:!0},r);if(y==="@value"){p=!1,e=i;break}if(y==="@id"&&c.length===1){p=!1;break}}p&&(e=e.revertToPreviousContext()),Fn(f)||(e=await dn({activeCtx:e,localCtx:f,propagate:!0,overrideProtected:!0,options:r})),"@context"in n&&(e=await dn({activeCtx:e,localCtx:n["@context"],options:r})),i=e;let g=null;for(const u of c)if(ae(e,u,{vocab:!0},r)==="@type"){g=g||u;const w=n[u],v=Array.isArray(w)?w.length>1?w.slice().sort():w:[w];for(const E of v){const S=Re(i,E,"@context");Fn(S)||(e=await dn({activeCtx:e,localCtx:S,options:r,propagate:!1}))}}let d={};await Sa({activeCtx:e,activeProperty:t,expandedActiveProperty:l,element:n,expandedParent:d,options:r,insideList:o,typeKey:g,typeScopedContext:i}),c=Object.keys(d);let s=c.length;if("@value"in d){if("@type"in d&&("@language"in d||"@direction"in d))throw new Q('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:d});let u=s-1;if("@type"in d&&(u-=1),"@index"in d&&(u-=1),"@language"in d&&(u-=1),"@direction"in d&&(u-=1),u!==0)throw new Q('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:d});const y=d["@value"]===null?[]:Fe(d["@value"]),w=Ul(d,"@type");if(!(Tn(e,1.1)&&w.includes("@json")&&w.length===1))if(y.length===0)r.eventHandler&&Oe({event:{type:["JsonLdEvent"],code:"null @value value",level:"warning",message:"Dropping null @value value.",details:{value:d}},options:r}),d=null;else{if(!y.every(v=>he(v)||Kr(v))&&"@language"in d)throw new Q("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:d});if(!w.every(v=>jn(v)&&!(he(v)&&v.indexOf("_:")===0)||Kr(v)))throw new Q('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:d})}}else if("@type"in d&&!Te(d["@type"]))d["@type"]=[d["@type"]];else if("@set"in d||"@list"in d){if(s>1&&!(s===2&&"@index"in d))throw new Q('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:d});"@set"in d&&(d=d["@set"],c=Object.keys(d),s=c.length)}else s===1&&"@language"in d&&(r.eventHandler&&Oe({event:{type:["JsonLdEvent"],code:"object with only @language",level:"warning",message:"Dropping object with only @language.",details:{value:d}},options:r}),d=null);return Ne(d)&&!r.keepFreeFloatingNodes&&!o&&(t===null||l==="@graph"||(Re(e,t,"@container")||[]).includes("@graph"))&&(d=ma({value:d,count:s,options:r})),d};function ma({value:e,count:t,options:n}){if(t===0||"@value"in e||"@list"in e||t===1&&"@id"in e){if(n.eventHandler){let r,o;t===0?(r="empty object",o="Dropping empty object."):"@value"in e?(r="object with only @value",o="Dropping object with only @value."):"@list"in e?(r="object with only @list",o="Dropping object with only @list."):t===1&&"@id"in e&&(r="object with only @id",o="Dropping object with only @id."),Oe({event:{type:["JsonLdEvent"],code:r,level:"warning",message:o,details:{value:e}},options:n})}return null}return e}async function Sa({activeCtx:e,activeProperty:t,expandedActiveProperty:n,element:r,expandedParent:o,options:a={},insideList:i,typeKey:l,typeScopedContext:f}){const c=Object.keys(r).sort(),p=[];let g;const d=r[l]&&ae(e,Te(r[l])?r[l][0]:r[l],{vocab:!0},{...a,typeExpansion:!0})==="@json";for(const s of c){let u=r[s],y;if(s==="@context")continue;const w=ae(e,s,{vocab:!0},a);if(w===null||!(jn(w)||Qr(w))){a.eventHandler&&Oe({event:{type:["JsonLdEvent"],code:"invalid property",level:"warning",message:"Dropping property that did not expand into an absolute IRI or keyword.",details:{property:s,expandedProperty:w}},options:a});continue}if(Qr(w)){if(n==="@reverse")throw new Q("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:u});if(w in o&&w!=="@included"&&w!=="@type")throw new Q("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:w})}if(w==="@id"){if(!he(u)){if(!a.isFrame)throw new Q('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:u});if(Ne(u)){if(!Kr(u))throw new Q('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:u})}else if(Te(u)){if(!u.every(I=>he(I)))throw new Q('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:u})}else throw new Q('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:u})}Ee(o,"@id",Fe(u).map(I=>{if(he(I)){const x=ae(e,I,{base:!0},a);return a.eventHandler&&(x===null?Oe(I===null?{event:{type:["JsonLdEvent"],code:"null @id value",level:"warning",message:"Null @id found.",details:{id:I}},options:a}:{event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:I}},options:a}):jn(x)||Oe({event:{type:["JsonLdEvent"],code:"relative @id reference",level:"warning",message:"Relative @id reference found.",details:{id:I,expandedId:x}},options:a})),x}return I}),{propertyIsArray:a.isFrame});continue}if(w==="@type"){Ne(u)&&(u=Object.fromEntries(Object.entries(u).map(([I,x])=>[ae(f,I,{vocab:!0}),Fe(x).map(R=>ae(f,R,{base:!0,vocab:!0},{...a,typeExpansion:!0}))]))),Hl(u,a.isFrame),Ee(o,"@type",Fe(u).map(I=>{if(he(I)){const x=ae(f,I,{base:!0,vocab:!0},{...a,typeExpansion:!0});return x!=="@json"&&!jn(x)&&a.eventHandler&&Oe({event:{type:["JsonLdEvent"],code:"relative @type reference",level:"warning",message:"Relative @type reference found.",details:{type:I}},options:a}),x}return I}),{propertyIsArray:!!a.isFrame});continue}if(w==="@included"&&Tn(e,1.1)){const I=Fe(await ut.expand({activeCtx:e,activeProperty:t,element:u,options:a}));if(!I.every(x=>Wl(x)))throw new Q("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:u});Ee(o,"@included",I,{propertyIsArray:!0});continue}if(w==="@graph"&&!(Ne(u)||Te(u)))throw new Q('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:u});if(w==="@value"){g=u,d&&Tn(e,1.1)?o["@value"]=u:Ee(o,"@value",u,{propertyIsArray:a.isFrame});continue}if(w==="@language"){if(u===null)continue;if(!he(u)&&!a.isFrame)throw new Q('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:u});u=Fe(u).map(I=>he(I)?I.toLowerCase():I);for(const I of u)he(I)&&!I.match(_a)&&a.eventHandler&&Oe({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:I}},options:a});Ee(o,"@language",u,{propertyIsArray:a.isFrame});continue}if(w==="@direction"){if(!he(u)&&!a.isFrame)throw new Q('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:u});u=Fe(u);for(const I of u)if(he(I)&&I!=="ltr"&&I!=="rtl")throw new Q('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:u});Ee(o,"@direction",u,{propertyIsArray:a.isFrame});continue}if(w==="@index"){if(!he(u))throw new Q('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:u});Ee(o,"@index",u);continue}if(w==="@reverse"){if(!Ne(u))throw new Q('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:u});if(y=await ut.expand({activeCtx:e,activeProperty:"@reverse",element:u,options:a}),"@reverse"in y)for(const x in y["@reverse"])Ee(o,x,y["@reverse"][x],{propertyIsArray:!0});let I=o["@reverse"]||null;for(const x in y){if(x==="@reverse")continue;I===null&&(I=o["@reverse"]={}),Ee(I,x,[],{propertyIsArray:!0});const R=y[x];for(let V=0;V<R.length;++V){const k=R[V];if(Yr(k)||pr(k))throw new Q('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:y});Ee(I,x,k,{propertyIsArray:!0})}}continue}if(w==="@nest"){p.push(s);continue}let v=e;const E=Re(e,s,"@context");Fn(E)||(v=await dn({activeCtx:e,localCtx:E,propagate:!0,overrideProtected:!0,options:a}));const S=Re(e,s,"@container")||[];if(S.includes("@language")&&Ne(u)){const I=Re(v,s,"@direction");y=Vl(v,u,I,a)}else if(S.includes("@index")&&Ne(u)){const I=S.includes("@graph"),x=Re(v,s,"@index")||"@index",R=x!=="@index"&&ae(e,x,{vocab:!0},a);y=await gr({activeCtx:v,options:a,activeProperty:s,value:u,asGraph:I,indexKey:x,propertyIndex:R})}else if(S.includes("@id")&&Ne(u)){const I=S.includes("@graph");y=await gr({activeCtx:v,options:a,activeProperty:s,value:u,asGraph:I,indexKey:"@id"})}else if(S.includes("@type")&&Ne(u))y=await gr({activeCtx:v.revertToPreviousContext(),options:a,activeProperty:s,value:u,asGraph:!1,indexKey:"@type"});else{const I=w==="@list";if(I||w==="@set"){let x=t;I&&n==="@graph"&&(x=null),y=await ut.expand({activeCtx:v,activeProperty:x,element:u,options:a,insideList:I})}else Re(e,s,"@type")==="@json"?y={"@type":"@json","@value":u}:y=await ut.expand({activeCtx:v,activeProperty:s,element:u,options:a,insideList:!1})}if(!(y===null&&w!=="@value")){if(w!=="@list"&&!pr(y)&&S.includes("@list")&&(y={"@list":Fe(y)}),S.includes("@graph")&&!S.some(I=>I==="@id"||I==="@index")){if(y=Fe(y),a.isFrame||(y=y.filter(I=>{const x=Object.keys(I).length;return ma({value:I,count:x,options:a})!==null})),y.length===0)continue;y=y.map(I=>({"@graph":Fe(I)}))}if(v.mappings.has(s)&&v.mappings.get(s).reverse){const I=o["@reverse"]=o["@reverse"]||{};y=Fe(y);for(let x=0;x<y.length;++x){const R=y[x];if(Yr(R)||pr(R))throw new Q('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:y});Ee(I,w,R,{propertyIsArray:!0})}continue}Ee(o,w,y,{propertyIsArray:!0})}}if("@value"in o&&!(o["@type"]==="@json"&&Tn(e,1.1))){if((Ne(g)||Te(g))&&!a.isFrame)throw new Q('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:g})}for(const s of p){const u=Te(r[s])?r[s]:[r[s]];for(const y of u){if(!Ne(y)||Object.keys(y).some(w=>ae(e,w,{vocab:!0},a)==="@value"))throw new Q("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:y});await Sa({activeCtx:e,activeProperty:t,expandedActiveProperty:n,element:y,expandedParent:o,options:a,insideList:i,typeScopedContext:f,typeKey:l})}}}function Ea({activeCtx:e,activeProperty:t,value:n,options:r}){if(n==null)return null;const o=ae(e,t,{vocab:!0},r);if(o==="@id")return ae(e,n,{base:!0},r);if(o==="@type")return ae(e,n,{vocab:!0,base:!0},{...r,typeExpansion:!0});const a=Re(e,t,"@type");if((a==="@id"||o==="@graph")&&he(n)){const l=ae(e,n,{base:!0},r);return l===null&&n.match(Jl)&&r.eventHandler&&Oe({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:t}},options:r}),{"@id":l}}if(a==="@vocab"&&he(n))return{"@id":ae(e,n,{vocab:!0,base:!0},r)};if(Qr(o))return n;const i={};if(a&&!["@id","@vocab","@none"].includes(a))i["@type"]=a;else if(he(n)){const l=Re(e,t,"@language");l!==null&&(i["@language"]=l);const f=Re(e,t,"@direction");f!==null&&(i["@direction"]=f)}return["boolean","number","string"].includes(typeof n)||(n=n.toString()),i["@value"]=n,i}function Vl(e,t,n,r){const o=[],a=Object.keys(t).sort();for(const i of a){const l=ae(e,i,{vocab:!0},r);let f=t[i];Te(f)||(f=[f]);for(const c of f){if(c===null)continue;if(!he(c))throw new Q("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:t});const p={"@value":c};l!=="@none"&&(i.match(_a)||r.eventHandler&&Oe({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:i}},options:r}),p["@language"]=i.toLowerCase()),n&&(p["@direction"]=n),o.push(p)}}return o}async function gr({activeCtx:e,options:t,activeProperty:n,value:r,asGraph:o,indexKey:a,propertyIndex:i}){const l=[],f=Object.keys(r).sort(),c=a==="@type";for(let p of f){if(c){const s=Re(e,p,"@context");Fn(s)||(e=await dn({activeCtx:e,localCtx:s,propagate:!1,options:t}))}let g=r[p];Te(g)||(g=[g]),g=await ut.expand({activeCtx:e,activeProperty:n,element:g,options:t,insideList:!1,insideIndex:!0});let d;i?p==="@none"?d="@none":d=Ea({activeCtx:e,activeProperty:a,value:p,options:t}):d=ae(e,p,{vocab:!0},t),a==="@id"?p=ae(e,p,{base:!0},t):c&&(p=d);for(let s of g){if(o&&!Fl(s)&&(s={"@graph":[s]}),a==="@type")d==="@none"||(s["@type"]?s["@type"]=[p].concat(s["@type"]):s["@type"]=[p]);else{if(Yr(s)&&!["@language","@type","@index"].includes(a))throw new Q(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${a}".`,"jsonld.SyntaxError",{code:"invalid value object",value:s});i?d!=="@none"&&Ee(s,i,d,{propertyIsArray:!0,prependValue:!0}):d!=="@none"&&!(a in s)&&(s[a]=p)}l.push(s)}}return l}const{isKeyword:Ra}=Tt,Be=it,yr=Ae,Ve=$e,Gl=ke,we={};var Gn=we;we.createMergedNodeMap=(e,t)=>{t=t||{};const n=t.issuer||new Ve.IdentifierIssuer("_:b"),r={"@default":{}};return we.createNodeMap(e,r,"@default",n),we.mergeNodeMaps(r)};we.createNodeMap=(e,t,n,r,o,a)=>{if(yr.isArray(e)){for(const c of e)we.createNodeMap(c,t,n,r,void 0,a);return}if(!yr.isObject(e)){a&&a.push(e);return}if(Be.isValue(e)){if("@type"in e){let c=e["@type"];c.indexOf("_:")===0&&(e["@type"]=c=r.getId(c))}a&&a.push(e);return}else if(a&&Be.isList(e)){const c=[];we.createNodeMap(e["@list"],t,n,r,o,c),a.push({"@list":c});return}if("@type"in e){const c=e["@type"];for(const p of c)p.indexOf("_:")===0&&r.getId(p)}yr.isUndefined(o)&&(o=Be.isBlankNode(e)?r.getId(e["@id"]):e["@id"]),a&&a.push({"@id":o});const i=t[n],l=i[o]=i[o]||{};l["@id"]=o;const f=Object.keys(e).sort();for(let c of f){if(c==="@id")continue;if(c==="@reverse"){const g={"@id":o},d=e["@reverse"];for(const s in d){const u=d[s];for(const y of u){let w=y["@id"];Be.isBlankNode(y)&&(w=r.getId(w)),we.createNodeMap(y,t,n,r,w),Ve.addValue(i[w],s,g,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if(c==="@graph"){o in t||(t[o]={}),we.createNodeMap(e[c],t,o,r);continue}if(c==="@included"){we.createNodeMap(e[c],t,n,r);continue}if(c!=="@type"&&Ra(c)){if(c==="@index"&&c in l&&(e[c]!==l[c]||e[c]["@id"]!==l[c]["@id"]))throw new Gl("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:l});l[c]=e[c];continue}const p=e[c];if(c.indexOf("_:")===0&&(c=r.getId(c)),p.length===0){Ve.addValue(l,c,[],{propertyIsArray:!0});continue}for(let g of p)if(c==="@type"&&(g=g.indexOf("_:")===0?r.getId(g):g),Be.isSubject(g)||Be.isSubjectReference(g)){if("@id"in g&&!g["@id"])continue;const d=Be.isBlankNode(g)?r.getId(g["@id"]):g["@id"];Ve.addValue(l,c,{"@id":d},{propertyIsArray:!0,allowDuplicate:!1}),we.createNodeMap(g,t,n,r,d)}else if(Be.isValue(g))Ve.addValue(l,c,g,{propertyIsArray:!0,allowDuplicate:!1});else if(Be.isList(g)){const d=[];we.createNodeMap(g["@list"],t,n,r,o,d),g={"@list":d},Ve.addValue(l,c,g,{propertyIsArray:!0,allowDuplicate:!1})}else we.createNodeMap(g,t,n,r,o),Ve.addValue(l,c,g,{propertyIsArray:!0,allowDuplicate:!1})}};we.mergeNodeMapGraphs=e=>{const t={};for(const n of Object.keys(e).sort())for(const r of Object.keys(e[n]).sort()){const o=e[n][r];r in t||(t[r]={"@id":r});const a=t[r];for(const i of Object.keys(o).sort())if(Ra(i)&&i!=="@type")a[i]=Ve.clone(o[i]);else for(const l of o[i])Ve.addValue(a,i,Ve.clone(l),{propertyIsArray:!0,allowDuplicate:!1})}return t};we.mergeNodeMaps=e=>{const t=e["@default"],n=Object.keys(e).sort();for(const r of n){if(r==="@default")continue;const o=e[r];let a=t[r];a?"@graph"in a||(a["@graph"]=[]):t[r]=a={"@id":r,"@graph":[]};const i=a["@graph"];for(const l of Object.keys(o).sort()){const f=o[l];Be.isSubjectReference(f)||i.push(f)}}return t};const{isSubjectReference:ql}=it,{createMergedNodeMap:Cl}=Gn,Ia={};var Xl=Ia;Ia.flatten=e=>{const t=Cl(e),n=[],r=Object.keys(t).sort();for(let o=0;o<r.length;++o){const a=t[r[o]];ql(a)||n.push(a)}return n};const Zr=ke,br=it,on=Ae,{REGEX_BCP47:eo,addValue:to}=$e,{handleEvent:no}=gn,{RDF_LIST:zl,RDF_FIRST:wr,RDF_REST:vr,RDF_NIL:_r,RDF_TYPE:Kl,RDF_JSON_LITERAL:Yl,XSD_BOOLEAN:ro,XSD_DOUBLE:io,XSD_INTEGER:oo,XSD_STRING:mr}=bi,Aa={};var Ql=Aa;Aa.fromRDF=async(e,t)=>{const{useRdfType:n=!1,useNativeTypes:r=!1,rdfDirection:o=null}=t,a={},i={"@default":a},l={};if(o){if(o==="compound-literal")throw new Zr("Unsupported rdfDirection value.","jsonld.InvalidRdfDirection",{value:o});if(o!=="i18n-datatype")throw new Zr("Unknown rdfDirection value.","jsonld.InvalidRdfDirection",{value:o})}for(const p of e){const g=p.graph.termType==="DefaultGraph"?"@default":p.graph.value;g in i||(i[g]={}),g!=="@default"&&!(g in a)&&(a[g]={"@id":g});const d=i[g],s=p.subject.value,u=p.predicate.value,y=p.object;s in d||(d[s]={"@id":s});const w=d[s],v=y.termType.endsWith("Node");if(v&&!(y.value in d)&&(d[y.value]={"@id":y.value}),u===Kl&&!n&&v){to(w,"@type",y.value,{propertyIsArray:!0});continue}const E=Zl(y,r,o,t);if(to(w,u,E,{propertyIsArray:!0}),v)if(y.value===_r){const S=d[y.value];"usages"in S||(S.usages=[]),S.usages.push({node:w,property:u,value:E})}else y.value in l?l[y.value]=!1:l[y.value]={node:w,property:u,value:E}}for(const p in i){const g=i[p];if(!(_r in g))continue;const d=g[_r];if(d.usages){for(let s of d.usages){let u=s.node,y=s.property,w=s.value;const v=[],E=[];let S=Object.keys(u).length;for(;y===vr&&on.isObject(l[u["@id"]])&&on.isArray(u[wr])&&u[wr].length===1&&on.isArray(u[vr])&&u[vr].length===1&&(S===3||S===4&&on.isArray(u["@type"])&&u["@type"].length===1&&u["@type"][0]===zl)&&(v.push(u[wr][0]),E.push(u["@id"]),s=l[u["@id"]],u=s.node,y=s.property,w=s.value,S=Object.keys(u).length,!!br.isBlankNode(u)););delete w["@id"],w["@list"]=v.reverse();for(const I of E)delete g[I]}delete d.usages}}const f=[],c=Object.keys(a).sort();for(const p of c){const g=a[p];if(p in i){const d=g["@graph"]=[],s=i[p],u=Object.keys(s).sort();for(const y of u){const w=s[y];br.isSubjectReference(w)||d.push(w)}}br.isSubjectReference(g)||f.push(g)}return f};function Zl(e,t,n,r){if(e.termType.endsWith("Node"))return{"@id":e.value};const o={"@value":e.value};if(e.language)e.language.match(eo)||r.eventHandler&&no({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e.language}},options:r}),o["@language"]=e.language;else{let a=e.datatype.value;if(a||(a=mr),a===Yl){a="@json";try{o["@value"]=JSON.parse(o["@value"])}catch(i){throw new Zr("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:o["@value"],cause:i})}}if(t){if(a===ro)o["@value"]==="true"?o["@value"]=!0:o["@value"]==="false"&&(o["@value"]=!1);else if(on.isNumeric(o["@value"]))if(a===oo){const i=parseInt(o["@value"],10);i.toFixed(0)===o["@value"]&&(o["@value"]=i)}else a===io&&(o["@value"]=parseFloat(o["@value"]));[ro,oo,io,mr].includes(a)||(o["@type"]=a)}else if(n==="i18n-datatype"&&a.startsWith("https://www.w3.org/ns/i18n#")){const[,i,l]=a.split(/[#_]/);i.length>0&&(o["@language"]=i,i.match(eo)||r.eventHandler&&no({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:i}},options:r})),o["@direction"]=l}else a!==mr&&(o["@type"]=a)}return o}const{createNodeMap:ec}=Gn,{isKeyword:tc}=Tt,ao=it,nc=Bs,so=ke,nn=Ae,rc=$e,{handleEvent:It}=gn,{RDF_FIRST:ic,RDF_REST:oc,RDF_NIL:ac,RDF_TYPE:sc,RDF_JSON_LITERAL:lc,RDF_LANGSTRING:cc,XSD_BOOLEAN:dc,XSD_DOUBLE:lo,XSD_INTEGER:uc,XSD_STRING:fc}=bi,{isAbsolute:Wn}=ht,xa={};var hc=xa;xa.toRDF=(e,t)=>{const n=new rc.IdentifierIssuer("_:b"),r={"@default":{}};ec(e,r,"@default",n);const o=[],a=Object.keys(r).sort();for(const i of a){let l;if(i==="@default")l={termType:"DefaultGraph",value:""};else if(Wn(i))i.startsWith("_:")?l={termType:"BlankNode"}:l={termType:"NamedNode"},l.value=i;else{t.eventHandler&&It({event:{type:["JsonLdEvent"],code:"relative graph reference",level:"warning",message:"Relative graph reference found.",details:{graph:i}},options:t});continue}pc(o,r[i],l,n,t)}return o};function pc(e,t,n,r,o){const a=Object.keys(t).sort();for(const i of a){const l=t[i],f=Object.keys(l).sort();for(let c of f){const p=l[c];if(c==="@type")c=sc;else if(tc(c))continue;for(const g of p){const d={termType:i.startsWith("_:")?"BlankNode":"NamedNode",value:i};if(!Wn(i)){o.eventHandler&&It({event:{type:["JsonLdEvent"],code:"relative subject reference",level:"warning",message:"Relative subject reference found.",details:{subject:i}},options:o});continue}const s={termType:c.startsWith("_:")?"BlankNode":"NamedNode",value:c};if(!Wn(c)){o.eventHandler&&It({event:{type:["JsonLdEvent"],code:"relative predicate reference",level:"warning",message:"Relative predicate reference found.",details:{predicate:c}},options:o});continue}if(s.termType==="BlankNode"&&!o.produceGeneralizedRdf){o.eventHandler&&It({event:{type:["JsonLdEvent"],code:"blank node predicate",level:"warning",message:"Dropping blank node predicate.",details:{property:r.getOldIds().find(y=>r.getId(y)===c)}},options:o});continue}const u=ei(g,r,e,n,o.rdfDirection,o);u&&e.push({subject:d,predicate:s,object:u,graph:n})}}}}function gc(e,t,n,r,o,a){const i={termType:"NamedNode",value:ic},l={termType:"NamedNode",value:oc},f={termType:"NamedNode",value:ac},c=e.pop(),p=c?{termType:"BlankNode",value:t.getId()}:f;let g=p;for(const d of e){const s=ei(d,t,n,r,o,a),u={termType:"BlankNode",value:t.getId()};n.push({subject:g,predicate:i,object:s,graph:r}),n.push({subject:g,predicate:l,object:u,graph:r}),g=u}if(c){const d=ei(c,t,n,r,o,a);n.push({subject:g,predicate:i,object:d,graph:r}),n.push({subject:g,predicate:l,object:f,graph:r})}return p}function ei(e,t,n,r,o,a){const i={};if(ao.isValue(e)){i.termType="Literal",i.value=void 0,i.datatype={termType:"NamedNode"};let l=e["@value"];const f=e["@type"]||null;if(f==="@json")i.value=nc(l),i.datatype.value=lc;else if(nn.isBoolean(l))i.value=l.toString(),i.datatype.value=f||dc;else if(nn.isDouble(l)||f===lo)nn.isDouble(l)||(l=parseFloat(l)),i.value=l.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),i.datatype.value=f||lo;else if(nn.isNumber(l))i.value=l.toFixed(0),i.datatype.value=f||uc;else if("@direction"in e&&o==="i18n-datatype"){const c=(e["@language"]||"").toLowerCase(),p=e["@direction"],g=`https://www.w3.org/ns/i18n#${c}_${p}`;i.datatype.value=g,i.value=l}else{if("@direction"in e&&o==="compound-literal")throw new so("Unsupported rdfDirection value.","jsonld.InvalidRdfDirection",{value:o});if("@direction"in e&&o)throw new so("Unknown rdfDirection value.","jsonld.InvalidRdfDirection",{value:o});"@language"in e?("@direction"in e&&!o&&a.eventHandler&&It({event:{type:["JsonLdEvent"],code:"rdfDirection not set",level:"warning",message:"rdfDirection not set for @direction.",details:{object:i.value}},options:a}),i.value=l,i.datatype.value=f||cc,i.language=e["@language"]):("@direction"in e&&!o&&a.eventHandler&&It({event:{type:["JsonLdEvent"],code:"rdfDirection not set",level:"warning",message:"rdfDirection not set for @direction.",details:{object:i.value}},options:a}),i.value=l,i.datatype.value=f||fc)}}else if(ao.isList(e)){const l=gc(e["@list"],t,n,r,o,a);i.termType=l.termType,i.value=l.value}else{const l=nn.isObject(e)?e["@id"]:e;i.termType=l.startsWith("_:")?"BlankNode":"NamedNode",i.value=l}return i.termType==="NamedNode"&&!Wn(i.value)?(a.eventHandler&&It({event:{type:["JsonLdEvent"],code:"relative object reference",level:"warning",message:"Relative object reference found.",details:{object:i.value}},options:a}),null):i}const{isKeyword:ti}=Tt,De=it,q=Ae,de=$e,co=ht,un=ke,{createNodeMap:yc,mergeNodeMapGraphs:bc}=Gn,Le={};var wc=Le;Le.frameMergedOrDefault=(e,t,n)=>{const r={options:n,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},o=new de.IdentifierIssuer("_:b");yc(e,r.graphMap,"@default",o),n.merged&&(r.graphMap["@merged"]=bc(r.graphMap),r.graph="@merged"),r.subjects=r.graphMap[r.graph];const a=[];Le.frame(r,Object.keys(r.subjects).sort(),t,a),n.pruneBlankNodeIdentifiers&&(n.bnodesToClear=Object.keys(r.bnodeMap).filter(i=>r.bnodeMap[i].length===1));// remove @preserve from results
return n.link={},kn(a,n)};Le.frame=(e,t,n,r,o=null)=>{Na(n),n=n[0];const a=e.options,i={embed:mn(n,a,"embed"),explicit:mn(n,a,"explicit"),requireAll:mn(n,a,"requireAll")};e.link.hasOwnProperty(e.graph)||(e.link[e.graph]={});const l=e.link[e.graph],f=_c(e,t,n,i),c=Object.keys(f).sort();for(const p of c){const g=f[p];if(o===null?e.uniqueEmbeds={[e.graph]:{}}:e.uniqueEmbeds[e.graph]=e.uniqueEmbeds[e.graph]||{},i.embed==="@link"&&p in l){bt(r,o,l[p]);continue}const d={"@id":p};if(p.indexOf("_:")===0&&de.addValue(e.bnodeMap,p,d,{propertyIsArray:!0}),l[p]=d,(i.embed==="@first"||i.embed==="@last")&&e.is11)throw new un("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:n});if(!(!e.embedded&&e.uniqueEmbeds[e.graph].hasOwnProperty(p))){if(e.embedded&&(i.embed==="@never"||vc(g,e.graph,e.subjectStack))){bt(r,o,d);continue}if(e.embedded&&(i.embed=="@first"||i.embed=="@once")&&e.uniqueEmbeds[e.graph].hasOwnProperty(p)){bt(r,o,d);continue}if(i.embed==="@last"&&p in e.uniqueEmbeds[e.graph]&&mc(e,p),e.uniqueEmbeds[e.graph][p]={parent:r,property:o},e.subjectStack.push({subject:g,graph:e.graph}),p in e.graphMap){let s=!1,u=null;"@graph"in n?(u=n["@graph"][0],s=!(p==="@merged"||p==="@default"),q.isObject(u)||(u={})):(s=e.graph!=="@merged",u={}),s&&Le.frame({...e,graph:p,embedded:!1},Object.keys(e.graphMap[p]).sort(),[u],d,"@graph")}"@included"in n&&Le.frame({...e,embedded:!1},t,n["@included"],d,"@included");for(const s of Object.keys(g).sort()){if(ti(s)){if(d[s]=de.clone(g[s]),s==="@type")for(const u of g["@type"])u.indexOf("_:")===0&&de.addValue(e.bnodeMap,u,d,{propertyIsArray:!0});continue}if(!(i.explicit&&!(s in n)))for(const u of g[s]){const y=s in n?n[s]:uo(i);if(De.isList(u)){const w=n[s]&&n[s][0]&&n[s][0]["@list"]?n[s][0]["@list"]:uo(i),v={"@list":[]};bt(d,s,v);const E=u["@list"];for(const S of E)De.isSubjectReference(S)?Le.frame({...e,embedded:!0},[S["@id"]],w,v,"@list"):bt(v,"@list",de.clone(S))}else De.isSubjectReference(u)?Le.frame({...e,embedded:!0},[u["@id"]],y,d,s):ni(y[0],u)&&bt(d,s,de.clone(u))}}for(const s of Object.keys(n).sort()){if(s==="@type"){if(!q.isObject(n[s][0])||!("@default"in n[s][0]))continue}else if(ti(s))continue;const u=n[s][0]||{};if(!mn(u,a,"omitDefault")&&!(s in d)){let w="@null";"@default"in u&&(w=de.clone(u["@default"])),q.isArray(w)||(w=[w]),d[s]=[{"@preserve":w}]}}for(const s of Object.keys(n["@reverse"]||{}).sort()){const u=n["@reverse"][s];for(const y of Object.keys(e.subjects))de.getValues(e.subjects[y],s).some(v=>v["@id"]===p)&&(d["@reverse"]=d["@reverse"]||{},de.addValue(d["@reverse"],s,[],{propertyIsArray:!0}),Le.frame({...e,embedded:!0},[y],u,d["@reverse"][s],o))}bt(r,o,d),e.subjectStack.pop()}}};Le.cleanupNull=(e,t)=>{if(q.isArray(e))return e.map(r=>Le.cleanupNull(r,t)).filter(r=>r);if(e==="@null")return null;if(q.isObject(e)){if("@id"in e){const n=e["@id"];if(t.link.hasOwnProperty(n)){const r=t.link[n].indexOf(e);if(r!==-1)return t.link[n][r];t.link[n].push(e)}else t.link[n]=[e]}for(const n in e)e[n]=Le.cleanupNull(e[n],t)}return e};function uo(e){const t={};for(const n in e)e[n]!==void 0&&(t["@"+n]=[e[n]]);return[t]}function vc(e,t,n){for(let r=n.length-1;r>=0;--r){const o=n[r];if(o.graph===t&&o.subject["@id"]===e["@id"])return!0}return!1}function mn(e,t,n){const r="@"+n;let o=r in e?e[r][0]:t[n];if(n==="embed"){if(o===!0)o="@once";else if(o===!1)o="@never";else if(o!=="@always"&&o!=="@never"&&o!=="@link"&&o!=="@first"&&o!=="@last"&&o!=="@once")throw new un("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:e})}return o}function Na(e){if(!q.isArray(e)||e.length!==1||!q.isObject(e[0]))throw new un("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e});if("@id"in e[0]){for(const t of de.asArray(e[0]["@id"]))if(!(q.isObject(t)||co.isAbsolute(t))||q.isString(t)&&t.indexOf("_:")===0)throw new un("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e})}if("@type"in e[0]){for(const t of de.asArray(e[0]["@type"]))if(!(q.isObject(t)||co.isAbsolute(t)||t==="@json")||q.isString(t)&&t.indexOf("_:")===0)throw new un("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e})}}function _c(e,t,n,r){const o={};for(const a of t){const i=e.graphMap[e.graph][a];Da(e,i,n,r)&&(o[a]=i)}return o}function Da(e,t,n,r){let o=!0,a=!1;for(const i in n){let l=!1;const f=de.getValues(t,i),c=de.getValues(n,i).length===0;if(i==="@id"){if(q.isEmptyObject(n["@id"][0]||{})?l=!0:n["@id"].length>=0&&(l=n["@id"].includes(f[0])),!r.requireAll)return l}else if(i==="@type"){if(o=!1,c){if(f.length>0)return!1;l=!0}else if(n["@type"].length===1&&q.isEmptyObject(n["@type"][0]))l=f.length>0;else for(const p of n["@type"])q.isObject(p)&&"@default"in p?l=!0:l=l||f.some(g=>g===p);if(!r.requireAll)return l}else{if(ti(i))continue;{const p=de.getValues(n,i)[0];let g=!1;if(p&&(Na([p]),g="@default"in p),o=!1,f.length===0&&g)continue;if(f.length>0&&c)return!1;if(p===void 0){if(f.length>0)return!1;l=!0}else if(De.isList(p)){const d=p["@list"][0];if(De.isList(f[0])){const s=f[0]["@list"];De.isValue(d)?l=s.some(u=>ni(d,u)):(De.isSubject(d)||De.isSubjectReference(d))&&(l=s.some(u=>fo(e,d,u,r)))}}else De.isValue(p)?l=f.some(d=>ni(p,d)):De.isSubjectReference(p)?l=f.some(d=>fo(e,p,d,r)):q.isObject(p)?l=f.length>0:l=!1}}if(!l&&r.requireAll)return!1;a=a||l}return o||a}function mc(e,t){const n=e.uniqueEmbeds[e.graph],r=n[t],o=r.parent,a=r.property,i={"@id":t};if(q.isArray(o)){for(let f=0;f<o.length;++f)if(de.compareValues(o[f],i)){o[f]=i;break}}else{const f=q.isArray(o[a]);de.removeValue(o,a,i,{propertyIsArray:f}),de.addValue(o,a,i,{propertyIsArray:f})}const l=f=>{const c=Object.keys(n);for(const p of c)p in n&&q.isObject(n[p].parent)&&n[p].parent["@id"]===f&&(delete n[p],l(p))};l(t)}/**
 * Removes the @preserve keywords from expanded result of framing.
 *
 * @param input the framed, framed output.
 * @param options the framing options used.
 *
 * @return the resulting output.
 */function kn(e,t){if(q.isArray(e))return e.map(n=>kn(n,t));if(q.isObject(e)){// remove @preserve
if("@preserve"in e)return e["@preserve"][0];if(De.isValue(e))return e;if(De.isList(e))return e["@list"]=kn(e["@list"],t),e;if("@id"in e){const n=e["@id"];if(t.link.hasOwnProperty(n)){const r=t.link[n].indexOf(e);if(r!==-1)return t.link[n][r];t.link[n].push(e)}else t.link[n]=[e]}for(const n in e){if(n==="@id"&&t.bnodesToClear.includes(e[n])){delete e["@id"];continue}e[n]=kn(e[n],t)}}return e}function bt(e,t,n){q.isObject(e)?de.addValue(e,t,n,{propertyIsArray:!0}):e.push(n)}function fo(e,t,n,r){if(!("@id"in n))return!1;const o=e.subjects[n["@id"]];return o&&Da(e,o,t,r)}function ni(e,t){const n=t["@value"],r=t["@type"],o=t["@language"],a=e["@value"]?q.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],i=e["@type"]?q.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],l=e["@language"]?q.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return a.length===0&&i.length===0&&l.length===0?!0:!(!(a.includes(n)||q.isEmptyObject(a[0]))||!(!r&&i.length===0||i.includes(r)||r&&q.isEmptyObject(i[0]))||!(!o&&l.length===0||l.includes(o)||o&&q.isEmptyObject(l[0])))}const _i=ke,{isArray:st,isObject:ft,isString:Oa,isUndefined:Sr}=Ae,{isList:ri,isValue:et,isGraph:La,isSimpleGraph:ho,isSubjectReference:Er}=it,{expandIri:Ta,getContextValue:be,isKeyword:ja,process:Rr,processingMode:Sc}=Tt,{removeBase:po,prependBase:Ec}=ht,{REGEX_KEYWORD:Rc,addValue:Se,asArray:Sn,compareShortestLeast:Ic}=$e,W={};var Ac=W;W.compact=async({activeCtx:e,activeProperty:t=null,element:n,options:r={}})=>{if(st(n)){let a=[];for(let i=0;i<n.length;++i){const l=await W.compact({activeCtx:e,activeProperty:t,element:n[i],options:r});l!==null&&a.push(l)}return r.compactArrays&&a.length===1&&(be(e,t,"@container")||[]).length===0&&(a=a[0]),a}const o=be(e,t,"@context");if(Sr(o)||(e=await Rr({activeCtx:e,localCtx:o,propagate:!0,overrideProtected:!0,options:r})),ft(n)){if(r.link&&"@id"in n&&r.link.hasOwnProperty(n["@id"])){const d=r.link[n["@id"]];for(let s=0;s<d.length;++s)if(d[s].expanded===n)return d[s].compacted}if(et(n)||Er(n)){const d=W.compactValue({activeCtx:e,activeProperty:t,value:n,options:r});return r.link&&Er(n)&&(r.link.hasOwnProperty(n["@id"])||(r.link[n["@id"]]=[]),r.link[n["@id"]].push({expanded:n,compacted:d})),d}if(ri(n)&&(be(e,t,"@container")||[]).includes("@list"))return W.compact({activeCtx:e,activeProperty:t,element:n["@list"],options:r});const a=t==="@reverse",i={},l=e;!et(n)&&!Er(n)&&(e=e.revertToPreviousContext());const f=be(l,t,"@context");Sr(f)||(e=await Rr({activeCtx:e,localCtx:f,propagate:!0,overrideProtected:!0,options:r})),r.link&&"@id"in n&&(r.link.hasOwnProperty(n["@id"])||(r.link[n["@id"]]=[]),r.link[n["@id"]].push({expanded:n,compacted:i}));let c=n["@type"]||[];c.length>1&&(c=Array.from(c).sort());const p=e;for(const d of c){const s=W.compactIri({activeCtx:p,iri:d,relativeTo:{vocab:!0}}),u=be(l,s,"@context");Sr(u)||(e=await Rr({activeCtx:e,localCtx:u,options:r,propagate:!1}))}const g=Object.keys(n).sort();for(const d of g){const s=n[d];if(d==="@id"){let u=Sn(s).map(w=>W.compactIri({activeCtx:e,iri:w,relativeTo:{vocab:!1},base:r.base}));u.length===1&&(u=u[0]);const y=W.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}});i[y]=u;continue}if(d==="@type"){let u=Sn(s).map(S=>W.compactIri({activeCtx:l,iri:S,relativeTo:{vocab:!0}}));u.length===1&&(u=u[0]);const y=W.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}}),E=(be(e,y,"@container")||[]).includes("@set")&&Sc(e,1.1)||st(u)&&s.length===0;Se(i,y,u,{propertyIsArray:E});continue}if(d==="@reverse"){const u=await W.compact({activeCtx:e,activeProperty:"@reverse",element:s,options:r});for(const y in u)if(e.mappings.has(y)&&e.mappings.get(y).reverse){const w=u[y],E=(be(e,y,"@container")||[]).includes("@set")||!r.compactArrays;Se(i,y,w,{propertyIsArray:E}),delete u[y]}if(Object.keys(u).length>0){const y=W.compactIri({activeCtx:e,iri:d,relativeTo:{vocab:!0}});Se(i,y,u)}continue}if(d==="@preserve"){const u=await W.compact({activeCtx:e,activeProperty:t,element:s,options:r});st(u)&&u.length===0||Se(i,d,u);continue}if(d==="@index"){if((be(e,t,"@container")||[]).includes("@index"))continue;const y=W.compactIri({activeCtx:e,iri:d,relativeTo:{vocab:!0}});Se(i,y,s);continue}if(d!=="@graph"&&d!=="@list"&&d!=="@included"&&ja(d)){const u=W.compactIri({activeCtx:e,iri:d,relativeTo:{vocab:!0}});Se(i,u,s);continue}if(!st(s))throw new _i("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(s.length===0){const u=W.compactIri({activeCtx:e,iri:d,value:s,relativeTo:{vocab:!0},reverse:a}),y=e.mappings.has(u)?e.mappings.get(u)["@nest"]:null;let w=i;y&&(go(e,y,r),ft(i[y])||(i[y]={}),w=i[y]),Se(w,u,s,{propertyIsArray:!0})}for(const u of s){const y=W.compactIri({activeCtx:e,iri:d,value:u,relativeTo:{vocab:!0},reverse:a}),w=e.mappings.has(y)?e.mappings.get(y)["@nest"]:null;let v=i;w&&(go(e,w,r),ft(i[w])||(i[w]={}),v=i[w]);const E=be(e,y,"@container")||[],S=La(u),I=ri(u);let x;I?x=u["@list"]:S&&(x=u["@graph"]);let R=await W.compact({activeCtx:e,activeProperty:y,element:I||S?x:u,options:r});if(I)if(st(R)||(R=[R]),!E.includes("@list"))R={[W.compactIri({activeCtx:e,iri:"@list",relativeTo:{vocab:!0}})]:R},"@index"in u&&(R[W.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=u["@index"]);else{Se(v,y,R,{valueIsArray:!0,allowDuplicate:!0});continue}if(S)if(E.includes("@graph")&&(E.includes("@id")||E.includes("@index")&&ho(u))){let V;v.hasOwnProperty(y)?V=v[y]:v[y]=V={};const k=(E.includes("@id")?u["@id"]:u["@index"])||W.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}});Se(V,k,R,{propertyIsArray:!r.compactArrays||E.includes("@set")})}else E.includes("@graph")&&ho(u)?(st(R)&&R.length>1&&(R={"@included":R}),Se(v,y,R,{propertyIsArray:!r.compactArrays||E.includes("@set")})):(st(R)&&R.length===1&&r.compactArrays&&(R=R[0]),R={[W.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}})]:R},"@id"in u&&(R[W.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]=u["@id"]),"@index"in u&&(R[W.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=u["@index"]),Se(v,y,R,{propertyIsArray:!r.compactArrays||E.includes("@set")}));else if(E.includes("@language")||E.includes("@index")||E.includes("@id")||E.includes("@type")){let V;v.hasOwnProperty(y)?V=v[y]:v[y]=V={};let k;if(E.includes("@language"))et(R)&&(R=R["@value"]),k=u["@language"];else if(E.includes("@index")){const F=be(e,y,"@index")||"@index",ne=W.compactIri({activeCtx:e,iri:F,relativeTo:{vocab:!0}});if(F==="@index")k=u["@index"],delete R[ne];else{let se;if([k,...se]=Sn(R[F]||[]),!Oa(k))k=null;else switch(se.length){case 0:delete R[F];break;case 1:R[F]=se[0];break;default:R[F]=se;break}}}else if(E.includes("@id")){const F=W.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}});k=R[F],delete R[F]}else if(E.includes("@type")){const F=W.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}});let ne;switch([k,...ne]=Sn(R[F]||[]),ne.length){case 0:delete R[F];break;case 1:R[F]=ne[0];break;default:R[F]=ne;break}Object.keys(R).length===1&&"@id"in u&&(R=await W.compact({activeCtx:e,activeProperty:y,element:{"@id":u["@id"]},options:r}))}k||(k=W.compactIri({activeCtx:e,iri:"@none",relativeTo:{vocab:!0}})),Se(V,k,R,{propertyIsArray:E.includes("@set")})}else{const V=!r.compactArrays||E.includes("@set")||E.includes("@list")||st(R)&&R.length===0||d==="@list"||d==="@graph";Se(v,y,R,{propertyIsArray:V})}}}return i}return n};W.compactIri=({activeCtx:e,iri:t,value:n=null,relativeTo:r={vocab:!1},reverse:o=!1,base:a=null})=>{if(t===null)return t;e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext);const i=e.getInverse();if(ja(t)&&t in i&&"@none"in i[t]&&"@type"in i[t]["@none"]&&"@none"in i[t]["@none"]["@type"])return i[t]["@none"]["@type"]["@none"];if(r.vocab&&t in i){const g=e["@language"]||"@none",d=[];ft(n)&&"@index"in n&&!("@graph"in n)&&d.push("@index","@index@set"),ft(n)&&"@preserve"in n&&(n=n["@preserve"][0]),La(n)?("@index"in n&&d.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n&&d.push("@graph@id","@graph@id@set"),d.push("@graph","@graph@set","@set"),"@index"in n||d.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in n||d.push("@graph@id","@graph@id@set")):ft(n)&&!et(n)&&d.push("@id","@id@set","@type","@set@type");let s="@language",u="@null";if(o)s="@type",u="@reverse",d.push("@set");else if(ri(n)){"@index"in n||d.push("@list");const w=n["@list"];if(w.length===0)s="@any",u="@none";else{let v=w.length===0?g:null,E=null;for(let S=0;S<w.length;++S){const I=w[S];let x="@none",R="@none";if(et(I))if("@direction"in I){const V=(I["@language"]||"").toLowerCase(),k=I["@direction"];x=`${V}_${k}`}else"@language"in I?x=I["@language"].toLowerCase():"@type"in I?R=I["@type"]:x="@null";else R="@id";if(v===null?v=x:x!==v&&et(I)&&(v="@none"),E===null?E=R:R!==E&&(E="@none"),v==="@none"&&E==="@none")break}v=v||"@none",E=E||"@none",E!=="@none"?(s="@type",u=E):u=v}}else{if(et(n))if("@language"in n&&!("@index"in n)){d.push("@language","@language@set"),u=n["@language"];const w=n["@direction"];w&&(u=`${u}_${w}`)}else"@direction"in n&&!("@index"in n)?u=`_${n["@direction"]}`:"@type"in n&&(s="@type",u=n["@type"]);else s="@type",u="@id";d.push("@set")}d.push("@none"),ft(n)&&!("@index"in n)&&d.push("@index","@index@set"),et(n)&&Object.keys(n).length===1&&d.push("@language","@language@set");const y=xc(e,t,n,d,s,u);if(y!==null)return y}if(r.vocab&&"@vocab"in e){const g=e["@vocab"];if(t.indexOf(g)===0&&t!==g){const d=t.substr(g.length);if(!e.mappings.has(d))return d}}let l=null;const f=[];let c=e.fastCurieMap;const p=t.length-1;for(let g=0;g<p&&t[g]in c;++g)c=c[t[g]],""in c&&f.push(c[""][0]);for(let g=f.length-1;g>=0;--g){const d=f[g],s=d.terms;for(const u of s){const y=u+":"+t.substr(d.iri.length);e.mappings.get(u)._prefix&&(!e.mappings.has(y)||n===null&&e.mappings.get(y)["@id"]===t)&&(l===null||Ic(y,l)<0)&&(l=y)}}if(l!==null)return l;for(const[g,d]of e.mappings)if(d&&d._prefix&&t.startsWith(g+":"))throw new _i(`Absolute IRI "${t}" confused with prefix "${g}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:e});if(!r.vocab)if("@base"in e)if(e["@base"]){const g=po(Ec(a,e["@base"]),t);return Rc.test(g)?`./${g}`:g}else return t;else return po(a,t);return t};W.compactValue=({activeCtx:e,activeProperty:t,value:n,options:r})=>{if(et(n)){const l=be(e,t,"@type"),f=be(e,t,"@language"),c=be(e,t,"@direction"),p=be(e,t,"@container")||[],g="@index"in n&&!p.includes("@index");if(!g&&l!=="@none"&&(n["@type"]===l||"@language"in n&&n["@language"]===f&&"@direction"in n&&n["@direction"]===c||"@language"in n&&n["@language"]===f||"@direction"in n&&n["@direction"]===c))return n["@value"];const d=Object.keys(n).length,s=d===1||d===2&&"@index"in n&&!g,u="@language"in e,y=Oa(n["@value"]),w=e.mappings.has(t)&&e.mappings.get(t)["@language"]===null;if(s&&l!=="@none"&&(!u||!y||w))return n["@value"];const v={};return g&&(v[W.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=n["@index"]),"@type"in n?v[W.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}})]=W.compactIri({activeCtx:e,iri:n["@type"],relativeTo:{vocab:!0}}):"@language"in n&&(v[W.compactIri({activeCtx:e,iri:"@language",relativeTo:{vocab:!0}})]=n["@language"]),"@direction"in n&&(v[W.compactIri({activeCtx:e,iri:"@direction",relativeTo:{vocab:!0}})]=n["@direction"]),v[W.compactIri({activeCtx:e,iri:"@value",relativeTo:{vocab:!0}})]=n["@value"],v}const o=Ta(e,t,{vocab:!0},r),a=be(e,t,"@type"),i=W.compactIri({activeCtx:e,iri:n["@id"],relativeTo:{vocab:a==="@vocab"},base:r.base});return a==="@id"||a==="@vocab"||o==="@graph"?i:{[W.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]:i}};function xc(e,t,n,r,o,a){a===null&&(a="@null");const i=[];if((a==="@id"||a==="@reverse")&&ft(n)&&"@id"in n){a==="@reverse"&&i.push("@reverse");const f=W.compactIri({activeCtx:e,iri:n["@id"],relativeTo:{vocab:!0}});e.mappings.has(f)&&e.mappings.get(f)&&e.mappings.get(f)["@id"]===n["@id"]?i.push.apply(i,["@vocab","@id"]):i.push.apply(i,["@id","@vocab"])}else{i.push(a);const f=i.find(c=>c.includes("_"));f&&i.push(f.replace(/^[^_]+_/,"_"))}i.push("@none");const l=e.inverse[t];for(const f of r){if(!(f in l))continue;const c=l[f][o];for(const p of i)if(p in c)return c[p]}return null}function go(e,t,n){if(Ta(e,t,{vocab:!0},n)!=="@nest")throw new _i("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}var Ir,yo;function Nc(){return yo||(yo=1,Ir=e=>{class t{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(n,r){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(n,r)},t.expand=function(n){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(n)},t.flatten=function(n){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(n)},t}),Ir}/**
 * A JavaScript implementation of the JSON-LD API.
 *
 * @author Dave Longley
 *
 * @license BSD 3-Clause License
 * Copyright (c) 2011-2022 Digital Bazaar, Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * Redistributions of source code must retain the above copyright notice,
 * this list of conditions and the following disclaimer.
 *
 * Redistributions in binary form must reproduce the above copyright
 * notice, this list of conditions and the following disclaimer in the
 * documentation and/or other materials provided with the distribution.
 *
 * Neither the name of the Digital Bazaar, Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
 * PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
 * TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */const bo=yi,wo=gl,lt=$e,Ye=Nl,Ar=lt.IdentifierIssuer,Ue=ke,Dc=ga,En=Ol,{expand:Oc}=Bl,{flatten:Lc}=Xl,{fromRDF:Tc}=Ql,{toRDF:jc}=hc,{frameMergedOrDefault:kc,cleanupNull:$c}=wc,{isArray:Ut,isObject:wt,isString:He}=Ae,{isSubjectReference:Mc}=it,{expandIri:Pc,getInitialContext:Rn,process:vo,processingMode:xr}=Tt,{compact:Fc,compactIri:Wc}=Ac,{createNodeMap:Jc,createMergedNodeMap:Uc,mergeNodeMaps:Hc}=Gn,{logEventHandler:Bc,logWarningEventHandler:Vc,safeEventHandler:Gc,setDefaultEventHandler:qc,setupEventHandler:Cc,strictEventHandler:Xc,unhandledEventHandler:zc}=gn,ka=function(e){const t={},r=new Dc({max:100});e.compact=async function(a,i,l){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(i===null)throw new Ue("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(a===null)return null;l=o(l,{base:He(a)?a:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new Ar("_:b"),contextResolver:new Ye({sharedCache:r})}),l.link&&(l.skipExpansion=!0),l.compactToRelative||delete l.base;let f;l.skipExpansion?f=a:f=await e.expand(a,l);const c=await e.processContext(Rn(l),i,l);let p=await Fc({activeCtx:c,element:f,options:l});l.compactArrays&&!l.graph&&Ut(p)?p.length===1?p=p[0]:p.length===0&&(p={}):l.graph&&wt(p)&&(p=[p]),wt(i)&&"@context"in i&&(i=i["@context"]),i=lt.clone(i),Ut(i)||(i=[i]);const g=i;i=[];for(let s=0;s<g.length;++s)(!wt(g[s])||Object.keys(g[s]).length>0)&&i.push(g[s]);const d=i.length>0;if(i.length===1&&(i=i[0]),Ut(p)){const s=Wc({activeCtx:c,iri:"@graph",relativeTo:{vocab:!0}}),u=p;p={},d&&(p["@context"]=i),p[s]=u}else if(wt(p)&&d){const s=p;p={"@context":i};for(const u in s)p[u]=s[u]}return p},e.expand=async function(a,i){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");i=o(i,{keepFreeFloatingNodes:!1,contextResolver:new Ye({sharedCache:r})});const l={},f=[];if("expandContext"in i){const d=lt.clone(i.expandContext);wt(d)&&"@context"in d?l.expandContext=d:l.expandContext={"@context":d},f.push(l.expandContext)}let c;if(!He(a))l.input=lt.clone(a);else{const d=await e.get(a,i);c=d.documentUrl,l.input=d.document,d.contextUrl&&(l.remoteContext={"@context":d.contextUrl},f.push(l.remoteContext))}"base"in i||(i.base=c||"");let p=Rn(i);for(const d of f)p=await vo({activeCtx:p,localCtx:d,options:i});let g=await Oc({activeCtx:p,element:l.input,options:i});return wt(g)&&"@graph"in g&&Object.keys(g).length===1?g=g["@graph"]:g===null&&(g=[]),Ut(g)||(g=[g]),g},e.flatten=async function(a,i,l){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");typeof i=="function"?i=null:i=i||null,l=o(l,{base:He(a)?a:"",contextResolver:new Ye({sharedCache:r})});const f=await e.expand(a,l),c=Lc(f);return i===null?c:(l.graph=!0,l.skipExpansion=!0,await e.compact(c,i,l))},e.frame=async function(a,i,l){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(l=o(l,{base:He(a)?a:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new Ye({sharedCache:r})}),He(i)){const w=await e.get(i,l);if(i=w.document,w.contextUrl){let v=i["@context"];v?Ut(v)?v.push(w.contextUrl):v=[v,w.contextUrl]:v=w.contextUrl,i["@context"]=v}}const f=i?i["@context"]||{}:{},c=await e.processContext(Rn(l),f,l);l.hasOwnProperty("omitGraph")||(l.omitGraph=xr(c,1.1)),l.hasOwnProperty("pruneBlankNodeIdentifiers")||(l.pruneBlankNodeIdentifiers=xr(c,1.1));const p=await e.expand(a,l),g={...l};g.isFrame=!0,g.keepFreeFloatingNodes=!0;const d=await e.expand(i,g),s=Object.keys(i).map(w=>Pc(c,w,{vocab:!0}));g.merged=!s.includes("@graph"),g.is11=xr(c,1.1);const u=kc(p,d,g);g.graph=!l.omitGraph,g.skipExpansion=!0,g.link={},g.framing=!0;let y=await e.compact(u,f,g);return g.link={},y=$c(y,g),y},e.link=async function(a,i,l){const f={};return i&&(f["@context"]=i),f["@embed"]="@link",e.frame(a,f,l)},e.normalize=e.canonize=async function(a,i){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if(i=o(i,{base:He(a)?a:null,algorithm:"URDNA2015",skipExpansion:!1,safe:!0,contextResolver:new Ye({sharedCache:r})}),"inputFormat"in i){if(i.inputFormat!=="application/n-quads"&&i.inputFormat!=="application/nquads")throw new Ue("Unknown canonicalization input format.","jsonld.CanonizeError");const c=En.parse(a);return bo.canonize(c,i)}const l={...i};delete l.format,l.produceGeneralizedRdf=!1;const f=await e.toRDF(a,l);return bo.canonize(f,i)},e.fromRDF=async function(a,i){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");i=o(i,{format:He(a)?"application/n-quads":void 0});const{format:l}=i;let{rdfParser:f}=i;if(l){if(f=f||t[l],!f)throw new Ue("Unknown input format.","jsonld.UnknownFormat",{format:l})}else f=()=>a;const c=await f(a);return Tc(c,i)},e.toRDF=async function(a,i){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");i=o(i,{base:He(a)?a:"",skipExpansion:!1,contextResolver:new Ye({sharedCache:r})});let l;i.skipExpansion?l=a:l=await e.expand(a,i);const f=jc(l,i);if(i.format){if(i.format==="application/n-quads"||i.format==="application/nquads")return En.serialize(f);throw new Ue("Unknown output format.","jsonld.UnknownFormat",{format:i.format})}return f},e.createNodeMap=async function(a,i){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");i=o(i,{base:He(a)?a:"",contextResolver:new Ye({sharedCache:r})});const l=await e.expand(a,i);return Uc(l,i)},e.merge=async function(a,i,l){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!Ut(a))throw new TypeError('Could not merge, "docs" must be an array.');typeof i=="function"?i=null:i=i||null,l=o(l,{contextResolver:new Ye({sharedCache:r})});const f=await Promise.all(a.map(w=>{const v={...l};return e.expand(w,v)}));let c=!0;"mergeNodes"in l&&(c=l.mergeNodes);const p=l.issuer||new Ar("_:b"),g={"@default":{}};for(let w=0;w<f.length;++w){const v=lt.relabelBlankNodes(f[w],{issuer:new Ar("_:b"+w+"-")}),E=c||w===0?g:{"@default":{}};if(Jc(v,E,"@default",p),E!==g)for(const S in E){const I=E[S];if(!(S in g)){g[S]=I;continue}const x=g[S];for(const R in I)R in x||(x[R]=I[R])}}const d=Hc(g),s=[],u=Object.keys(d).sort();for(let w=0;w<u.length;++w){const v=d[u[w]];Mc(v)||s.push(v)}return i===null?s:(l.graph=!0,l.skipExpansion=!0,await e.compact(s,i,l))},Object.defineProperty(e,"documentLoader",{get:()=>e._documentLoader,set:a=>e._documentLoader=a}),e.documentLoader=async a=>{throw new Ue("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:a})},e.get=async function(a,i){let l;typeof i.documentLoader=="function"?l=i.documentLoader:l=e.documentLoader;const f=await l(a);try{if(!f.document)throw new Ue("No remote document found at the given URL.","jsonld.NullRemoteDocument");He(f.document)&&(f.document=JSON.parse(f.document))}catch(c){throw new Ue("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:c,remoteDoc:f})}return f},e.processContext=async function(a,i,l){return l=o(l,{base:"",contextResolver:new Ye({sharedCache:r})}),i===null?Rn(l):(i=lt.clone(i),wt(i)&&"@context"in i||(i={"@context":i}),vo({activeCtx:a,localCtx:i,options:l}))},e.getContextValue=Tt.getContextValue,e.documentLoaders={},e.useDocumentLoader=function(a){if(!(a in e.documentLoaders))throw new Ue('Unknown document loader type: "'+a+'"',"jsonld.UnknownDocumentLoader",{type:a});e.documentLoader=e.documentLoaders[a].apply(e,Array.prototype.slice.call(arguments,1))},e.registerRDFParser=function(a,i){t[a]=i},e.unregisterRDFParser=function(a){delete t[a]},e.registerRDFParser("application/n-quads",En.parse),e.registerRDFParser("application/nquads",En.parse),e.url=ht,e.logEventHandler=Bc,e.logWarningEventHandler=Vc,e.safeEventHandler=Gc,e.setDefaultEventHandler=qc,e.strictEventHandler=Xc,e.unhandledEventHandler=zc,e.util=lt,Object.assign(e,lt),e.promises=e,e.RequestQueue=ha(),e.JsonLdProcessor=Nc()(e),wo.setupGlobals(e),wo.setupDocumentLoaders(e);function o(a,{documentLoader:i=e.documentLoader,...l}){if(a&&"compactionMap"in a)throw new Ue('"compactionMap" not supported.',"jsonld.OptionsError");if(a&&"expansionMap"in a)throw new Ue('"expansionMap" not supported.',"jsonld.OptionsError");return Object.assign({},{documentLoader:i},l,a,{eventHandler:Cc({options:a})})}return e},mi=function(){return ka(function(){return mi()})};ka(mi);var Kc=mi;const In=Us(Kc);var $a={exports:{}},Nr={exports:{}},te={ArrayIsArray(e){return Array.isArray(e)},ArrayPrototypeIncludes(e,t){return e.includes(t)},ArrayPrototypeIndexOf(e,t){return e.indexOf(t)},ArrayPrototypeJoin(e,t){return e.join(t)},ArrayPrototypeMap(e,t){return e.map(t)},ArrayPrototypePop(e,t){return e.pop(t)},ArrayPrototypePush(e,t){return e.push(t)},ArrayPrototypeSlice(e,t,n){return e.slice(t,n)},Error,FunctionPrototypeCall(e,t,...n){return e.call(t,...n)},FunctionPrototypeSymbolHasInstance(e,t){return Function.prototype[Symbol.hasInstance].call(e,t)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(e,t){return Object.defineProperties(e,t)},ObjectDefineProperty(e,t,n){return Object.defineProperty(e,t,n)},ObjectGetOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)},ObjectKeys(e){return Object.keys(e)},ObjectSetPrototypeOf(e,t){return Object.setPrototypeOf(e,t)},Promise,PromisePrototypeCatch(e,t){return e.catch(t)},PromisePrototypeThen(e,t,n){return e.then(t,n)},PromiseReject(e){return Promise.reject(e)},PromiseResolve(e){return Promise.resolve(e)},ReflectApply:Reflect.apply,RegExpPrototypeTest(e,t){return e.test(t)},SafeSet:Set,String,StringPrototypeSlice(e,t,n){return e.slice(t,n)},StringPrototypeToLowerCase(e){return e.toLowerCase()},StringPrototypeToUpperCase(e){return e.toUpperCase()},StringPrototypeTrim(e){return e.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(e,t,n){return e.set(t,n)},Boolean,Uint8Array},Ma={exports:{}};(function(e){const t=Ot,{kResistStopPropagation:n,SymbolDispose:r}=te,o=globalThis.AbortSignal||hn().AbortSignal,a=globalThis.AbortController||hn().AbortController,i=Object.getPrototypeOf(async function(){}).constructor,l=globalThis.Blob||t.Blob,f=typeof l<"u"?function(s){return s instanceof l}:function(s){return!1},c=(d,s)=>{if(d!==void 0&&(d===null||typeof d!="object"||!("aborted"in d)))throw new ERR_INVALID_ARG_TYPE(s,"AbortSignal",d)},p=(d,s)=>{if(typeof d!="function")throw new ERR_INVALID_ARG_TYPE(s,"Function",d)};class g extends Error{constructor(s){if(!Array.isArray(s))throw new TypeError(`Expected input to be an Array, got ${typeof s}`);let u="";for(let y=0;y<s.length;y++)u+=`    ${s[y].stack}
`;super(u),this.name="AggregateError",this.errors=s}}e.exports={AggregateError:g,kEmptyObject:Object.freeze({}),once(d){let s=!1;return function(...u){s||(s=!0,d.apply(this,u))}},createDeferredPromise:function(){let d,s;return{promise:new Promise((y,w)=>{d=y,s=w}),resolve:d,reject:s}},promisify(d){return new Promise((s,u)=>{d((y,...w)=>y?u(y):s(...w))})},debuglog(){return function(){}},format(d,...s){return d.replace(/%([sdifj])/g,function(...[u,y]){const w=s.shift();return y==="f"?w.toFixed(6):y==="j"?JSON.stringify(w):y==="s"&&typeof w=="object"?`${w.constructor!==Object?w.constructor.name:""} {}`.trim():w.toString()})},inspect(d){switch(typeof d){case"string":if(d.includes("'"))if(d.includes('"')){if(!d.includes("`")&&!d.includes("${"))return`\`${d}\``}else return`"${d}"`;return`'${d}'`;case"number":return isNaN(d)?"NaN":Object.is(d,-0)?String(d):d;case"bigint":return`${String(d)}n`;case"boolean":case"undefined":return String(d);case"object":return"{}"}},types:{isAsyncFunction(d){return d instanceof i},isArrayBufferView(d){return ArrayBuffer.isView(d)}},isBlob:f,deprecate(d,s){return d},addAbortListener:Bn.addAbortListener||function(s,u){if(s===void 0)throw new ERR_INVALID_ARG_TYPE("signal","AbortSignal",s);c(s,"signal"),p(u,"listener");let y;return s.aborted?queueMicrotask(()=>u()):(s.addEventListener("abort",u,{__proto__:null,once:!0,[n]:!0}),y=()=>{s.removeEventListener("abort",u)}),{__proto__:null,[r](){var w;(w=y)===null||w===void 0||w()}}},AbortSignalAny:o.any||function(s){if(s.length===1)return s[0];const u=new a,y=()=>u.abort();return s.forEach(w=>{c(w,"signals"),w.addEventListener("abort",y,{once:!0})}),u.signal.addEventListener("abort",()=>{s.forEach(w=>w.removeEventListener("abort",y))},{once:!0}),u.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")})(Ma);var ve=Ma.exports,Si={};const{format:Yc,inspect:Jn,AggregateError:Qc}=ve,Zc=globalThis.AggregateError||Qc,ed=Symbol("kIsNodeError"),td=["string","function","number","object","Function","Object","boolean","bigint","symbol"],nd=/^([A-Z][a-z0-9]*)+$/,rd="__node_internal_",qn={};function At(e,t){if(!e)throw new qn.ERR_INTERNAL_ASSERTION(t)}function _o(e){let t="",n=e.length;const r=e[0]==="-"?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function id(e,t,n){if(typeof t=="function")return At(t.length<=n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${t.length}).`),t(...n);const r=(t.match(/%[dfijoOs]/g)||[]).length;return At(r===n.length,`Code: ${e}; The provided arguments length (${n.length}) does not match the required ones (${r}).`),n.length===0?t:Yc(t,...n)}function ue(e,t,n){n||(n=Error);class r extends n{constructor(...a){super(id(e,t,a))}toString(){return`${this.name} [${e}]: ${this.message}`}}Object.defineProperties(r.prototype,{name:{value:n.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${e}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),r.prototype.code=e,r.prototype[ed]=!0,qn[e]=r}function mo(e){const t=rd+e.name;return Object.defineProperty(e,"name",{value:t}),e}function od(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new Zc([t,e],t.message);return n.code=t.code,n}return e||t}let ad=class extends Error{constructor(t="The operation was aborted",n=void 0){if(n!==void 0&&typeof n!="object")throw new qn.ERR_INVALID_ARG_TYPE("options","Object",n);super(t,n),this.code="ABORT_ERR",this.name="AbortError"}};ue("ERR_ASSERTION","%s",Error);ue("ERR_INVALID_ARG_TYPE",(e,t,n)=>{At(typeof e=="string","'name' must be a string"),Array.isArray(t)||(t=[t]);let r="The ";e.endsWith(" argument")?r+=`${e} `:r+=`"${e}" ${e.includes(".")?"property":"argument"} `,r+="must be ";const o=[],a=[],i=[];for(const f of t)At(typeof f=="string","All expected entries have to be of type string"),td.includes(f)?o.push(f.toLowerCase()):nd.test(f)?a.push(f):(At(f!=="object",'The value "object" should be written as "Object"'),i.push(f));if(a.length>0){const f=o.indexOf("object");f!==-1&&(o.splice(o,f,1),a.push("Object"))}if(o.length>0){switch(o.length){case 1:r+=`of type ${o[0]}`;break;case 2:r+=`one of type ${o[0]} or ${o[1]}`;break;default:{const f=o.pop();r+=`one of type ${o.join(", ")}, or ${f}`}}(a.length>0||i.length>0)&&(r+=" or ")}if(a.length>0){switch(a.length){case 1:r+=`an instance of ${a[0]}`;break;case 2:r+=`an instance of ${a[0]} or ${a[1]}`;break;default:{const f=a.pop();r+=`an instance of ${a.join(", ")}, or ${f}`}}i.length>0&&(r+=" or ")}switch(i.length){case 0:break;case 1:i[0].toLowerCase()!==i[0]&&(r+="an "),r+=`${i[0]}`;break;case 2:r+=`one of ${i[0]} or ${i[1]}`;break;default:{const f=i.pop();r+=`one of ${i.join(", ")}, or ${f}`}}if(n==null)r+=`. Received ${n}`;else if(typeof n=="function"&&n.name)r+=`. Received function ${n.name}`;else if(typeof n=="object"){var l;if((l=n.constructor)!==null&&l!==void 0&&l.name)r+=`. Received an instance of ${n.constructor.name}`;else{const f=Jn(n,{depth:-1});r+=`. Received ${f}`}}else{let f=Jn(n,{colors:!1});f.length>25&&(f=`${f.slice(0,25)}...`),r+=`. Received type ${typeof n} (${f})`}return r},TypeError);ue("ERR_INVALID_ARG_VALUE",(e,t,n="is invalid")=>{let r=Jn(t);return r.length>128&&(r=r.slice(0,128)+"..."),`The ${e.includes(".")?"property":"argument"} '${e}' ${n}. Received ${r}`},TypeError);ue("ERR_INVALID_RETURN_VALUE",(e,t,n)=>{var r;const o=n!=null&&(r=n.constructor)!==null&&r!==void 0&&r.name?`instance of ${n.constructor.name}`:`type ${typeof n}`;return`Expected ${e} to be returned from the "${t}" function but got ${o}.`},TypeError);ue("ERR_MISSING_ARGS",(...e)=>{At(e.length>0,"At least one arg needs to be specified");let t;const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map(r=>`"${r}"`).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const r=e.pop();t+=`The ${e.join(", ")}, and ${r} arguments`}break}return`${t} must be specified`},TypeError);ue("ERR_OUT_OF_RANGE",(e,t,n)=>{At(t,'Missing "range" argument');let r;return Number.isInteger(n)&&Math.abs(n)>2**32?r=_o(String(n)):typeof n=="bigint"?(r=String(n),(n>2n**32n||n<-(2n**32n))&&(r=_o(r)),r+="n"):r=Jn(n),`The value of "${e}" is out of range. It must be ${t}. Received ${r}`},RangeError);ue("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);ue("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);ue("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);ue("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);ue("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);ue("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);ue("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);ue("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);ue("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);ue("ERR_STREAM_WRITE_AFTER_END","write after end",Error);ue("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);var me={AbortError:ad,aggregateTwoErrors:mo(od),hideStackFrames:mo,codes:qn};const{ArrayIsArray:Ei,ArrayPrototypeIncludes:Pa,ArrayPrototypeJoin:Fa,ArrayPrototypeMap:sd,NumberIsInteger:Ri,NumberIsNaN:ld,NumberMAX_SAFE_INTEGER:cd,NumberMIN_SAFE_INTEGER:dd,NumberParseInt:ud,ObjectPrototypeHasOwnProperty:fd,RegExpPrototypeExec:Wa,String:hd,StringPrototypeToUpperCase:pd,StringPrototypeTrim:gd}=te,{hideStackFrames:Me,codes:{ERR_SOCKET_BAD_PORT:yd,ERR_INVALID_ARG_TYPE:ye,ERR_INVALID_ARG_VALUE:Xt,ERR_OUT_OF_RANGE:Dt,ERR_UNKNOWN_SIGNAL:So}}=me,{normalizeEncoding:bd}=ve,{isAsyncFunction:wd,isArrayBufferView:vd}=ve.types,Eo={};function _d(e){return e===(e|0)}function md(e){return e===e>>>0}const Sd=/^[0-7]+$/,Ed="must be a 32-bit unsigned integer or an octal string";function Rd(e,t,n){if(typeof e>"u"&&(e=n),typeof e=="string"){if(Wa(Sd,e)===null)throw new Xt(t,e,Ed);e=ud(e,8)}return Ja(e,t),e}const Id=Me((e,t,n=dd,r=cd)=>{if(typeof e!="number")throw new ye(t,"number",e);if(!Ri(e))throw new Dt(t,"an integer",e);if(e<n||e>r)throw new Dt(t,`>= ${n} && <= ${r}`,e)}),Ad=Me((e,t,n=-2147483648,r=2147483647)=>{if(typeof e!="number")throw new ye(t,"number",e);if(!Ri(e))throw new Dt(t,"an integer",e);if(e<n||e>r)throw new Dt(t,`>= ${n} && <= ${r}`,e)}),Ja=Me((e,t,n=!1)=>{if(typeof e!="number")throw new ye(t,"number",e);if(!Ri(e))throw new Dt(t,"an integer",e);const r=n?1:0,o=4294967295;if(e<r||e>o)throw new Dt(t,`>= ${r} && <= ${o}`,e)});function Ii(e,t){if(typeof e!="string")throw new ye(t,"string",e)}function xd(e,t,n=void 0,r){if(typeof e!="number")throw new ye(t,"number",e);if(n!=null&&e<n||r!=null&&e>r||(n!=null||r!=null)&&ld(e))throw new Dt(t,`${n!=null?`>= ${n}`:""}${n!=null&&r!=null?" && ":""}${r!=null?`<= ${r}`:""}`,e)}const Nd=Me((e,t,n)=>{if(!Pa(n,e)){const o="must be one of: "+Fa(sd(n,a=>typeof a=="string"?`'${a}'`:hd(a)),", ");throw new Xt(t,e,o)}});function Ua(e,t){if(typeof e!="boolean")throw new ye(t,"boolean",e)}function Dr(e,t,n){return e==null||!fd(e,t)?n:e[t]}const Dd=Me((e,t,n=null)=>{const r=Dr(n,"allowArray",!1),o=Dr(n,"allowFunction",!1);if(!Dr(n,"nullable",!1)&&e===null||!r&&Ei(e)||typeof e!="object"&&(!o||typeof e!="function"))throw new ye(t,"Object",e)}),Od=Me((e,t)=>{if(e!=null&&typeof e!="object"&&typeof e!="function")throw new ye(t,"a dictionary",e)}),Cn=Me((e,t,n=0)=>{if(!Ei(e))throw new ye(t,"Array",e);if(e.length<n){const r=`must be longer than ${n}`;throw new Xt(t,e,r)}});function Ld(e,t){Cn(e,t);for(let n=0;n<e.length;n++)Ii(e[n],`${t}[${n}]`)}function Td(e,t){Cn(e,t);for(let n=0;n<e.length;n++)Ua(e[n],`${t}[${n}]`)}function jd(e,t){Cn(e,t);for(let n=0;n<e.length;n++){const r=e[n],o=`${t}[${n}]`;if(r==null)throw new ye(o,"AbortSignal",r);Ha(r,o)}}function kd(e,t="signal"){if(Ii(e,t),Eo[e]===void 0)throw Eo[pd(e)]!==void 0?new So(e+" (signals must use all capital letters)"):new So(e)}const $d=Me((e,t="buffer")=>{if(!vd(e))throw new ye(t,["Buffer","TypedArray","DataView"],e)});function Md(e,t){const n=bd(t),r=e.length;if(n==="hex"&&r%2!==0)throw new Xt("encoding",t,`is invalid for data of length ${r}`)}function Pd(e,t="Port",n=!0){if(typeof e!="number"&&typeof e!="string"||typeof e=="string"&&gd(e).length===0||+e!==+e>>>0||e>65535||e===0&&!n)throw new yd(t,e,n);return e|0}const Ha=Me((e,t)=>{if(e!==void 0&&(e===null||typeof e!="object"||!("aborted"in e)))throw new ye(t,"AbortSignal",e)}),Fd=Me((e,t)=>{if(typeof e!="function")throw new ye(t,"Function",e)}),Wd=Me((e,t)=>{if(typeof e!="function"||wd(e))throw new ye(t,"Function",e)}),Jd=Me((e,t)=>{if(e!==void 0)throw new ye(t,"undefined",e)});function Ud(e,t,n){if(!Pa(n,e))throw new ye(t,`('${Fa(n,"|")}')`,e)}const Hd=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function Ro(e,t){if(typeof e>"u"||!Wa(Hd,e))throw new Xt(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function Bd(e){if(typeof e=="string")return Ro(e,"hints"),e;if(Ei(e)){const t=e.length;let n="";if(t===0)return n;for(let r=0;r<t;r++){const o=e[r];Ro(o,"hints"),n+=o,r!==t-1&&(n+=", ")}return n}throw new Xt("hints",e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}var yn={isInt32:_d,isUint32:md,parseFileMode:Rd,validateArray:Cn,validateStringArray:Ld,validateBooleanArray:Td,validateAbortSignalArray:jd,validateBoolean:Ua,validateBuffer:$d,validateDictionary:Od,validateEncoding:Md,validateFunction:Fd,validateInt32:Ad,validateInteger:Id,validateNumber:xd,validateObject:Dd,validateOneOf:Nd,validatePlainFunction:Wd,validatePort:Pd,validateSignalName:kd,validateString:Ii,validateUint32:Ja,validateUndefined:Jd,validateUnion:Ud,validateAbortSignal:Ha,validateLinkHeaderValue:Bd},Ai={exports:{}};const{SymbolAsyncIterator:Io,SymbolIterator:Ao,SymbolFor:jt}=te,Ba=jt("nodejs.stream.destroyed"),Va=jt("nodejs.stream.errored"),ii=jt("nodejs.stream.readable"),oi=jt("nodejs.stream.writable"),Ga=jt("nodejs.stream.disturbed"),Vd=jt("nodejs.webstream.isClosedPromise"),Gd=jt("nodejs.webstream.controllerErrorFunction");function Xn(e,t=!1){var n;return!!(e&&typeof e.pipe=="function"&&typeof e.on=="function"&&(!t||typeof e.pause=="function"&&typeof e.resume=="function")&&(!e._writableState||((n=e._readableState)===null||n===void 0?void 0:n.readable)!==!1)&&(!e._writableState||e._readableState))}function zn(e){var t;return!!(e&&typeof e.write=="function"&&typeof e.on=="function"&&(!e._readableState||((t=e._writableState)===null||t===void 0?void 0:t.writable)!==!1))}function qd(e){return!!(e&&typeof e.pipe=="function"&&e._readableState&&typeof e.on=="function"&&typeof e.write=="function")}function Ce(e){return e&&(e._readableState||e._writableState||typeof e.write=="function"&&typeof e.on=="function"||typeof e.pipe=="function"&&typeof e.on=="function")}function qa(e){return!!(e&&!Ce(e)&&typeof e.pipeThrough=="function"&&typeof e.getReader=="function"&&typeof e.cancel=="function")}function Ca(e){return!!(e&&!Ce(e)&&typeof e.getWriter=="function"&&typeof e.abort=="function")}function Xa(e){return!!(e&&!Ce(e)&&typeof e.readable=="object"&&typeof e.writable=="object")}function Cd(e){return qa(e)||Ca(e)||Xa(e)}function Xd(e,t){return e==null?!1:t===!0?typeof e[Io]=="function":t===!1?typeof e[Ao]=="function":typeof e[Io]=="function"||typeof e[Ao]=="function"}function Kn(e){if(!Ce(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!!(e.destroyed||e[Ba]||r!=null&&r.destroyed)}function za(e){if(!zn(e))return null;if(e.writableEnded===!0)return!0;const t=e._writableState;return t!=null&&t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function zd(e,t){if(!zn(e))return null;if(e.writableFinished===!0)return!0;const n=e._writableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.finished)!="boolean"?null:!!(n.finished||t===!1&&n.ended===!0&&n.length===0)}function Kd(e){if(!Xn(e))return null;if(e.readableEnded===!0)return!0;const t=e._readableState;return!t||t.errored?!1:typeof(t==null?void 0:t.ended)!="boolean"?null:t.ended}function Ka(e,t){if(!Xn(e))return null;const n=e._readableState;return n!=null&&n.errored?!1:typeof(n==null?void 0:n.endEmitted)!="boolean"?null:!!(n.endEmitted||t===!1&&n.ended===!0&&n.length===0)}function Ya(e){return e&&e[ii]!=null?e[ii]:typeof(e==null?void 0:e.readable)!="boolean"?null:Kn(e)?!1:Xn(e)&&e.readable&&!Ka(e)}function Qa(e){return e&&e[oi]!=null?e[oi]:typeof(e==null?void 0:e.writable)!="boolean"?null:Kn(e)?!1:zn(e)&&e.writable&&!za(e)}function Yd(e,t){return Ce(e)?Kn(e)?!0:!((t==null?void 0:t.readable)!==!1&&Ya(e)||(t==null?void 0:t.writable)!==!1&&Qa(e)):null}function Qd(e){var t,n;return Ce(e)?e.writableErrored?e.writableErrored:(t=(n=e._writableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function Zd(e){var t,n;return Ce(e)?e.readableErrored?e.readableErrored:(t=(n=e._readableState)===null||n===void 0?void 0:n.errored)!==null&&t!==void 0?t:null:null}function eu(e){if(!Ce(e))return null;if(typeof e.closed=="boolean")return e.closed;const t=e._writableState,n=e._readableState;return typeof(t==null?void 0:t.closed)=="boolean"||typeof(n==null?void 0:n.closed)=="boolean"?(t==null?void 0:t.closed)||(n==null?void 0:n.closed):typeof e._closed=="boolean"&&Za(e)?e._closed:null}function Za(e){return typeof e._closed=="boolean"&&typeof e._defaultKeepAlive=="boolean"&&typeof e._removedConnection=="boolean"&&typeof e._removedContLen=="boolean"}function es(e){return typeof e._sent100=="boolean"&&Za(e)}function tu(e){var t;return typeof e._consuming=="boolean"&&typeof e._dumped=="boolean"&&((t=e.req)===null||t===void 0?void 0:t.upgradeOrConnect)===void 0}function nu(e){if(!Ce(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!r&&es(e)||!!(r&&r.autoDestroy&&r.emitClose&&r.closed===!1)}function ru(e){var t;return!!(e&&((t=e[Ga])!==null&&t!==void 0?t:e.readableDidRead||e.readableAborted))}function iu(e){var t,n,r,o,a,i,l,f,c,p;return!!(e&&((t=(n=(r=(o=(a=(i=e[Va])!==null&&i!==void 0?i:e.readableErrored)!==null&&a!==void 0?a:e.writableErrored)!==null&&o!==void 0?o:(l=e._readableState)===null||l===void 0?void 0:l.errorEmitted)!==null&&r!==void 0?r:(f=e._writableState)===null||f===void 0?void 0:f.errorEmitted)!==null&&n!==void 0?n:(c=e._readableState)===null||c===void 0?void 0:c.errored)!==null&&t!==void 0?t:!((p=e._writableState)===null||p===void 0)&&p.errored))}var ot={isDestroyed:Kn,kIsDestroyed:Ba,isDisturbed:ru,kIsDisturbed:Ga,isErrored:iu,kIsErrored:Va,isReadable:Ya,kIsReadable:ii,kIsClosedPromise:Vd,kControllerErrorFunction:Gd,kIsWritable:oi,isClosed:eu,isDuplexNodeStream:qd,isFinished:Yd,isIterable:Xd,isReadableNodeStream:Xn,isReadableStream:qa,isReadableEnded:Kd,isReadableFinished:Ka,isReadableErrored:Zd,isNodeStream:Ce,isWebStream:Cd,isWritable:Qa,isWritableNodeStream:zn,isWritableStream:Ca,isWritableEnded:za,isWritableFinished:zd,isWritableErrored:Qd,isServerRequest:tu,isServerResponse:es,willEmitClose:nu,isTransformStream:Xa};const ct=Lt,{AbortError:ts,codes:ou}=me,{ERR_INVALID_ARG_TYPE:au,ERR_STREAM_PREMATURE_CLOSE:xo}=ou,{kEmptyObject:ai,once:si}=ve,{validateAbortSignal:su,validateFunction:lu,validateObject:cu,validateBoolean:du}=yn,{Promise:uu,PromisePrototypeThen:fu,SymbolDispose:ns}=te,{isClosed:hu,isReadable:No,isReadableNodeStream:Or,isReadableStream:pu,isReadableFinished:Do,isReadableErrored:Oo,isWritable:Lo,isWritableNodeStream:To,isWritableStream:gu,isWritableFinished:jo,isWritableErrored:ko,isNodeStream:yu,willEmitClose:bu,kIsClosedPromise:wu}=ot;let qt;function vu(e){return e.setHeader&&typeof e.abort=="function"}const li=()=>{};function rs(e,t,n){var r,o;if(arguments.length===2?(n=t,t=ai):t==null?t=ai:cu(t,"options"),lu(n,"callback"),su(t.signal,"options.signal"),n=si(n),pu(e)||gu(e))return _u(e,t,n);if(!yu(e))throw new au("stream",["ReadableStream","WritableStream","Stream"],e);const a=(r=t.readable)!==null&&r!==void 0?r:Or(e),i=(o=t.writable)!==null&&o!==void 0?o:To(e),l=e._writableState,f=e._readableState,c=()=>{e.writable||d()};let p=bu(e)&&Or(e)===a&&To(e)===i,g=jo(e,!1);const d=()=>{g=!0,e.destroyed&&(p=!1),!(p&&(!e.readable||a))&&(!a||s)&&n.call(e)};let s=Do(e,!1);const u=()=>{s=!0,e.destroyed&&(p=!1),!(p&&(!e.writable||i))&&(!i||g)&&n.call(e)},y=x=>{n.call(e,x)};let w=hu(e);const v=()=>{w=!0;const x=ko(e)||Oo(e);if(x&&typeof x!="boolean")return n.call(e,x);if(a&&!s&&Or(e,!0)&&!Do(e,!1))return n.call(e,new xo);if(i&&!g&&!jo(e,!1))return n.call(e,new xo);n.call(e)},E=()=>{w=!0;const x=ko(e)||Oo(e);if(x&&typeof x!="boolean")return n.call(e,x);n.call(e)},S=()=>{e.req.on("finish",d)};vu(e)?(e.on("complete",d),p||e.on("abort",v),e.req?S():e.on("request",S)):i&&!l&&(e.on("end",c),e.on("close",c)),!p&&typeof e.aborted=="boolean"&&e.on("aborted",v),e.on("end",u),e.on("finish",d),t.error!==!1&&e.on("error",y),e.on("close",v),w?ct.nextTick(v):l!=null&&l.errorEmitted||f!=null&&f.errorEmitted?p||ct.nextTick(E):(!a&&(!p||No(e))&&(g||Lo(e)===!1)||!i&&(!p||Lo(e))&&(s||No(e)===!1)||f&&e.req&&e.aborted)&&ct.nextTick(E);const I=()=>{n=li,e.removeListener("aborted",v),e.removeListener("complete",d),e.removeListener("abort",v),e.removeListener("request",S),e.req&&e.req.removeListener("finish",d),e.removeListener("end",c),e.removeListener("close",c),e.removeListener("finish",d),e.removeListener("end",u),e.removeListener("error",y),e.removeListener("close",v)};if(t.signal&&!w){const x=()=>{const R=n;I(),R.call(e,new ts(void 0,{cause:t.signal.reason}))};if(t.signal.aborted)ct.nextTick(x);else{qt=qt||ve.addAbortListener;const R=qt(t.signal,x),V=n;n=si((...k)=>{R[ns](),V.apply(e,k)})}}return I}function _u(e,t,n){let r=!1,o=li;if(t.signal)if(o=()=>{r=!0,n.call(e,new ts(void 0,{cause:t.signal.reason}))},t.signal.aborted)ct.nextTick(o);else{qt=qt||ve.addAbortListener;const i=qt(t.signal,o),l=n;n=si((...f)=>{i[ns](),l.apply(e,f)})}const a=(...i)=>{r||ct.nextTick(()=>n.apply(e,i))};return fu(e[wu].promise,a,a),li}function mu(e,t){var n;let r=!1;return t===null&&(t=ai),(n=t)!==null&&n!==void 0&&n.cleanup&&(du(t.cleanup,"cleanup"),r=t.cleanup),new uu((o,a)=>{const i=rs(e,t,l=>{r&&i(),l?a(l):o()})})}Ai.exports=rs;Ai.exports.finished=mu;var pt=Ai.exports;const Ge=Lt,{aggregateTwoErrors:Su,codes:{ERR_MULTIPLE_CALLBACK:Eu},AbortError:Ru}=me,{Symbol:is}=te,{kIsDestroyed:Iu,isDestroyed:Au,isFinished:xu,isServerRequest:Nu}=ot,os=is("kDestroy"),ci=is("kConstruct");function as(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function Du(e,t){const n=this._readableState,r=this._writableState,o=r||n;return r!=null&&r.destroyed||n!=null&&n.destroyed?(typeof t=="function"&&t(),this):(as(e,r,n),r&&(r.destroyed=!0),n&&(n.destroyed=!0),o.constructed?$o(this,e,t):this.once(os,function(a){$o(this,Su(a,e),t)}),this)}function $o(e,t,n){let r=!1;function o(a){if(r)return;r=!0;const i=e._readableState,l=e._writableState;as(a,l,i),l&&(l.closed=!0),i&&(i.closed=!0),typeof n=="function"&&n(a),a?Ge.nextTick(Ou,e,a):Ge.nextTick(ss,e)}try{e._destroy(t||null,o)}catch(a){o(a)}}function Ou(e,t){di(e,t),ss(e)}function ss(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(n!=null&&n.emitClose||t!=null&&t.emitClose)&&e.emit("close")}function di(e,t){const n=e._readableState,r=e._writableState;r!=null&&r.errorEmitted||n!=null&&n.errorEmitted||(r&&(r.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function Lu(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=e.readable===!1,e.endEmitted=e.readable===!1),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=t.writable===!1,t.ending=t.writable===!1,t.finished=t.writable===!1)}function ui(e,t,n){const r=e._readableState,o=e._writableState;if(o!=null&&o.destroyed||r!=null&&r.destroyed)return this;r!=null&&r.autoDestroy||o!=null&&o.autoDestroy?e.destroy(t):t&&(t.stack,o&&!o.errored&&(o.errored=t),r&&!r.errored&&(r.errored=t),n?Ge.nextTick(di,e,t):di(e,t))}function Tu(e,t){if(typeof e._construct!="function")return;const n=e._readableState,r=e._writableState;n&&(n.constructed=!1),r&&(r.constructed=!1),e.once(ci,t),!(e.listenerCount(ci)>1)&&Ge.nextTick(ju,e)}function ju(e){let t=!1;function n(r){if(t){ui(e,r??new Eu);return}t=!0;const o=e._readableState,a=e._writableState,i=a||o;o&&(o.constructed=!0),a&&(a.constructed=!0),i.destroyed?e.emit(os,r):r?ui(e,r,!0):Ge.nextTick(ku,e)}try{e._construct(r=>{Ge.nextTick(n,r)})}catch(r){Ge.nextTick(n,r)}}function ku(e){e.emit(ci)}function Mo(e){return(e==null?void 0:e.setHeader)&&typeof e.abort=="function"}function ls(e){e.emit("close")}function $u(e,t){e.emit("error",t),Ge.nextTick(ls,e)}function Mu(e,t){!e||Au(e)||(!t&&!xu(e)&&(t=new Ru),Nu(e)?(e.socket=null,e.destroy(t)):Mo(e)?e.abort():Mo(e.req)?e.req.abort():typeof e.destroy=="function"?e.destroy(t):typeof e.close=="function"?e.close():t?Ge.nextTick($u,e,t):Ge.nextTick(ls,e),e.destroyed||(e[Iu]=!0))}var zt={construct:Tu,destroyer:Mu,destroy:Du,undestroy:Lu,errorOrDestroy:ui};const{ArrayIsArray:Pu,ObjectSetPrototypeOf:cs}=te,{EventEmitter:Yn}=Bn;function Qn(e){Yn.call(this,e)}cs(Qn.prototype,Yn.prototype);cs(Qn,Yn);Qn.prototype.pipe=function(e,t){const n=this;function r(p){e.writable&&e.write(p)===!1&&n.pause&&n.pause()}n.on("data",r);function o(){n.readable&&n.resume&&n.resume()}e.on("drain",o),!e._isStdio&&(!t||t.end!==!1)&&(n.on("end",i),n.on("close",l));let a=!1;function i(){a||(a=!0,e.end())}function l(){a||(a=!0,typeof e.destroy=="function"&&e.destroy())}function f(p){c(),Yn.listenerCount(this,"error")===0&&this.emit("error",p)}fi(n,"error",f),fi(e,"error",f);function c(){n.removeListener("data",r),e.removeListener("drain",o),n.removeListener("end",i),n.removeListener("close",l),n.removeListener("error",f),e.removeListener("error",f),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e};function fi(e,t,n){if(typeof e.prependListener=="function")return e.prependListener(t,n);!e._events||!e._events[t]?e.on(t,n):Pu(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]}var xi={Stream:Qn,prependListener:fi},ds={exports:{}};(function(e){const{SymbolDispose:t}=te,{AbortError:n,codes:r}=me,{isNodeStream:o,isWebStream:a,kControllerErrorFunction:i}=ot,l=pt,{ERR_INVALID_ARG_TYPE:f}=r;let c;const p=(g,d)=>{if(typeof g!="object"||!("aborted"in g))throw new f(d,"AbortSignal",g)};e.exports.addAbortSignal=function(d,s){if(p(d,"signal"),!o(s)&&!a(s))throw new f("stream",["ReadableStream","WritableStream","Stream"],s);return e.exports.addAbortSignalNoValidate(d,s)},e.exports.addAbortSignalNoValidate=function(g,d){if(typeof g!="object"||!("aborted"in g))return d;const s=o(d)?()=>{d.destroy(new n(void 0,{cause:g.reason}))}:()=>{d[i](new n(void 0,{cause:g.reason}))};if(g.aborted)s();else{c=c||ve.addAbortListener;const u=c(g,s);l(d,u[t])}return d}})(ds);var Zn=ds.exports;const{StringPrototypeSlice:Po,SymbolIterator:Fu,TypedArrayPrototypeSet:An,Uint8Array:Wu}=te,{Buffer:Lr}=Ot,{inspect:Ju}=ve;var Uu=class{constructor(){this.head=null,this.tail=null,this.length=0}push(t){const n={data:t,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}unshift(t){const n={data:t,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}shift(){if(this.length===0)return;const t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}clear(){this.head=this.tail=null,this.length=0}join(t){if(this.length===0)return"";let n=this.head,r=""+n.data;for(;(n=n.next)!==null;)r+=t+n.data;return r}concat(t){if(this.length===0)return Lr.alloc(0);const n=Lr.allocUnsafe(t>>>0);let r=this.head,o=0;for(;r;)An(n,r.data,o),o+=r.data.length,r=r.next;return n}consume(t,n){const r=this.head.data;if(t<r.length){const o=r.slice(0,t);return this.head.data=r.slice(t),o}return t===r.length?this.shift():n?this._getString(t):this._getBuffer(t)}first(){return this.head.data}*[Fu](){for(let t=this.head;t;t=t.next)yield t.data}_getString(t){let n="",r=this.head,o=0;do{const a=r.data;if(t>a.length)n+=a,t-=a.length;else{t===a.length?(n+=a,++o,r.next?this.head=r.next:this.head=this.tail=null):(n+=Po(a,0,t),this.head=r,r.data=Po(a,t));break}++o}while((r=r.next)!==null);return this.length-=o,n}_getBuffer(t){const n=Lr.allocUnsafe(t),r=t;let o=this.head,a=0;do{const i=o.data;if(t>i.length)An(n,i,r-t),t-=i.length;else{t===i.length?(An(n,i,r-t),++a,o.next?this.head=o.next:this.head=this.tail=null):(An(n,new Wu(i.buffer,i.byteOffset,t),r-t),this.head=o,o.data=i.slice(t));break}++a}while((o=o.next)!==null);return this.length-=a,n}[Symbol.for("nodejs.util.inspect.custom")](t,n){return Ju(this,{...n,depth:0,customInspect:!1})}};const{MathFloor:Hu,NumberIsInteger:Bu}=te,{validateInteger:Vu}=yn,{ERR_INVALID_ARG_VALUE:Gu}=me.codes;let us=16*1024,fs=16;function qu(e,t,n){return e.highWaterMark!=null?e.highWaterMark:t?e[n]:null}function hs(e){return e?fs:us}function Cu(e,t){Vu(t,"value",0),e?fs=t:us=t}function Xu(e,t,n,r){const o=qu(t,r,n);if(o!=null){if(!Bu(o)||o<0){const a=r?`options.${n}`:"options.highWaterMark";throw new Gu(a,o)}return Hu(o)}return hs(e.objectMode)}var er={getHighWaterMark:Xu,getDefaultHighWaterMark:hs,setDefaultHighWaterMark:Cu};const Fo=Lt,{PromisePrototypeThen:zu,SymbolAsyncIterator:Wo,SymbolIterator:Jo}=te,{Buffer:Ku}=Ot,{ERR_INVALID_ARG_TYPE:Yu,ERR_STREAM_NULL_VALUES:Qu}=me.codes;function Zu(e,t,n){let r;if(typeof t=="string"||t instanceof Ku)return new e({objectMode:!0,...n,read(){this.push(t),this.push(null)}});let o;if(t&&t[Wo])o=!0,r=t[Wo]();else if(t&&t[Jo])o=!1,r=t[Jo]();else throw new Yu("iterable",["Iterable"],t);const a=new e({objectMode:!0,highWaterMark:1,...n});let i=!1;a._read=function(){i||(i=!0,f())},a._destroy=function(c,p){zu(l(c),()=>Fo.nextTick(p,c),g=>Fo.nextTick(p,g||c))};async function l(c){const p=c!=null,g=typeof r.throw=="function";if(p&&g){const{value:d,done:s}=await r.throw(c);if(await d,s)return}if(typeof r.return=="function"){const{value:d}=await r.return();await d}}async function f(){for(;;){try{const{value:c,done:p}=o?await r.next():r.next();if(p)a.push(null);else{const g=c&&typeof c.then=="function"?await c:c;if(g===null)throw i=!1,new Qu;if(a.push(g))continue;i=!1}}catch(c){a.destroy(c)}break}}return a}var ps=Zu,Tr,Uo;function tr(){if(Uo)return Tr;Uo=1;const e=Lt,{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:o,ObjectDefineProperties:a,ObjectKeys:i,ObjectSetPrototypeOf:l,Promise:f,SafeSet:c,SymbolAsyncDispose:p,SymbolAsyncIterator:g,Symbol:d}=te;Tr=P,P.ReadableState=ze;const{EventEmitter:s}=Bn,{Stream:u,prependListener:y}=xi,{Buffer:w}=Ot,{addAbortSignal:v}=Zn,E=pt;let S=ve.debuglog("stream",h=>{S=h});const I=Uu,x=zt,{getHighWaterMark:R,getDefaultHighWaterMark:V}=er,{aggregateTwoErrors:k,codes:{ERR_INVALID_ARG_TYPE:F,ERR_METHOD_NOT_IMPLEMENTED:ne,ERR_OUT_OF_RANGE:se,ERR_STREAM_PUSH_AFTER_EOF:H,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:N},AbortError:C}=me,{validateObject:J}=yn,U=d("kPaused"),{StringDecoder:re}=Hs,ie=ps;l(P.prototype,u.prototype),l(P,u);const ee=()=>{},{errorOrDestroy:oe}=x,X=1,Xe=2,M=4,le=8,Je=16,Mt=32,Pt=64,Ft=128,Kt=256,rr=512,Yt=1024,Wt=2048,_=4096,m=8192,A=16384,T=32768,j=65536,K=1<<17,Z=1<<18;function z(h){return{enumerable:!1,get(){return(this.state&h)!==0},set(b){b?this.state|=h:this.state&=~h}}}a(ze.prototype,{objectMode:z(X),ended:z(Xe),endEmitted:z(M),reading:z(le),constructed:z(Je),sync:z(Mt),needReadable:z(Pt),emittedReadable:z(Ft),readableListening:z(Kt),resumeScheduled:z(rr),errorEmitted:z(Yt),emitClose:z(Wt),autoDestroy:z(_),destroyed:z(m),closed:z(A),closeEmitted:z(T),multiAwaitDrain:z(j),readingMore:z(K),dataEmitted:z(Z)});function ze(h,b,D){typeof D!="boolean"&&(D=b instanceof nt()),this.state=Wt|_|Je|Mt,h&&h.objectMode&&(this.state|=X),D&&h&&h.readableObjectMode&&(this.state|=X),this.highWaterMark=h?R(this,h,"readableHighWaterMark",D):V(!1),this.buffer=new I,this.length=0,this.pipes=[],this.flowing=null,this[U]=null,h&&h.emitClose===!1&&(this.state&=~Wt),h&&h.autoDestroy===!1&&(this.state&=~_),this.errored=null,this.defaultEncoding=h&&h.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,h&&h.encoding&&(this.decoder=new re(h.encoding),this.encoding=h.encoding)}function P(h){if(!(this instanceof P))return new P(h);const b=this instanceof nt();this._readableState=new ze(h,this,b),h&&(typeof h.read=="function"&&(this._read=h.read),typeof h.destroy=="function"&&(this._destroy=h.destroy),typeof h.construct=="function"&&(this._construct=h.construct),h.signal&&!b&&v(h.signal,this)),u.call(this,h),x.construct(this,()=>{this._readableState.needReadable&&vn(this,this._readableState)})}P.prototype.destroy=x.destroy,P.prototype._undestroy=x.undestroy,P.prototype._destroy=function(h,b){b(h)},P.prototype[s.captureRejectionSymbol]=function(h){this.destroy(h)},P.prototype[p]=function(){let h;return this.destroyed||(h=this.readableEnded?null:new C,this.destroy(h)),new f((b,D)=>E(this,O=>O&&O!==h?D(O):b(null)))},P.prototype.push=function(h,b){return at(this,h,b,!1)},P.prototype.unshift=function(h,b){return at(this,h,b,!0)};function at(h,b,D,O){S("readableAddChunk",b);const L=h._readableState;let fe;if(L.state&X||(typeof b=="string"?(D=D||L.defaultEncoding,L.encoding!==D&&(O&&L.encoding?b=w.from(b,D).toString(L.encoding):(b=w.from(b,D),D=""))):b instanceof w?D="":u._isUint8Array(b)?(b=u._uint8ArrayToBuffer(b),D=""):b!=null&&(fe=new F("chunk",["string","Buffer","Uint8Array"],b))),fe)oe(h,fe);else if(b===null)L.state&=~le,Ns(h,L);else if(L.state&X||b&&b.length>0)if(O)if(L.state&M)oe(h,new N);else{if(L.destroyed||L.errored)return!1;ir(h,L,b,!0)}else if(L.ended)oe(h,new H);else{if(L.destroyed||L.errored)return!1;L.state&=~le,L.decoder&&!D?(b=L.decoder.write(b),L.objectMode||b.length!==0?ir(h,L,b,!1):vn(h,L)):ir(h,L,b,!1)}else O||(L.state&=~le,vn(h,L));return!L.ended&&(L.length<L.highWaterMark||L.length===0)}function ir(h,b,D,O){b.flowing&&b.length===0&&!b.sync&&h.listenerCount("data")>0?(b.state&j?b.awaitDrainWriters.clear():b.awaitDrainWriters=null,b.dataEmitted=!0,h.emit("data",D)):(b.length+=b.objectMode?1:D.length,O?b.buffer.unshift(D):b.buffer.push(D),b.state&Pt&&wn(h)),vn(h,b)}P.prototype.isPaused=function(){const h=this._readableState;return h[U]===!0||h.flowing===!1},P.prototype.setEncoding=function(h){const b=new re(h);this._readableState.decoder=b,this._readableState.encoding=this._readableState.decoder.encoding;const D=this._readableState.buffer;let O="";for(const L of D)O+=b.write(L);return D.clear(),O!==""&&D.push(O),this._readableState.length=O.length,this};const As=1073741824;function xs(h){if(h>As)throw new se("size","<= 1GiB",h);return h--,h|=h>>>1,h|=h>>>2,h|=h>>>4,h|=h>>>8,h|=h>>>16,h++,h}function ji(h,b){return h<=0||b.length===0&&b.ended?0:b.state&X?1:r(h)?b.flowing&&b.length?b.buffer.first().length:b.length:h<=b.length?h:b.ended?b.length:0}P.prototype.read=function(h){S("read",h),h===void 0?h=NaN:n(h)||(h=o(h,10));const b=this._readableState,D=h;if(h>b.highWaterMark&&(b.highWaterMark=xs(h)),h!==0&&(b.state&=~Ft),h===0&&b.needReadable&&((b.highWaterMark!==0?b.length>=b.highWaterMark:b.length>0)||b.ended))return S("read: emitReadable",b.length,b.ended),b.length===0&&b.ended?or(this):wn(this),null;if(h=ji(h,b),h===0&&b.ended)return b.length===0&&or(this),null;let O=(b.state&Pt)!==0;if(S("need readable",O),(b.length===0||b.length-h<b.highWaterMark)&&(O=!0,S("length less than watermark",O)),b.ended||b.reading||b.destroyed||b.errored||!b.constructed)O=!1,S("reading, ended or constructing",O);else if(O){S("do read"),b.state|=le|Mt,b.length===0&&(b.state|=Pt);try{this._read(b.highWaterMark)}catch(fe){oe(this,fe)}b.state&=~Mt,b.reading||(h=ji(D,b))}let L;return h>0?L=Fi(h,b):L=null,L===null?(b.needReadable=b.length<=b.highWaterMark,h=0):(b.length-=h,b.multiAwaitDrain?b.awaitDrainWriters.clear():b.awaitDrainWriters=null),b.length===0&&(b.ended||(b.needReadable=!0),D!==h&&b.ended&&or(this)),L!==null&&!b.errorEmitted&&!b.closeEmitted&&(b.dataEmitted=!0,this.emit("data",L)),L};function Ns(h,b){if(S("onEofChunk"),!b.ended){if(b.decoder){const D=b.decoder.end();D&&D.length&&(b.buffer.push(D),b.length+=b.objectMode?1:D.length)}b.ended=!0,b.sync?wn(h):(b.needReadable=!1,b.emittedReadable=!0,ki(h))}}function wn(h){const b=h._readableState;S("emitReadable",b.needReadable,b.emittedReadable),b.needReadable=!1,b.emittedReadable||(S("emitReadable",b.flowing),b.emittedReadable=!0,e.nextTick(ki,h))}function ki(h){const b=h._readableState;S("emitReadable_",b.destroyed,b.length,b.ended),!b.destroyed&&!b.errored&&(b.length||b.ended)&&(h.emit("readable"),b.emittedReadable=!1),b.needReadable=!b.flowing&&!b.ended&&b.length<=b.highWaterMark,Mi(h)}function vn(h,b){!b.readingMore&&b.constructed&&(b.readingMore=!0,e.nextTick(Ds,h,b))}function Ds(h,b){for(;!b.reading&&!b.ended&&(b.length<b.highWaterMark||b.flowing&&b.length===0);){const D=b.length;if(S("maybeReadMore read 0"),h.read(0),D===b.length)break}b.readingMore=!1}P.prototype._read=function(h){throw new ne("_read()")},P.prototype.pipe=function(h,b){const D=this,O=this._readableState;O.pipes.length===1&&(O.multiAwaitDrain||(O.multiAwaitDrain=!0,O.awaitDrainWriters=new c(O.awaitDrainWriters?[O.awaitDrainWriters]:[]))),O.pipes.push(h),S("pipe count=%d opts=%j",O.pipes.length,b);const fe=(!b||b.end!==!1)&&h!==e.stdout&&h!==e.stderr?Ji:Qt;O.endEmitted?e.nextTick(fe):D.once("end",fe),h.on("unpipe",xe);function xe(yt,Ke){S("onunpipe"),yt===D&&Ke&&Ke.hasUnpiped===!1&&(Ke.hasUnpiped=!0,Ps())}function Ji(){S("onend"),h.end()}let gt,Ui=!1;function Ps(){S("cleanup"),h.removeListener("close",lr),h.removeListener("finish",cr),gt&&h.removeListener("drain",gt),h.removeListener("error",sr),h.removeListener("unpipe",xe),D.removeListener("end",Ji),D.removeListener("end",Qt),D.removeListener("data",Bi),Ui=!0,gt&&O.awaitDrainWriters&&(!h._writableState||h._writableState.needDrain)&&gt()}function Hi(){Ui||(O.pipes.length===1&&O.pipes[0]===h?(S("false write response, pause",0),O.awaitDrainWriters=h,O.multiAwaitDrain=!1):O.pipes.length>1&&O.pipes.includes(h)&&(S("false write response, pause",O.awaitDrainWriters.size),O.awaitDrainWriters.add(h)),D.pause()),gt||(gt=Os(D,h),h.on("drain",gt))}D.on("data",Bi);function Bi(yt){S("ondata");const Ke=h.write(yt);S("dest.write",Ke),Ke===!1&&Hi()}function sr(yt){if(S("onerror",yt),Qt(),h.removeListener("error",sr),h.listenerCount("error")===0){const Ke=h._writableState||h._readableState;Ke&&!Ke.errorEmitted?oe(h,yt):h.emit("error",yt)}}y(h,"error",sr);function lr(){h.removeListener("finish",cr),Qt()}h.once("close",lr);function cr(){S("onfinish"),h.removeListener("close",lr),Qt()}h.once("finish",cr);function Qt(){S("unpipe"),D.unpipe(h)}return h.emit("pipe",D),h.writableNeedDrain===!0?Hi():O.flowing||(S("pipe resume"),D.resume()),h};function Os(h,b){return function(){const O=h._readableState;O.awaitDrainWriters===b?(S("pipeOnDrain",1),O.awaitDrainWriters=null):O.multiAwaitDrain&&(S("pipeOnDrain",O.awaitDrainWriters.size),O.awaitDrainWriters.delete(b)),(!O.awaitDrainWriters||O.awaitDrainWriters.size===0)&&h.listenerCount("data")&&h.resume()}}P.prototype.unpipe=function(h){const b=this._readableState,D={hasUnpiped:!1};if(b.pipes.length===0)return this;if(!h){const L=b.pipes;b.pipes=[],this.pause();for(let fe=0;fe<L.length;fe++)L[fe].emit("unpipe",this,{hasUnpiped:!1});return this}const O=t(b.pipes,h);return O===-1?this:(b.pipes.splice(O,1),b.pipes.length===0&&this.pause(),h.emit("unpipe",this,D),this)},P.prototype.on=function(h,b){const D=u.prototype.on.call(this,h,b),O=this._readableState;return h==="data"?(O.readableListening=this.listenerCount("readable")>0,O.flowing!==!1&&this.resume()):h==="readable"&&!O.endEmitted&&!O.readableListening&&(O.readableListening=O.needReadable=!0,O.flowing=!1,O.emittedReadable=!1,S("on readable",O.length,O.reading),O.length?wn(this):O.reading||e.nextTick(Ls,this)),D},P.prototype.addListener=P.prototype.on,P.prototype.removeListener=function(h,b){const D=u.prototype.removeListener.call(this,h,b);return h==="readable"&&e.nextTick($i,this),D},P.prototype.off=P.prototype.removeListener,P.prototype.removeAllListeners=function(h){const b=u.prototype.removeAllListeners.apply(this,arguments);return(h==="readable"||h===void 0)&&e.nextTick($i,this),b};function $i(h){const b=h._readableState;b.readableListening=h.listenerCount("readable")>0,b.resumeScheduled&&b[U]===!1?b.flowing=!0:h.listenerCount("data")>0?h.resume():b.readableListening||(b.flowing=null)}function Ls(h){S("readable nexttick read 0"),h.read(0)}P.prototype.resume=function(){const h=this._readableState;return h.flowing||(S("resume"),h.flowing=!h.readableListening,Ts(this,h)),h[U]=!1,this};function Ts(h,b){b.resumeScheduled||(b.resumeScheduled=!0,e.nextTick(js,h,b))}function js(h,b){S("resume",b.reading),b.reading||h.read(0),b.resumeScheduled=!1,h.emit("resume"),Mi(h),b.flowing&&!b.reading&&h.read(0)}P.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[U]=!0,this};function Mi(h){const b=h._readableState;for(S("flow",b.flowing);b.flowing&&h.read()!==null;);}P.prototype.wrap=function(h){let b=!1;h.on("data",O=>{!this.push(O)&&h.pause&&(b=!0,h.pause())}),h.on("end",()=>{this.push(null)}),h.on("error",O=>{oe(this,O)}),h.on("close",()=>{this.destroy()}),h.on("destroy",()=>{this.destroy()}),this._read=()=>{b&&h.resume&&(b=!1,h.resume())};const D=i(h);for(let O=1;O<D.length;O++){const L=D[O];this[L]===void 0&&typeof h[L]=="function"&&(this[L]=h[L].bind(h))}return this},P.prototype[g]=function(){return Pi(this)},P.prototype.iterator=function(h){return h!==void 0&&J(h,"options"),Pi(this,h)};function Pi(h,b){typeof h.read!="function"&&(h=P.wrap(h,{objectMode:!0}));const D=ks(h,b);return D.stream=h,D}async function*ks(h,b){let D=ee;function O(xe){this===h?(D(),D=ee):D=xe}h.on("readable",O);let L;const fe=E(h,{writable:!1},xe=>{L=xe?k(L,xe):null,D(),D=ee});try{for(;;){const xe=h.destroyed?null:h.read();if(xe!==null)yield xe;else{if(L)throw L;if(L===null)return;await new f(O)}}}catch(xe){throw L=k(L,xe),L}finally{(L||(b==null?void 0:b.destroyOnReturn)!==!1)&&(L===void 0||h._readableState.autoDestroy)?x.destroyer(h,null):(h.off("readable",O),fe())}}a(P.prototype,{readable:{__proto__:null,get(){const h=this._readableState;return!!h&&h.readable!==!1&&!h.destroyed&&!h.errorEmitted&&!h.endEmitted},set(h){this._readableState&&(this._readableState.readable=!!h)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(h){this._readableState&&(this._readableState.flowing=h)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(h){this._readableState&&(this._readableState.destroyed=h)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),a(ze.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[U]!==!1},set(h){this[U]=!!h}}}),P._fromList=Fi;function Fi(h,b){if(b.length===0)return null;let D;return b.objectMode?D=b.buffer.shift():!h||h>=b.length?(b.decoder?D=b.buffer.join(""):b.buffer.length===1?D=b.buffer.first():D=b.buffer.concat(b.length),b.buffer.clear()):D=b.buffer.consume(h,b.decoder),D}function or(h){const b=h._readableState;S("endReadable",b.endEmitted),b.endEmitted||(b.ended=!0,e.nextTick($s,b,h))}function $s(h,b){if(S("endReadableNT",h.endEmitted,h.length),!h.errored&&!h.closeEmitted&&!h.endEmitted&&h.length===0){if(h.endEmitted=!0,b.emit("end"),b.writable&&b.allowHalfOpen===!1)e.nextTick(Ms,b);else if(h.autoDestroy){const D=b._writableState;(!D||D.autoDestroy&&(D.finished||D.writable===!1))&&b.destroy()}}}function Ms(h){h.writable&&!h.writableEnded&&!h.destroyed&&h.end()}P.from=function(h,b){return ie(P,h,b)};let ar;function Wi(){return ar===void 0&&(ar={}),ar}return P.fromWeb=function(h,b){return Wi().newStreamReadableFromReadableStream(h,b)},P.toWeb=function(h,b){return Wi().newReadableStreamFromStreamReadable(h,b)},P.wrap=function(h,b){var D,O;return new P({objectMode:(D=(O=h.readableObjectMode)!==null&&O!==void 0?O:h.objectMode)!==null&&D!==void 0?D:!0,...b,destroy(L,fe){x.destroyer(h,L),fe(L)}}).wrap(h)},Tr}var jr,Ho;function Ni(){if(Ho)return jr;Ho=1;const e=Lt,{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:o,ObjectDefineProperties:a,ObjectSetPrototypeOf:i,StringPrototypeToLowerCase:l,Symbol:f,SymbolHasInstance:c}=te;jr=J,J.WritableState=N;const{EventEmitter:p}=Bn,g=xi.Stream,{Buffer:d}=Ot,s=zt,{addAbortSignal:u}=Zn,{getHighWaterMark:y,getDefaultHighWaterMark:w}=er,{ERR_INVALID_ARG_TYPE:v,ERR_METHOD_NOT_IMPLEMENTED:E,ERR_MULTIPLE_CALLBACK:S,ERR_STREAM_CANNOT_PIPE:I,ERR_STREAM_DESTROYED:x,ERR_STREAM_ALREADY_FINISHED:R,ERR_STREAM_NULL_VALUES:V,ERR_STREAM_WRITE_AFTER_END:k,ERR_UNKNOWN_ENCODING:F}=me.codes,{errorOrDestroy:ne}=s;i(J.prototype,g.prototype),i(J,g);function se(){}const H=f("kOnFinished");function N(_,m,A){typeof A!="boolean"&&(A=m instanceof nt()),this.objectMode=!!(_&&_.objectMode),A&&(this.objectMode=this.objectMode||!!(_&&_.writableObjectMode)),this.highWaterMark=_?y(this,_,"writableHighWaterMark",A):w(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const T=!!(_&&_.decodeStrings===!1);this.decodeStrings=!T,this.defaultEncoding=_&&_.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=oe.bind(void 0,m),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,C(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!_||_.emitClose!==!1,this.autoDestroy=!_||_.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[H]=[]}function C(_){_.buffered=[],_.bufferedIndex=0,_.allBuffers=!0,_.allNoop=!0}N.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},o(N.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function J(_){const m=this instanceof nt();if(!m&&!r(J,this))return new J(_);this._writableState=new N(_,this,m),_&&(typeof _.write=="function"&&(this._write=_.write),typeof _.writev=="function"&&(this._writev=_.writev),typeof _.destroy=="function"&&(this._destroy=_.destroy),typeof _.final=="function"&&(this._final=_.final),typeof _.construct=="function"&&(this._construct=_.construct),_.signal&&u(_.signal,this)),g.call(this,_),s.construct(this,()=>{const A=this._writableState;A.writing||le(this,A),Ft(this,A)})}o(J,c,{__proto__:null,value:function(_){return r(this,_)?!0:this!==J?!1:_&&_._writableState instanceof N}}),J.prototype.pipe=function(){ne(this,new I)};function U(_,m,A,T){const j=_._writableState;if(typeof A=="function")T=A,A=j.defaultEncoding;else{if(!A)A=j.defaultEncoding;else if(A!=="buffer"&&!d.isEncoding(A))throw new F(A);typeof T!="function"&&(T=se)}if(m===null)throw new V;if(!j.objectMode)if(typeof m=="string")j.decodeStrings!==!1&&(m=d.from(m,A),A="buffer");else if(m instanceof d)A="buffer";else if(g._isUint8Array(m))m=g._uint8ArrayToBuffer(m),A="buffer";else throw new v("chunk",["string","Buffer","Uint8Array"],m);let K;return j.ending?K=new k:j.destroyed&&(K=new x("write")),K?(e.nextTick(T,K),ne(_,K,!0),K):(j.pendingcb++,re(_,j,m,A,T))}J.prototype.write=function(_,m,A){return U(this,_,m,A)===!0},J.prototype.cork=function(){this._writableState.corked++},J.prototype.uncork=function(){const _=this._writableState;_.corked&&(_.corked--,_.writing||le(this,_))},J.prototype.setDefaultEncoding=function(m){if(typeof m=="string"&&(m=l(m)),!d.isEncoding(m))throw new F(m);return this._writableState.defaultEncoding=m,this};function re(_,m,A,T,j){const K=m.objectMode?1:A.length;m.length+=K;const Z=m.length<m.highWaterMark;return Z||(m.needDrain=!0),m.writing||m.corked||m.errored||!m.constructed?(m.buffered.push({chunk:A,encoding:T,callback:j}),m.allBuffers&&T!=="buffer"&&(m.allBuffers=!1),m.allNoop&&j!==se&&(m.allNoop=!1)):(m.writelen=K,m.writecb=j,m.writing=!0,m.sync=!0,_._write(A,T,m.onwrite),m.sync=!1),Z&&!m.errored&&!m.destroyed}function ie(_,m,A,T,j,K,Z){m.writelen=T,m.writecb=Z,m.writing=!0,m.sync=!0,m.destroyed?m.onwrite(new x("write")):A?_._writev(j,m.onwrite):_._write(j,K,m.onwrite),m.sync=!1}function ee(_,m,A,T){--m.pendingcb,T(A),M(m),ne(_,A)}function oe(_,m){const A=_._writableState,T=A.sync,j=A.writecb;if(typeof j!="function"){ne(_,new S);return}A.writing=!1,A.writecb=null,A.length-=A.writelen,A.writelen=0,m?(m.stack,A.errored||(A.errored=m),_._readableState&&!_._readableState.errored&&(_._readableState.errored=m),T?e.nextTick(ee,_,A,m,j):ee(_,A,m,j)):(A.buffered.length>A.bufferedIndex&&le(_,A),T?A.afterWriteTickInfo!==null&&A.afterWriteTickInfo.cb===j?A.afterWriteTickInfo.count++:(A.afterWriteTickInfo={count:1,cb:j,stream:_,state:A},e.nextTick(X,A.afterWriteTickInfo)):Xe(_,A,1,j))}function X({stream:_,state:m,count:A,cb:T}){return m.afterWriteTickInfo=null,Xe(_,m,A,T)}function Xe(_,m,A,T){for(!m.ending&&!_.destroyed&&m.length===0&&m.needDrain&&(m.needDrain=!1,_.emit("drain"));A-- >0;)m.pendingcb--,T();m.destroyed&&M(m),Ft(_,m)}function M(_){if(_.writing)return;for(let j=_.bufferedIndex;j<_.buffered.length;++j){var m;const{chunk:K,callback:Z}=_.buffered[j],z=_.objectMode?1:K.length;_.length-=z,Z((m=_.errored)!==null&&m!==void 0?m:new x("write"))}const A=_[H].splice(0);for(let j=0;j<A.length;j++){var T;A[j]((T=_.errored)!==null&&T!==void 0?T:new x("end"))}C(_)}function le(_,m){if(m.corked||m.bufferProcessing||m.destroyed||!m.constructed)return;const{buffered:A,bufferedIndex:T,objectMode:j}=m,K=A.length-T;if(!K)return;let Z=T;if(m.bufferProcessing=!0,K>1&&_._writev){m.pendingcb-=K-1;const z=m.allNoop?se:P=>{for(let at=Z;at<A.length;++at)A[at].callback(P)},ze=m.allNoop&&Z===0?A:t(A,Z);ze.allBuffers=m.allBuffers,ie(_,m,!0,m.length,ze,"",z),C(m)}else{do{const{chunk:z,encoding:ze,callback:P}=A[Z];A[Z++]=null;const at=j?1:z.length;ie(_,m,!1,at,z,ze,P)}while(Z<A.length&&!m.writing);Z===A.length?C(m):Z>256?(A.splice(0,Z),m.bufferedIndex=0):m.bufferedIndex=Z}m.bufferProcessing=!1}J.prototype._write=function(_,m,A){if(this._writev)this._writev([{chunk:_,encoding:m}],A);else throw new E("_write()")},J.prototype._writev=null,J.prototype.end=function(_,m,A){const T=this._writableState;typeof _=="function"?(A=_,_=null,m=null):typeof m=="function"&&(A=m,m=null);let j;if(_!=null){const K=U(this,_,m);K instanceof n&&(j=K)}return T.corked&&(T.corked=1,this.uncork()),j||(!T.errored&&!T.ending?(T.ending=!0,Ft(this,T,!0),T.ended=!0):T.finished?j=new R("end"):T.destroyed&&(j=new x("end"))),typeof A=="function"&&(j||T.finished?e.nextTick(A,j):T[H].push(A)),this};function Je(_){return _.ending&&!_.destroyed&&_.constructed&&_.length===0&&!_.errored&&_.buffered.length===0&&!_.finished&&!_.writing&&!_.errorEmitted&&!_.closeEmitted}function Mt(_,m){let A=!1;function T(j){if(A){ne(_,j??S());return}if(A=!0,m.pendingcb--,j){const K=m[H].splice(0);for(let Z=0;Z<K.length;Z++)K[Z](j);ne(_,j,m.sync)}else Je(m)&&(m.prefinished=!0,_.emit("prefinish"),m.pendingcb++,e.nextTick(Kt,_,m))}m.sync=!0,m.pendingcb++;try{_._final(T)}catch(j){T(j)}m.sync=!1}function Pt(_,m){!m.prefinished&&!m.finalCalled&&(typeof _._final=="function"&&!m.destroyed?(m.finalCalled=!0,Mt(_,m)):(m.prefinished=!0,_.emit("prefinish")))}function Ft(_,m,A){Je(m)&&(Pt(_,m),m.pendingcb===0&&(A?(m.pendingcb++,e.nextTick((T,j)=>{Je(j)?Kt(T,j):j.pendingcb--},_,m)):Je(m)&&(m.pendingcb++,Kt(_,m))))}function Kt(_,m){m.pendingcb--,m.finished=!0;const A=m[H].splice(0);for(let T=0;T<A.length;T++)A[T]();if(_.emit("finish"),m.autoDestroy){const T=_._readableState;(!T||T.autoDestroy&&(T.endEmitted||T.readable===!1))&&_.destroy()}}a(J.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(_){this._writableState&&(this._writableState.destroyed=_)}},writable:{__proto__:null,get(){const _=this._writableState;return!!_&&_.writable!==!1&&!_.destroyed&&!_.errored&&!_.ending&&!_.ended},set(_){this._writableState&&(this._writableState.writable=!!_)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const _=this._writableState;return _?!_.destroyed&&!_.ending&&_.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const rr=s.destroy;J.prototype.destroy=function(_,m){const A=this._writableState;return!A.destroyed&&(A.bufferedIndex<A.buffered.length||A[H].length)&&e.nextTick(M,A),rr.call(this,_,m),this},J.prototype._undestroy=s.undestroy,J.prototype._destroy=function(_,m){m(_)},J.prototype[p.captureRejectionSymbol]=function(_){this.destroy(_)};let Yt;function Wt(){return Yt===void 0&&(Yt={}),Yt}return J.fromWeb=function(_,m){return Wt().newStreamWritableFromWritableStream(_,m)},J.toWeb=function(_){return Wt().newWritableStreamFromStreamWritable(_)},jr}var kr,Bo;function ef(){if(Bo)return kr;Bo=1;const e=Lt,t=Ot,{isReadable:n,isWritable:r,isIterable:o,isNodeStream:a,isReadableNodeStream:i,isWritableNodeStream:l,isDuplexNodeStream:f,isReadableStream:c,isWritableStream:p}=ot,g=pt,{AbortError:d,codes:{ERR_INVALID_ARG_TYPE:s,ERR_INVALID_RETURN_VALUE:u}}=me,{destroyer:y}=zt,w=nt(),v=tr(),E=Ni(),{createDeferredPromise:S}=ve,I=ps,x=globalThis.Blob||t.Blob,R=typeof x<"u"?function(N){return N instanceof x}:function(N){return!1},V=globalThis.AbortController||hn().AbortController,{FunctionPrototypeCall:k}=te;class F extends w{constructor(N){super(N),(N==null?void 0:N.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(N==null?void 0:N.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}kr=function H(N,C){if(f(N))return N;if(i(N))return se({readable:N});if(l(N))return se({writable:N});if(a(N))return se({writable:!1,readable:!1});if(c(N))return se({readable:v.fromWeb(N)});if(p(N))return se({writable:E.fromWeb(N)});if(typeof N=="function"){const{value:U,write:re,final:ie,destroy:ee}=ne(N);if(o(U))return I(F,U,{objectMode:!0,write:re,final:ie,destroy:ee});const oe=U==null?void 0:U.then;if(typeof oe=="function"){let X;const Xe=k(oe,U,M=>{if(M!=null)throw new u("nully","body",M)},M=>{y(X,M)});return X=new F({objectMode:!0,readable:!1,write:re,final(M){ie(async()=>{try{await Xe,e.nextTick(M,null)}catch(le){e.nextTick(M,le)}})},destroy:ee})}throw new u("Iterable, AsyncIterable or AsyncFunction",C,U)}if(R(N))return H(N.arrayBuffer());if(o(N))return I(F,N,{objectMode:!0,writable:!1});if(c(N==null?void 0:N.readable)&&p(N==null?void 0:N.writable))return F.fromWeb(N);if(typeof(N==null?void 0:N.writable)=="object"||typeof(N==null?void 0:N.readable)=="object"){const U=N!=null&&N.readable?i(N==null?void 0:N.readable)?N==null?void 0:N.readable:H(N.readable):void 0,re=N!=null&&N.writable?l(N==null?void 0:N.writable)?N==null?void 0:N.writable:H(N.writable):void 0;return se({readable:U,writable:re})}const J=N==null?void 0:N.then;if(typeof J=="function"){let U;return k(J,N,re=>{re!=null&&U.push(re),U.push(null)},re=>{y(U,re)}),U=new F({objectMode:!0,writable:!1,read(){}})}throw new s(C,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],N)};function ne(H){let{promise:N,resolve:C}=S();const J=new V,U=J.signal;return{value:H(async function*(){for(;;){const ie=N;N=null;const{chunk:ee,done:oe,cb:X}=await ie;if(e.nextTick(X),oe)return;if(U.aborted)throw new d(void 0,{cause:U.reason});({promise:N,resolve:C}=S()),yield ee}}(),{signal:U}),write(ie,ee,oe){const X=C;C=null,X({chunk:ie,done:!1,cb:oe})},final(ie){const ee=C;C=null,ee({done:!0,cb:ie})},destroy(ie,ee){J.abort(),ee(ie)}}}function se(H){const N=H.readable&&typeof H.readable.read!="function"?v.wrap(H.readable):H.readable,C=H.writable;let J=!!n(N),U=!!r(C),re,ie,ee,oe,X;function Xe(M){const le=oe;oe=null,le?le(M):M&&X.destroy(M)}return X=new F({readableObjectMode:!!(N!=null&&N.readableObjectMode),writableObjectMode:!!(C!=null&&C.writableObjectMode),readable:J,writable:U}),U&&(g(C,M=>{U=!1,M&&y(N,M),Xe(M)}),X._write=function(M,le,Je){C.write(M,le)?Je():re=Je},X._final=function(M){C.end(),ie=M},C.on("drain",function(){if(re){const M=re;re=null,M()}}),C.on("finish",function(){if(ie){const M=ie;ie=null,M()}})),J&&(g(N,M=>{J=!1,M&&y(N,M),Xe(M)}),N.on("readable",function(){if(ee){const M=ee;ee=null,M()}}),N.on("end",function(){X.push(null)}),X._read=function(){for(;;){const M=N.read();if(M===null){ee=X._read;return}if(!X.push(M))return}}),X._destroy=function(M,le){!M&&oe!==null&&(M=new d),ee=null,re=null,ie=null,oe===null?le(M):(oe=le,y(C,M),y(N,M))},X}return kr}var $r,Vo;function nt(){if(Vo)return $r;Vo=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=te;$r=i;const o=tr(),a=Ni();r(i.prototype,o.prototype),r(i,o);{const p=n(a.prototype);for(let g=0;g<p.length;g++){const d=p[g];i.prototype[d]||(i.prototype[d]=a.prototype[d])}}function i(p){if(!(this instanceof i))return new i(p);o.call(this,p),a.call(this,p),p?(this.allowHalfOpen=p.allowHalfOpen!==!1,p.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),p.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(i.prototype,{writable:{__proto__:null,...t(a.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(a.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(a.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(a.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(a.prototype,"writableLength")},writableFinished:{__proto__:null,...t(a.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(a.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(a.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(a.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(p){this._readableState&&this._writableState&&(this._readableState.destroyed=p,this._writableState.destroyed=p)}}});let l;function f(){return l===void 0&&(l={}),l}i.fromWeb=function(p,g){return f().newStreamDuplexFromReadableWritablePair(p,g)},i.toWeb=function(p){return f().newReadableWritablePairFromDuplex(p)};let c;return i.from=function(p){return c||(c=ef()),c(p,"body")},$r}const{ObjectSetPrototypeOf:gs,Symbol:tf}=te;var ys=rt;const{ERR_METHOD_NOT_IMPLEMENTED:nf}=me.codes,Di=nt(),{getHighWaterMark:rf}=er;gs(rt.prototype,Di.prototype);gs(rt,Di);const fn=tf("kCallback");function rt(e){if(!(this instanceof rt))return new rt(e);const t=e?rf(this,e,"readableHighWaterMark",!0):null;t===0&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),Di.call(this,e),this._readableState.sync=!1,this[fn]=null,e&&(typeof e.transform=="function"&&(this._transform=e.transform),typeof e.flush=="function"&&(this._flush=e.flush)),this.on("prefinish",of)}function hi(e){typeof this._flush=="function"&&!this.destroyed?this._flush((t,n)=>{if(t){e?e(t):this.destroy(t);return}n!=null&&this.push(n),this.push(null),e&&e()}):(this.push(null),e&&e())}function of(){this._final!==hi&&hi.call(this)}rt.prototype._final=hi;rt.prototype._transform=function(e,t,n){throw new nf("_transform()")};rt.prototype._write=function(e,t,n){const r=this._readableState,o=this._writableState,a=r.length;this._transform(e,t,(i,l)=>{if(i){n(i);return}l!=null&&this.push(l),o.ended||a===r.length||r.length<r.highWaterMark?n():this[fn]=n})};rt.prototype._read=function(){if(this[fn]){const e=this[fn];this[fn]=null,e()}};const{ObjectSetPrototypeOf:bs}=te;var ws=Ct;const Oi=ys;bs(Ct.prototype,Oi.prototype);bs(Ct,Oi);function Ct(e){if(!(this instanceof Ct))return new Ct(e);Oi.call(this,e)}Ct.prototype._transform=function(e,t,n){n(null,e)};const an=Lt,{ArrayIsArray:af,Promise:sf,SymbolAsyncIterator:lf,SymbolDispose:cf}=te,Un=pt,{once:df}=ve,uf=zt,Go=nt(),{aggregateTwoErrors:ff,codes:{ERR_INVALID_ARG_TYPE:pi,ERR_INVALID_RETURN_VALUE:Mr,ERR_MISSING_ARGS:hf,ERR_STREAM_DESTROYED:pf,ERR_STREAM_PREMATURE_CLOSE:gf},AbortError:yf}=me,{validateFunction:bf,validateAbortSignal:wf}=yn,{isIterable:_t,isReadable:Pr,isReadableNodeStream:$n,isNodeStream:qo,isTransformStream:Ht,isWebStream:vf,isReadableStream:Fr,isReadableFinished:_f}=ot,mf=globalThis.AbortController||hn().AbortController;let Wr,Jr,Ur;function Co(e,t,n){let r=!1;e.on("close",()=>{r=!0});const o=Un(e,{readable:t,writable:n},a=>{r=!a});return{destroy:a=>{r||(r=!0,uf.destroyer(e,a||new pf("pipe")))},cleanup:o}}function Sf(e){return bf(e[e.length-1],"streams[stream.length - 1]"),e.pop()}function Hr(e){if(_t(e))return e;if($n(e))return Ef(e);throw new pi("val",["Readable","Iterable","AsyncIterable"],e)}async function*Ef(e){Jr||(Jr=tr()),yield*Jr.prototype[lf].call(e)}async function xn(e,t,n,{end:r}){let o,a=null;const i=c=>{if(c&&(o=c),a){const p=a;a=null,p()}},l=()=>new sf((c,p)=>{o?p(o):a=()=>{o?p(o):c()}});t.on("drain",i);const f=Un(t,{readable:!1},i);try{t.writableNeedDrain&&await l();for await(const c of e)t.write(c)||await l();r&&(t.end(),await l()),n()}catch(c){n(o!==c?ff(o,c):c)}finally{f(),t.off("drain",i)}}async function Br(e,t,n,{end:r}){Ht(t)&&(t=t.writable);const o=t.getWriter();try{for await(const a of e)await o.ready,o.write(a).catch(()=>{});await o.ready,r&&await o.close(),n()}catch(a){try{await o.abort(a),n(a)}catch(i){n(i)}}}function Rf(...e){return vs(e,df(Sf(e)))}function vs(e,t,n){if(e.length===1&&af(e[0])&&(e=e[0]),e.length<2)throw new hf("streams");const r=new mf,o=r.signal,a=n==null?void 0:n.signal,i=[];wf(a,"options.signal");function l(){u(new yf)}Ur=Ur||ve.addAbortListener;let f;a&&(f=Ur(a,l));let c,p;const g=[];let d=0;function s(E){u(E,--d===0)}function u(E,S){var I;if(E&&(!c||c.code==="ERR_STREAM_PREMATURE_CLOSE")&&(c=E),!(!c&&!S)){for(;g.length;)g.shift()(c);(I=f)===null||I===void 0||I[cf](),r.abort(),S&&(c||i.forEach(x=>x()),an.nextTick(t,c,p))}}let y;for(let E=0;E<e.length;E++){const S=e[E],I=E<e.length-1,x=E>0,R=I||(n==null?void 0:n.end)!==!1,V=E===e.length-1;if(qo(S)){let k=function(F){F&&F.name!=="AbortError"&&F.code!=="ERR_STREAM_PREMATURE_CLOSE"&&s(F)};if(R){const{destroy:F,cleanup:ne}=Co(S,I,x);g.push(F),Pr(S)&&V&&i.push(ne)}S.on("error",k),Pr(S)&&V&&i.push(()=>{S.removeListener("error",k)})}if(E===0)if(typeof S=="function"){if(y=S({signal:o}),!_t(y))throw new Mr("Iterable, AsyncIterable or Stream","source",y)}else _t(S)||$n(S)||Ht(S)?y=S:y=Go.from(S);else if(typeof S=="function"){if(Ht(y)){var w;y=Hr((w=y)===null||w===void 0?void 0:w.readable)}else y=Hr(y);if(y=S(y,{signal:o}),I){if(!_t(y,!0))throw new Mr("AsyncIterable",`transform[${E-1}]`,y)}else{var v;Wr||(Wr=ws);const k=new Wr({objectMode:!0}),F=(v=y)===null||v===void 0?void 0:v.then;if(typeof F=="function")d++,F.call(y,H=>{p=H,H!=null&&k.write(H),R&&k.end(),an.nextTick(s)},H=>{k.destroy(H),an.nextTick(s,H)});else if(_t(y,!0))d++,xn(y,k,s,{end:R});else if(Fr(y)||Ht(y)){const H=y.readable||y;d++,xn(H,k,s,{end:R})}else throw new Mr("AsyncIterable or Promise","destination",y);y=k;const{destroy:ne,cleanup:se}=Co(y,!1,!0);g.push(ne),V&&i.push(se)}}else if(qo(S)){if($n(y)){d+=2;const k=If(y,S,s,{end:R});Pr(S)&&V&&i.push(k)}else if(Ht(y)||Fr(y)){const k=y.readable||y;d++,xn(k,S,s,{end:R})}else if(_t(y))d++,xn(y,S,s,{end:R});else throw new pi("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],y);y=S}else if(vf(S)){if($n(y))d++,Br(Hr(y),S,s,{end:R});else if(Fr(y)||_t(y))d++,Br(y,S,s,{end:R});else if(Ht(y))d++,Br(y.readable,S,s,{end:R});else throw new pi("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],y);y=S}else y=Go.from(S)}return(o!=null&&o.aborted||a!=null&&a.aborted)&&an.nextTick(l),y}function If(e,t,n,{end:r}){let o=!1;if(t.on("close",()=>{o||n(new gf)}),e.pipe(t,{end:!1}),r){let a=function(){o=!0,t.end()};_f(e)?an.nextTick(a):e.once("end",a)}else n();return Un(e,{readable:!0,writable:!1},a=>{const i=e._readableState;a&&a.code==="ERR_STREAM_PREMATURE_CLOSE"&&i&&i.ended&&!i.errored&&!i.errorEmitted?e.once("end",n).once("error",n):n(a)}),Un(t,{readable:!1,writable:!0},n)}var Li={pipelineImpl:vs,pipeline:Rf};const{pipeline:Af}=Li,Nn=nt(),{destroyer:xf}=zt,{isNodeStream:Dn,isReadable:Xo,isWritable:zo,isWebStream:Vr,isTransformStream:vt,isWritableStream:Ko,isReadableStream:Yo}=ot,{AbortError:Nf,codes:{ERR_INVALID_ARG_VALUE:Qo,ERR_MISSING_ARGS:Df}}=me,Of=pt;var _s=function(...t){if(t.length===0)throw new Df("streams");if(t.length===1)return Nn.from(t[0]);const n=[...t];if(typeof t[0]=="function"&&(t[0]=Nn.from(t[0])),typeof t[t.length-1]=="function"){const s=t.length-1;t[s]=Nn.from(t[s])}for(let s=0;s<t.length;++s)if(!(!Dn(t[s])&&!Vr(t[s]))){if(s<t.length-1&&!(Xo(t[s])||Yo(t[s])||vt(t[s])))throw new Qo(`streams[${s}]`,n[s],"must be readable");if(s>0&&!(zo(t[s])||Ko(t[s])||vt(t[s])))throw new Qo(`streams[${s}]`,n[s],"must be writable")}let r,o,a,i,l;function f(s){const u=i;i=null,u?u(s):s?l.destroy(s):!d&&!g&&l.destroy()}const c=t[0],p=Af(t,f),g=!!(zo(c)||Ko(c)||vt(c)),d=!!(Xo(p)||Yo(p)||vt(p));if(l=new Nn({writableObjectMode:!!(c!=null&&c.writableObjectMode),readableObjectMode:!!(p!=null&&p.readableObjectMode),writable:g,readable:d}),g){if(Dn(c))l._write=function(u,y,w){c.write(u,y)?w():r=w},l._final=function(u){c.end(),o=u},c.on("drain",function(){if(r){const u=r;r=null,u()}});else if(Vr(c)){const y=(vt(c)?c.writable:c).getWriter();l._write=async function(w,v,E){try{await y.ready,y.write(w).catch(()=>{}),E()}catch(S){E(S)}},l._final=async function(w){try{await y.ready,y.close().catch(()=>{}),o=w}catch(v){w(v)}}}const s=vt(p)?p.readable:p;Of(s,()=>{if(o){const u=o;o=null,u()}})}if(d){if(Dn(p))p.on("readable",function(){if(a){const s=a;a=null,s()}}),p.on("end",function(){l.push(null)}),l._read=function(){for(;;){const s=p.read();if(s===null){a=l._read;return}if(!l.push(s))return}};else if(Vr(p)){const u=(vt(p)?p.readable:p).getReader();l._read=async function(){for(;;)try{const{value:y,done:w}=await u.read();if(!l.push(y))return;if(w){l.push(null);return}}catch{return}}}}return l._destroy=function(s,u){!s&&i!==null&&(s=new Nf),a=null,r=null,o=null,i===null?u(s):(i=u,Dn(p)&&xf(p,s))},l};const Lf=globalThis.AbortController||hn().AbortController,{codes:{ERR_INVALID_ARG_VALUE:Tf,ERR_INVALID_ARG_TYPE:bn,ERR_MISSING_ARGS:jf,ERR_OUT_OF_RANGE:kf},AbortError:qe}=me,{validateAbortSignal:kt,validateInteger:Zo,validateObject:$t}=yn,$f=te.Symbol("kWeak"),Mf=te.Symbol("kResistStopPropagation"),{finished:Pf}=pt,Ff=_s,{addAbortSignalNoValidate:Wf}=Zn,{isWritable:Jf,isNodeStream:Uf}=ot,{deprecate:Hf}=ve,{ArrayPrototypePush:Bf,Boolean:Vf,MathFloor:ea,Number:Gf,NumberIsNaN:qf,Promise:ta,PromiseReject:na,PromiseResolve:Cf,PromisePrototypeThen:ra,Symbol:ms}=te,Hn=ms("kEmpty"),ia=ms("kEof");function Xf(e,t){if(t!=null&&$t(t,"options"),(t==null?void 0:t.signal)!=null&&kt(t.signal,"options.signal"),Uf(e)&&!Jf(e))throw new Tf("stream",e,"must be writable");const n=Ff(this,e);return t!=null&&t.signal&&Wf(t.signal,n),n}function nr(e,t){if(typeof e!="function")throw new bn("fn",["Function","AsyncFunction"],e);t!=null&&$t(t,"options"),(t==null?void 0:t.signal)!=null&&kt(t.signal,"options.signal");let n=1;(t==null?void 0:t.concurrency)!=null&&(n=ea(t.concurrency));let r=n-1;return(t==null?void 0:t.highWaterMark)!=null&&(r=ea(t.highWaterMark)),Zo(n,"options.concurrency",1),Zo(r,"options.highWaterMark",0),r+=n,(async function*(){const a=ve.AbortSignalAny([t==null?void 0:t.signal].filter(Vf)),i=this,l=[],f={signal:a};let c,p,g=!1,d=0;function s(){g=!0,u()}function u(){d-=1,y()}function y(){p&&!g&&d<n&&l.length<r&&(p(),p=null)}async function w(){try{for await(let v of i){if(g)return;if(a.aborted)throw new qe;try{if(v=e(v,f),v===Hn)continue;v=Cf(v)}catch(E){v=na(E)}d+=1,ra(v,u,s),l.push(v),c&&(c(),c=null),!g&&(l.length>=r||d>=n)&&await new ta(E=>{p=E})}l.push(ia)}catch(v){const E=na(v);ra(E,u,s),l.push(E)}finally{g=!0,c&&(c(),c=null)}}w();try{for(;;){for(;l.length>0;){const v=await l[0];if(v===ia)return;if(a.aborted)throw new qe;v!==Hn&&(yield v),l.shift(),y()}await new ta(v=>{c=v})}}finally{g=!0,p&&(p(),p=null)}}).call(this)}function zf(e=void 0){return e!=null&&$t(e,"options"),(e==null?void 0:e.signal)!=null&&kt(e.signal,"options.signal"),(async function*(){let n=0;for await(const o of this){var r;if(e!=null&&(r=e.signal)!==null&&r!==void 0&&r.aborted)throw new qe({cause:e.signal.reason});yield[n++,o]}}).call(this)}async function Ss(e,t=void 0){for await(const n of Ti.call(this,e,t))return!0;return!1}async function Kf(e,t=void 0){if(typeof e!="function")throw new bn("fn",["Function","AsyncFunction"],e);return!await Ss.call(this,async(...n)=>!await e(...n),t)}async function Yf(e,t){for await(const n of Ti.call(this,e,t))return n}async function Qf(e,t){if(typeof e!="function")throw new bn("fn",["Function","AsyncFunction"],e);async function n(r,o){return await e(r,o),Hn}for await(const r of nr.call(this,n,t));}function Ti(e,t){if(typeof e!="function")throw new bn("fn",["Function","AsyncFunction"],e);async function n(r,o){return await e(r,o)?r:Hn}return nr.call(this,n,t)}class Zf extends jf{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function eh(e,t,n){var r;if(typeof e!="function")throw new bn("reducer",["Function","AsyncFunction"],e);n!=null&&$t(n,"options"),(n==null?void 0:n.signal)!=null&&kt(n.signal,"options.signal");let o=arguments.length>1;if(n!=null&&(r=n.signal)!==null&&r!==void 0&&r.aborted){const c=new qe(void 0,{cause:n.signal.reason});throw this.once("error",()=>{}),await Pf(this.destroy(c)),c}const a=new Lf,i=a.signal;if(n!=null&&n.signal){const c={once:!0,[$f]:this,[Mf]:!0};n.signal.addEventListener("abort",()=>a.abort(),c)}let l=!1;try{for await(const c of this){var f;if(l=!0,n!=null&&(f=n.signal)!==null&&f!==void 0&&f.aborted)throw new qe;o?t=await e(t,c,{signal:i}):(t=c,o=!0)}if(!l&&!o)throw new Zf}finally{a.abort()}return t}async function th(e){e!=null&&$t(e,"options"),(e==null?void 0:e.signal)!=null&&kt(e.signal,"options.signal");const t=[];for await(const r of this){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new qe(void 0,{cause:e.signal.reason});Bf(t,r)}return t}function nh(e,t){const n=nr.call(this,e,t);return(async function*(){for await(const o of n)yield*o}).call(this)}function Es(e){if(e=Gf(e),qf(e))return 0;if(e<0)throw new kf("number",">= 0",e);return e}function rh(e,t=void 0){return t!=null&&$t(t,"options"),(t==null?void 0:t.signal)!=null&&kt(t.signal,"options.signal"),e=Es(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new qe;for await(const a of this){var o;if(t!=null&&(o=t.signal)!==null&&o!==void 0&&o.aborted)throw new qe;e--<=0&&(yield a)}}).call(this)}function ih(e,t=void 0){return t!=null&&$t(t,"options"),(t==null?void 0:t.signal)!=null&&kt(t.signal,"options.signal"),e=Es(e),(async function*(){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new qe;for await(const a of this){var o;if(t!=null&&(o=t.signal)!==null&&o!==void 0&&o.aborted)throw new qe;if(e-- >0&&(yield a),e<=0)return}}).call(this)}Si.streamReturningOperators={asIndexedPairs:Hf(zf,"readable.asIndexedPairs will be removed in a future version."),drop:rh,filter:Ti,flatMap:nh,map:nr,take:ih,compose:Xf};Si.promiseReturningOperators={every:Kf,forEach:Qf,reduce:eh,toArray:th,some:Ss,find:Yf};var Gr,oa;function Rs(){if(oa)return Gr;oa=1;const{ArrayPrototypePop:e,Promise:t}=te,{isIterable:n,isNodeStream:r,isWebStream:o}=ot,{pipelineImpl:a}=Li,{finished:i}=pt;Is();function l(...f){return new t((c,p)=>{let g,d;const s=f[f.length-1];if(s&&typeof s=="object"&&!r(s)&&!n(s)&&!o(s)){const u=e(f);g=u.signal,d=u.end}a(f,(u,y)=>{u?p(u):c(y)},{signal:g,end:d})})}return Gr={finished:i,pipeline:l},Gr}var aa;function Is(){if(aa)return Nr.exports;aa=1;const{Buffer:e}=Ot,{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=te,{promisify:{custom:o}}=ve,{streamReturningOperators:a,promiseReturningOperators:i}=Si,{codes:{ERR_ILLEGAL_CONSTRUCTOR:l}}=me,f=_s,{setDefaultHighWaterMark:c,getDefaultHighWaterMark:p}=er,{pipeline:g}=Li,{destroyer:d}=zt,s=pt,u=Rs(),y=ot,w=Nr.exports=xi.Stream;w.isDestroyed=y.isDestroyed,w.isDisturbed=y.isDisturbed,w.isErrored=y.isErrored,w.isReadable=y.isReadable,w.isWritable=y.isWritable,w.Readable=tr();for(const E of n(a)){let I=function(...x){if(new.target)throw l();return w.Readable.from(r(S,this,x))};const S=a[E];t(I,"name",{__proto__:null,value:S.name}),t(I,"length",{__proto__:null,value:S.length}),t(w.Readable.prototype,E,{__proto__:null,value:I,enumerable:!1,configurable:!0,writable:!0})}for(const E of n(i)){let I=function(...x){if(new.target)throw l();return r(S,this,x)};const S=i[E];t(I,"name",{__proto__:null,value:S.name}),t(I,"length",{__proto__:null,value:S.length}),t(w.Readable.prototype,E,{__proto__:null,value:I,enumerable:!1,configurable:!0,writable:!0})}w.Writable=Ni(),w.Duplex=nt(),w.Transform=ys,w.PassThrough=ws,w.pipeline=g;const{addAbortSignal:v}=Zn;return w.addAbortSignal=v,w.finished=s,w.destroy=d,w.compose=f,w.setDefaultHighWaterMark=c,w.getDefaultHighWaterMark=p,t(w,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return u}}),t(g,o,{__proto__:null,enumerable:!0,get(){return u.pipeline}}),t(s,o,{__proto__:null,enumerable:!0,get(){return u.finished}}),w.Stream=w,w._isUint8Array=function(S){return S instanceof Uint8Array},w._uint8ArrayToBuffer=function(S){return e.from(S.buffer,S.byteOffset,S.byteLength)},Nr.exports}(function(e){const t=Is(),n=Rs(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports})($a);var oh=$a.exports;async function ah(e){const t=[];for await(const n of e)t.push(n);return t}class St extends oh.Readable{constructor(t,{baseIRI:n,compact:r,context:o={},encoding:a="object",flatten:i,frame:l,prettyPrint:f,skipContext:c}={}){super({objectMode:!0,read:()=>{}}),this.compact=r,this.context=o,this.encoding=a,this.flatten=i,this.frame=l,this.prettyPrint=f,this.skipContext=c,n&&(this.context["@base"]=n.value||n.toString()),t.on("prefix",(p,g)=>{this.context[p]||(this.context[p]=g.value)}),this.handleData(t)}async handleData(t){try{const n=(await ah(t)).map(St.toJsonldQuad),r=await In.fromRDF(n),o=await this.transform(r,this.options);this.push(o),this.push(null)}catch(n){this.emit("error",n)}}async transform(t){return this.compact&&(t=await In.compact(t,this.context)),this.flatten&&(t=await In.flatten(t,this.context)),this.frame&&(t=await In.frame(t,this.context)),this.skipContext&&t["@context"]&&delete t["@context"],this.encoding==="string"?this.prettyPrint?JSON.stringify(t,null,2):JSON.stringify(t):t}static toJsonldQuad(t){return{subject:St.toJsonldTerm(t.subject),predicate:St.toJsonldTerm(t.predicate),object:St.toJsonldTerm(t.object),graph:St.toJsonldTerm(t.graph)}}static toJsonldTerm(t){return t.termType==="BlankNode"?{termType:"BlankNode",value:`_:${t.value}`}:t}}class vh extends Fs{constructor(t){super(St,t)}}export{vh as default};
