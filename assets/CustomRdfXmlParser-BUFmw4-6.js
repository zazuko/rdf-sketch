import{c as y,a as M,s as G,d as L,v as k}from"./main-BSH5gHhL.js";var T={},m={},I={};Object.defineProperty(I,"__esModule",{value:!0});I.ParseError=void 0;class B extends Error{constructor(e,t){const r=e.saxParser;super(e.trackPosition?`Line ${r.line} column ${r.column+1}: ${t}`:t)}}I.ParseError=B;var O={},w={};Object.defineProperty(w,"__esModule",{value:!0});w.BlankNode=void 0;class q{constructor(e){this.termType="BlankNode",this.value=e}equals(e){return!!e&&e.termType==="BlankNode"&&e.value===this.value}}w.BlankNode=q;var j={},E={};Object.defineProperty(E,"__esModule",{value:!0});E.DefaultGraph=void 0;class _{constructor(){this.termType="DefaultGraph",this.value=""}equals(e){return!!e&&e.termType==="DefaultGraph"}}E.DefaultGraph=_;_.INSTANCE=new _;var S={},N={};Object.defineProperty(N,"__esModule",{value:!0});N.NamedNode=void 0;class V{constructor(e){this.termType="NamedNode",this.value=e}equals(e){return!!e&&e.termType==="NamedNode"&&e.value===this.value}}N.NamedNode=V;Object.defineProperty(S,"__esModule",{value:!0});S.Literal=void 0;const $=N;class F{constructor(e,t){this.termType="Literal",this.value=e,typeof t=="string"?(this.language=t,this.datatype=F.RDF_LANGUAGE_STRING):t?(this.language="",this.datatype=t):(this.language="",this.datatype=F.XSD_STRING)}equals(e){return!!e&&e.termType==="Literal"&&e.value===this.value&&e.language===this.language&&this.datatype.equals(e.datatype)}}S.Literal=F;F.RDF_LANGUAGE_STRING=new $.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString");F.XSD_STRING=new $.NamedNode("http://www.w3.org/2001/XMLSchema#string");var D={};Object.defineProperty(D,"__esModule",{value:!0});D.Quad=void 0;class g{constructor(e,t,r,a){this.termType="Quad",this.value="",this.subject=e,this.predicate=t,this.object=r,this.graph=a}equals(e){return!!e&&(e.termType==="Quad"||!e.termType)&&this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)&&this.graph.equals(e.graph)}}D.Quad=g;var P={};Object.defineProperty(P,"__esModule",{value:!0});P.Variable=void 0;class A{constructor(e){this.termType="Variable",this.value=e}equals(e){return!!e&&e.termType==="Variable"&&e.value===this.value}}P.Variable=A;Object.defineProperty(j,"__esModule",{value:!0});j.DataFactory=void 0;const U=w,Q=E,C=S,Y=N,K=D,z=P;let H=0;class Z{constructor(e){this.blankNodeCounter=0,e=e||{},this.blankNodePrefix=e.blankNodePrefix||`df_${H++}_`}namedNode(e){return new Y.NamedNode(e)}blankNode(e){return new U.BlankNode(e||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(e,t){return new C.Literal(e,t)}variable(e){return new z.Variable(e)}defaultGraph(){return Q.DefaultGraph.INSTANCE}quad(e,t,r,a){return new K.Quad(e,t,r,a||this.defaultGraph())}fromTerm(e){switch(e.termType){case"NamedNode":return this.namedNode(e.value);case"BlankNode":return this.blankNode(e.value);case"Literal":return e.language?this.literal(e.value,e.language):e.datatype.equals(C.Literal.XSD_STRING)?this.literal(e.value):this.literal(e.value,this.fromTerm(e.datatype));case"Variable":return this.variable(e.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(e.subject),this.fromTerm(e.predicate),this.fromTerm(e.object),this.fromTerm(e.graph))}}fromQuad(e){return this.fromTerm(e)}resetBlankNodeCounter(){this.blankNodeCounter=0}}j.DataFactory=Z;(function(l){var e=y&&y.__createBinding||(Object.create?function(r,a,s,o){o===void 0&&(o=s);var d=Object.getOwnPropertyDescriptor(a,s);(!d||("get"in d?!a.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return a[s]}}),Object.defineProperty(r,o,d)}:function(r,a,s,o){o===void 0&&(o=s),r[o]=a[s]}),t=y&&y.__exportStar||function(r,a){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&e(a,r,s)};Object.defineProperty(l,"__esModule",{value:!0}),t(w,l),t(j,l),t(E,l),t(S,l),t(N,l),t(D,l),t(P,l)})(O);Object.defineProperty(m,"__esModule",{value:!0});m.ParseType=m.RdfXmlParser=void 0;const x=M,J=G,R=L,W=I,X=O,v=k;class n extends R.Transform{constructor(e){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},e&&(Object.assign(this,e),this.options=e),this.dataFactory||(this.dataFactory=new X.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),this.validateUri!==!1&&(this.validateUri=!0),this.iriValidationStrategy||(this.iriValidationStrategy=this.validateUri?v.IriValidationStrategy.Pragmatic:v.IriValidationStrategy.None),this.saxParser=new J.SaxesParser({xmlns:!0,position:this.trackPosition}),this.attachSaxListeners()}import(e){const t=new R.PassThrough({readableObjectMode:!0});e.on("error",a=>r.emit("error",a)),e.on("data",a=>t.push(a)),e.on("end",()=>t.push(null));const r=t.pipe(new n(this.options));return r}_transform(e,t,r){try{this.saxParser.write(e)}catch(a){return r(a)}r()}newParseError(e){return new W.ParseError(this,e)}valueToUri(e,t){return this.uriToNamedNode((0,x.resolve)(e,t.baseIRI))}uriToNamedNode(e){const t=(0,v.validateIri)(e,this.iriValidationStrategy);if(t instanceof Error)throw this.newParseError(t.message);return this.dataFactory.namedNode(e)}validateNcname(e){if(!n.NCNAME_MATCHER.test(e))throw this.newParseError(`Not a valid NCName: ${e}`)}attachSaxListeners(){this.saxParser.on("error",e=>this.emit("error",e)),this.saxParser.on("opentag",this.onTag.bind(this)),this.saxParser.on("text",this.onText.bind(this)),this.saxParser.on("cdata",this.onText.bind(this)),this.saxParser.on("closetag",this.onCloseTag.bind(this)),this.saxParser.on("doctype",this.onDoctype.bind(this))}onTag(e){const t=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let r=b.RESOURCE;if(t&&(t.hadChildren=!0,r=t.childrenParseType),t&&t.childrenStringTags){const s=e.name;let o="";for(const p in e.attributes)o+=` ${p}="${e.attributes[p].value}"`;const h=`<${`${s}${o}`}>`;t.childrenStringTags.push(h);const f={childrenStringTags:t.childrenStringTags};f.childrenStringEmitClosingTag=`</${s}>`,this.activeTagStack.push(f);return}const a={};t?(a.language=t.language,a.baseIRI=t.baseIRI):a.baseIRI=this.baseIRI,this.activeTagStack.push(a),r===b.RESOURCE?this.onTagResource(e,a,t,!t):this.onTagProperty(e,a,t)}onTagResource(e,t,r,a){t.childrenParseType=b.PROPERTY;let s=!0;if(e.uri===n.RDF){if(!a&&n.FORBIDDEN_NODE_ELEMENTS.indexOf(e.local)>=0)throw this.newParseError(`Illegal node element name: ${e.local}`);switch(e.local){case"RDF":t.childrenParseType=b.RESOURCE;case"Description":s=!1}}const o=[],d=[];let h=null,f=!1,p=!1,i=null;for(const c in e.attributes){const u=e.attributes[c];if(r&&u.uri===n.RDF)switch(u.local){case"about":if(h)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${u.value} and ${h} where found.`);h=u.value;continue;case"ID":if(h)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${u.value} and ${h} where found.`);this.validateNcname(u.value),h="#"+u.value,f=!0;continue;case"nodeID":if(h)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${u.value} and ${h} where found.`);this.validateNcname(u.value),h=u.value,p=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":i=u.value;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(u.uri===n.XML){if(u.local==="lang"){t.language=u.value===""?null:u.value.toLowerCase();continue}else if(u.local==="base"){t.baseIRI=(0,x.resolve)(u.value,t.baseIRI);continue}}u.prefix!=="xml"&&u.prefix!=="xmlns"&&(u.prefix!==""||u.local!=="xmlns")&&u.uri&&(o.push(this.uriToNamedNode(u.uri+u.local)),d.push(u.value))}if(h!==null&&(t.subject=p?this.dataFactory.blankNode(h):this.valueToUri(h,t),f&&this.claimNodeId(t.subject)),t.subject||(t.subject=this.dataFactory.blankNode()),s){const c=this.uriToNamedNode(e.uri+e.local);this.emitTriple(t.subject,this.dataFactory.namedNode(n.RDF+"type"),c,r?r.reifiedStatementId:null)}if(r){if(r.predicate)if(r.childrenCollectionSubject){const c=this.dataFactory.blankNode();this.emitTriple(r.childrenCollectionSubject,r.childrenCollectionPredicate,c,r.reifiedStatementId),this.emitTriple(c,this.dataFactory.namedNode(n.RDF+"first"),t.subject,t.reifiedStatementId),r.childrenCollectionSubject=c,r.childrenCollectionPredicate=this.dataFactory.namedNode(n.RDF+"rest")}else{this.emitTriple(r.subject,r.predicate,t.subject,r.reifiedStatementId);for(let c=0;c<r.predicateSubPredicates.length;c++)this.emitTriple(t.subject,r.predicateSubPredicates[c],r.predicateSubObjects[c],null);r.predicateSubPredicates=[],r.predicateSubObjects=[],r.predicateEmitted=!0}for(let c=0;c<o.length;c++){const u=this.dataFactory.literal(d[c],t.datatype||t.language);this.emitTriple(t.subject,o[c],u,r.reifiedStatementId)}i&&this.emitTriple(t.subject,this.dataFactory.namedNode(n.RDF+"type"),this.uriToNamedNode(i),null)}}onTagProperty(e,t,r){if(t.childrenParseType=b.RESOURCE,t.subject=r.subject,e.uri===n.RDF&&e.local==="li"?(r.listItemCounter||(r.listItemCounter=1),t.predicate=this.uriToNamedNode(e.uri+"_"+r.listItemCounter++)):t.predicate=this.uriToNamedNode(e.uri+e.local),e.uri===n.RDF&&n.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(e.local)>=0)throw this.newParseError(`Illegal property element name: ${e.local}`);t.predicateSubPredicates=[],t.predicateSubObjects=[];let a=!1,s=!1,o=null,d=!0;const h=[],f=[];for(const p in e.attributes){const i=e.attributes[p];if(i.uri===n.RDF)switch(i.local){case"resource":if(o)throw this.newParseError(`Found both rdf:resource (${i.value}) and rdf:nodeID (${o}).`);if(a)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${i.value})`);t.hadChildren=!0,o=i.value,d=!1;continue;case"datatype":if(s)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${i.value}).`);if(a)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${i.value})`);t.datatype=this.valueToUri(i.value,t);continue;case"nodeID":if(s)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${i.value}).`);if(t.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${i.value}).`);if(a)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${i.value})`);this.validateNcname(i.value),t.hadChildren=!0,o=i.value,d=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(s)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(t.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${t.datatype.value})`);if(o)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${o})`);if(i.value==="Resource"){a=!0,t.childrenParseType=b.PROPERTY;const c=this.dataFactory.blankNode();this.emitTriple(t.subject,t.predicate,c,t.reifiedStatementId),t.subject=c,t.predicate=null}else i.value==="Collection"?(a=!0,t.hadChildren=!0,t.childrenCollectionSubject=t.subject,t.childrenCollectionPredicate=t.predicate,d=!1):i.value==="Literal"&&(a=!0,t.childrenTagsToString=!0,t.childrenStringTags=[]);continue;case"ID":this.validateNcname(i.value),t.reifiedStatementId=this.valueToUri("#"+i.value,t),this.claimNodeId(t.reifiedStatementId);continue}else if(i.uri===n.XML&&i.local==="lang"){t.language=i.value===""?null:i.value.toLowerCase();continue}if(i.prefix!=="xml"&&i.prefix!=="xmlns"&&(i.prefix!==""||i.local!=="xmlns")&&i.uri){if(a||t.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${i.value}`);t.hadChildren=!0,s=!0,h.push(this.uriToNamedNode(i.uri+i.local)),f.push(this.dataFactory.literal(i.value,t.datatype||t.language))}}if(o!==null){const p=t.subject;t.subject=d?this.dataFactory.blankNode(o):this.valueToUri(o,t),this.emitTriple(p,t.predicate,t.subject,t.reifiedStatementId);for(let i=0;i<h.length;i++)this.emitTriple(t.subject,h[i],f[i],null);t.predicateEmitted=!0}else d&&(t.predicateSubPredicates=h,t.predicateSubObjects=f,t.predicateEmitted=!1)}emitTriple(e,t,r,a){this.push(this.dataFactory.quad(e,t,r,this.defaultGraph)),a&&(this.push(this.dataFactory.quad(a,this.dataFactory.namedNode(n.RDF+"type"),this.dataFactory.namedNode(n.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(a,this.dataFactory.namedNode(n.RDF+"subject"),e,this.defaultGraph)),this.push(this.dataFactory.quad(a,this.dataFactory.namedNode(n.RDF+"predicate"),t,this.defaultGraph)),this.push(this.dataFactory.quad(a,this.dataFactory.namedNode(n.RDF+"object"),r,this.defaultGraph)))}claimNodeId(e){if(!this.allowDuplicateRdfIds){if(this.nodeIds[e.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${e.value}'.`);this.nodeIds[e.value]=!0}}onText(e){const t=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;t&&(t.childrenStringTags?t.childrenStringTags.push(e):t.predicate&&(t.text=e))}onCloseTag(){const e=this.activeTagStack.pop();if(e.childrenStringEmitClosingTag&&e.childrenStringTags.push(e.childrenStringEmitClosingTag),e.childrenTagsToString&&(e.datatype=this.dataFactory.namedNode(n.RDF+"XMLLiteral"),e.text=e.childrenStringTags.join(""),e.hadChildren=!1),e.childrenCollectionSubject)this.emitTriple(e.childrenCollectionSubject,e.childrenCollectionPredicate,this.dataFactory.namedNode(n.RDF+"nil"),e.reifiedStatementId);else if(e.predicate){if(!e.hadChildren&&e.childrenParseType!==b.PROPERTY)this.emitTriple(e.subject,e.predicate,this.dataFactory.literal(e.text||"",e.datatype||e.language),e.reifiedStatementId);else if(!e.predicateEmitted){const t=this.dataFactory.blankNode();this.emitTriple(e.subject,e.predicate,t,e.reifiedStatementId);for(let r=0;r<e.predicateSubPredicates.length;r++)this.emitTriple(t,e.predicateSubPredicates[r],e.predicateSubObjects[r],null)}}}onDoctype(e){e.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(t,r,a)=>(this.saxParser.ENTITIES[r]=a,""))}}m.RdfXmlParser=n;n.MIME_TYPE="application/rdf+xml";n.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#";n.XML="http://www.w3.org/XML/1998/namespace";n.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"];n.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"];n.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u;var b;(function(l){l[l.RESOURCE=0]="RESOURCE",l[l.PROPERTY=1]="PROPERTY"})(b||(m.ParseType=b={}));(function(l){var e=y&&y.__createBinding||(Object.create?function(r,a,s,o){o===void 0&&(o=s);var d=Object.getOwnPropertyDescriptor(a,s);(!d||("get"in d?!a.__esModule:d.writable||d.configurable))&&(d={enumerable:!0,get:function(){return a[s]}}),Object.defineProperty(r,o,d)}:function(r,a,s,o){o===void 0&&(o=s),r[o]=a[s]}),t=y&&y.__exportStar||function(r,a){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&e(a,r,s)};Object.defineProperty(l,"__esModule",{value:!0}),t(m,l)})(T);class te extends T.RdfXmlParser{constructor({factory:e,...t}={}){super({...t,dataFactory:e})}}export{te as default};
